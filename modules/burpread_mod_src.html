<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>burpread_mod source &mdash; MIDAS  documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="top" title="MIDAS  documentation" href="../index.html" /> 
  </head>
  <body>
  <div>
    <img src="../_static/MIDAS_header.png" alt="MIDAS" />
  </div>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li><a href="../index.html">MIDAS  documentation</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/modules/burpread_mod_src.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <section id="burpread-mod-source">
<h1>burpread_mod source<a class="headerlink" href="#burpread-mod-source" title="Permalink to this headline">Â¶</a></h1>
<blockquote>
<div><div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="linenos">   1</span><span class="c">!--------------------------------------- LICENCE BEGIN -----------------------------------</span>
<span class="linenos">   2</span><span class="c">!Environment Canada - Atmospheric Science and Technology License/Disclaimer,</span>
<span class="linenos">   3</span><span class="c">!                     version 3; Last Modified: May 7, 2008.</span>
<span class="linenos">   4</span><span class="c">!This is free but copyrighted software; you can use/redistribute/modify it under the terms</span>
<span class="linenos">   5</span><span class="c">!of the Environment Canada - Atmospheric Science and Technology License/Disclaimer</span>
<span class="linenos">   6</span><span class="c">!version 3 or (at your option) any later version that should be found at:</span>
<span class="linenos">   7</span><span class="c">!http://collaboration.cmc.ec.gc.ca/science/rpn.comm/license.html</span>
<span class="linenos">   8</span><span class="c">!</span>
<span class="linenos">   9</span><span class="c">!This software is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;</span>
<span class="linenos">  10</span><span class="c">!without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="linenos">  11</span><span class="c">!See the above mentioned License/Disclaimer for more details.</span>
<span class="linenos">  12</span><span class="c">!You should have received a copy of the License/Disclaimer along with this software;</span>
<span class="linenos">  13</span><span class="c">!if not, you can write to: EC-RPN COMM Group, 2121 TransCanada, suite 500, Dorval (Quebec),</span>
<span class="linenos">  14</span><span class="c">!CANADA, H9P 1J3; or send e-mail to service.rpn@ec.gc.ca</span>
<span class="linenos">  15</span><span class="c">!-------------------------------------- LICENCE END --------------------------------------</span>
<span class="linenos">  16</span>
<span class="linenos">  17</span><span class="k">module  </span><span class="n">burpread_mod</span><span class="w"></span>
<span class="linenos">  18</span><span class="w">  </span><span class="c">! MODULE burpread_mod (prefix=&#39;brpr&#39; category=&#39;3. Observation input/output&#39;)</span>
<span class="linenos">  19</span><span class="w">  </span><span class="c">!</span>
<span class="linenos">  20</span><span class="w">  </span><span class="c">!:Purpose: To read and update BURP observation files. Data is stored in </span>
<span class="linenos">  21</span><span class="w">  </span><span class="c">!           obsSpaceData object.</span>
<span class="linenos">  22</span><span class="w">  </span><span class="c">!</span>
<span class="linenos">  23</span>
<span class="linenos">  24</span><span class="k">use </span><span class="n">codePrecision_mod</span><span class="w"></span>
<span class="linenos">  25</span><span class="k">use </span><span class="n">bufr_mod</span><span class="w"></span>
<span class="linenos">  26</span><span class="k">use </span><span class="n">burp_module</span><span class="w"></span>
<span class="linenos">  27</span><span class="k">use </span><span class="n">ObsSpaceData_mod</span><span class="w"></span>
<span class="linenos">  28</span><span class="k">use </span><span class="n">MathPhysConstants_mod</span><span class="w"></span>
<span class="linenos">  29</span><span class="k">use </span><span class="n">earthConstants_mod</span><span class="w"></span>
<span class="linenos">  30</span><span class="k">use </span><span class="n">utilities_mod</span><span class="w"></span>
<span class="linenos">  31</span><span class="k">use </span><span class="n">obsUtil_mod</span><span class="w"></span>
<span class="linenos">  32</span><span class="k">use </span><span class="n">obsVariableTransforms_mod</span><span class="w"></span>
<span class="linenos">  33</span><span class="k">use </span><span class="n">obsFilter_mod</span><span class="w"></span>
<span class="linenos">  34</span><span class="k">use </span><span class="n">tovs_nl_mod</span><span class="w"></span>
<span class="linenos">  35</span><span class="k">use </span><span class="n">kdtree2_mod</span><span class="w"></span>
<span class="linenos">  36</span><span class="k">use </span><span class="n">codtyp_mod</span><span class="w"></span>
<span class="linenos">  37</span>
<span class="linenos">  38</span><span class="k">implicit none</span>
<span class="linenos">  39</span><span class="k">save</span>
<span class="linenos">  40</span>
<span class="linenos">  41</span><span class="k">private</span><span class="w"></span>
<span class="linenos">  42</span>
<span class="linenos">  43</span><span class="c">! public procedures</span>
<span class="linenos">  44</span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">brpr_readBurp</span><span class="p">,</span><span class="w"> </span><span class="n">brpr_updateBurp</span><span class="p">,</span><span class="w"> </span><span class="n">brpr_getTypeResume</span><span class="p">,</span><span class="w"> </span><span class="n">brpr_addCloudParametersandEmissivity</span><span class="w"></span>
<span class="linenos">  45</span><span class="k">public</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">brpr_addElementsToBurp</span><span class="p">,</span><span class="w"> </span><span class="n">brpr_updateMissingObsFlags</span><span class="p">,</span><span class="w"> </span><span class="n">brpr_burpClean</span><span class="w"></span>
<span class="linenos">  46</span>
<span class="linenos">  47</span>
<span class="linenos">  48</span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maxItems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="w"></span>
<span class="linenos">  49</span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">maxElements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">20</span><span class="w"></span>
<span class="linenos">  50</span><span class="c">! Namelist variables</span>
<span class="linenos">  51</span><span class="kt">INTEGER</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">NELEMS</span><span class="w">           </span><span class="c">! MUST NOT BE INCLUDED IN NAMELIST!</span>
<span class="linenos">  52</span><span class="kt">INTEGER</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">NELEMS_SFC</span><span class="w">       </span><span class="c">! MUST NOT BE INCLUDED IN NAMELIST!</span>
<span class="linenos">  53</span><span class="kt">INTEGER</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">NELEMS_GPS</span><span class="w">       </span><span class="c">! MUST NOT BE INCLUDED IN NAMELIST!</span>
<span class="linenos">  54</span><span class="kt">INTEGER</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">LISTE_ELE_GPS</span><span class="p">(</span><span class="n">maxElements</span><span class="p">)</span><span class="w"> </span><span class="c">! list of bufr element ids to read</span>
<span class="linenos">  55</span><span class="kt">INTEGER</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">BLISTELEMENTS</span><span class="p">(</span><span class="n">maxElements</span><span class="p">)</span><span class="w"> </span><span class="c">! list of bufr element ids to read</span>
<span class="linenos">  56</span><span class="kt">INTEGER</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">BLISTELEMENTS_SFC</span><span class="p">(</span><span class="n">maxElements</span><span class="p">)</span><span class="w"> </span><span class="c">! list of bufr element ids to read</span>
<span class="linenos">  57</span><span class="kt">INTEGER</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">BN_ITEMS</span><span class="w">         </span><span class="c">! MUST NOT BE INCLUDED IN NAMELIST!</span>
<span class="linenos">  58</span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="n">maxItems</span><span class="p">)</span><span class="w"> </span><span class="c">! list of blocks to include in updated file (e.g. &#39;OMP&#39;,&#39;OMA&#39;)</span>
<span class="linenos">  59</span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">TYPE_RESUME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;UNKNOWN&#39;</span><span class="w">      </span><span class="c">! can be &#39;BGCKALT&#39;, &#39;POSTALT&#39; or &#39;DERIALT&#39;</span>
<span class="linenos">  60</span><span class="kt">LOGICAL</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">ENFORCE_CLASSIC_SONDES</span><span class="w">       </span><span class="c">! choose to ignore high-res raobs lat/lon/time information</span>
<span class="linenos">  61</span><span class="kt">LOGICAL</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">UA_HIGH_PRECISION_TT_ES</span><span class="w">      </span><span class="c">! choose to use higher precision elements for raobs </span>
<span class="linenos">  62</span><span class="kt">LOGICAL</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">UA_FLAG_HIGH_PRECISION_TT_ES</span><span class="w"> </span><span class="c">! choose to read flag of higher precision elements for raobs</span>
<span class="linenos">  63</span><span class="kt">LOGICAL</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">READ_QI_GA_MT_SW</span><span class="w"> </span><span class="c">! read additional QC-related elements for AMV obs</span>
<span class="linenos">  64</span><span class="kt">logical</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">addBtClearToBurp</span><span class="w"> </span><span class="c">! choose to write clear-sky radiance to file in all-sky mode</span>
<span class="linenos">  65</span><span class="kt">integer</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">clwFgElementId</span><span class="w">   </span><span class="c">! bufr element id of cloud liquid water from background in all-sky mode</span>
<span class="linenos">  66</span><span class="kt">integer</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">siFgElementId</span><span class="w">    </span><span class="c">! bufr element id of scattering index in all-sky mode</span>
<span class="linenos">  67</span><span class="kt">integer</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">btClearElementId</span><span class="w"> </span><span class="c">! bufr element id of clear-sky radiance in all-sky mode</span>
<span class="linenos">  68</span>
<span class="linenos">  69</span><span class="k">CONTAINS</span>
<span class="linenos">  70</span>
<span class="linenos">  71</span><span class="k">  </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="k">function </span><span class="n">brpr_getTypeResume</span><span class="w"></span>
<span class="linenos">  72</span><span class="w">    </span><span class="n">brpr_getTypeResume</span><span class="o">=</span><span class="n">TYPE_RESUME</span><span class="w"></span>
<span class="linenos">  73</span><span class="w">  </span><span class="k">end function </span><span class="n">brpr_getTypeResume</span><span class="w"></span>
<span class="linenos">  74</span>
<span class="linenos">  75</span><span class="w">  </span><span class="k">subroutine </span><span class="n">brpr_updateBurp</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">familytype</span><span class="p">,</span><span class="n">brp_file</span><span class="p">,</span><span class="n">filenumb</span><span class="p">)</span><span class="w"></span>
<span class="linenos">  76</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">  77</span><span class="w">    </span><span class="c">!:Purpose: To update variables relative to assimilation in burp files</span>
<span class="linenos">  78</span>
<span class="linenos">  79</span><span class="w">    </span><span class="c">!***************************************************************************</span>
<span class="linenos">  80</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">  81</span><span class="w">    </span><span class="c">!          WHEN SEARCHING FOR A SPECIFIC BLOCK BY ITS BTYP, VALUES OF</span>
<span class="linenos">  82</span><span class="w">    </span><span class="c">!          BIT 0 TO 3 ARE IRRELEVANT WHILE BIT 4 IS 0 FOR GLOBAL AND 1</span>
<span class="linenos">  83</span><span class="w">    </span><span class="c">!          FOR REGIONAL MODEL. HERE, WE SEARCH BLOCK BY THEIR FIRST</span>
<span class="linenos">  84</span><span class="w">    </span><span class="c">!          10 BITS (BIT 5 TO 14).</span>
<span class="linenos">  85</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">  86</span><span class="w">    </span><span class="c">!***************************************************************************</span>
<span class="linenos">  87</span>
<span class="linenos">  88</span><span class="w">    </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="linenos">  89</span>
<span class="linenos">  90</span><span class="w">    </span><span class="c">! Arguments:</span>
<span class="linenos">  91</span><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="p">(</span><span class="n">struct_obs</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">obsdat</span><span class="w"> </span><span class="c">! obsSpaceData object</span>
<span class="linenos">  92</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">FAMILYTYPE</span><span class="w"> </span><span class="c">! type of family(&#39;UA&#39;,&#39;SF&#39;,&#39;AI&#39;,&#39;SW&#39;,&#39;TO&#39;, ...)</span>
<span class="linenos">  93</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">BRP_FILE</span><span class="w">   </span><span class="c">! name of burp file </span>
<span class="linenos">  94</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">FILENUMB</span><span class="w"></span>
<span class="linenos">  95</span>
<span class="linenos">  96</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">  97</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">kdtree2</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">tree</span><span class="w"></span>
<span class="linenos">  98</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">maxNumSearch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="w"></span>
<span class="linenos">  99</span><span class="w">    </span><span class="kt">integer</span><span class="w">                           </span><span class="kd">::</span><span class="w"> </span><span class="n">numFoundSearch</span><span class="p">,</span><span class="w"> </span><span class="n">bodyCount</span><span class="p">,</span><span class="w"> </span><span class="n">resultIndex</span><span class="w"></span>
<span class="linenos"> 100</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">kdtree2_result</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">searchResults</span><span class="p">(</span><span class="n">maxNumSearch</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 101</span><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">kdkind</span><span class="p">)</span><span class="w">                      </span><span class="kd">::</span><span class="w"> </span><span class="n">maxRadius</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.000001d0</span><span class="w"></span>
<span class="linenos"> 102</span><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">kdkind</span><span class="p">)</span><span class="w">                      </span><span class="kd">::</span><span class="w"> </span><span class="n">refPosition</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 103</span><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">kdkind</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">PPPandVNM</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos"> 104</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">bodyIndexList</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos"> 105</span>
<span class="linenos"> 106</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w">  </span><span class="k">PARAMETER</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">NBLOC_LIST</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="w"></span>
<span class="linenos"> 107</span><span class="w">    </span><span class="kt">INTEGER</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">LNMX</span><span class="w"></span>
<span class="linenos"> 108</span>
<span class="linenos"> 109</span><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">BURP_FILE</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">FILE_IN</span><span class="w"></span>
<span class="linenos"> 110</span><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">BURP_RPT</span><span class="p">)</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">RPT_IN</span><span class="p">,</span><span class="n">CP_RPT</span><span class="w"></span>
<span class="linenos"> 111</span><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">BURP_BLOCK</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">BLOCK_IN</span><span class="p">,</span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="n">BLOCK_OMP</span><span class="p">,</span><span class="n">BLOCK_OER</span><span class="p">,</span><span class="n">BLOCK_FGE</span><span class="p">,</span><span class="n">BLOCK_FLG</span><span class="p">,</span><span class="n">BLOCK_FSO</span><span class="w"></span>
<span class="linenos"> 112</span><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">BURP_BLOCK</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">BLOCK_OMA_SFC</span><span class="p">,</span><span class="n">BLOCK_OMP_SFC</span><span class="p">,</span><span class="n">BLOCK_OER_SFC</span><span class="p">,</span><span class="n">BLOCK_FGE_SFC</span><span class="p">,</span><span class="n">BLOCK_FLG_SFC</span><span class="p">,</span><span class="n">BLOCK_FSO_SFC</span><span class="w"></span>
<span class="linenos"> 113</span><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">BURP_BLOCK</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">Block_FLG_CP</span><span class="p">,</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="n">BLOCK_MAR_MUL_CP</span><span class="p">,</span><span class="n">BLOCK_OBS_SFC_CP</span><span class="p">,</span><span class="n">BLOCK_MAR_SFC_CP</span><span class="w"></span>
<span class="linenos"> 114</span><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">BURP_BLOCK</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">BLOCK_GEN</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_OBS_BND</span><span class="p">,</span><span class="n">BLOCK_MAR_BND</span><span class="p">,</span><span class="n">BLOCK_ORB</span><span class="w"></span>
<span class="linenos"> 115</span>
<span class="linenos"> 116</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">FAMILYTYPE2</span><span class="w"></span>
<span class="linenos"> 117</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">OPT_MISSING</span><span class="w"></span>
<span class="linenos"> 118</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">BTYP</span><span class="p">,</span><span class="n">BFAM</span><span class="p">,</span><span class="n">BTYP10</span><span class="p">,</span><span class="n">BTYP10FLG_uni</span><span class="p">,</span><span class="n">BTYP10obs_uni</span><span class="w"> </span>
<span class="linenos"> 119</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">BTYP10DES</span><span class="p">,</span><span class="n">BTYP10INF</span><span class="p">,</span><span class="n">BTYP10OBS</span><span class="p">,</span><span class="n">BTYP10FLG</span><span class="w"></span>
<span class="linenos"> 120</span>
<span class="linenos"> 121</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">NB_RPTS</span><span class="p">,</span><span class="n">REF_RPT</span><span class="p">,</span><span class="n">REF_BLK</span><span class="p">,</span><span class="nb">COUNT</span>
<span class="linenos"> 122</span><span class="nb">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">ADDRESS</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos"> 123</span><span class="w">    </span><span class="kt">real</span><span class="w">                   </span><span class="kd">::</span><span class="w"> </span><span class="n">VCOORD</span><span class="w"></span>
<span class="linenos"> 124</span>
<span class="linenos"> 125</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">NBELE</span><span class="p">,</span><span class="n">NVALE</span><span class="p">,</span><span class="n">NTE</span><span class="p">,</span><span class="w"> </span><span class="n">numHeader</span><span class="w"></span>
<span class="linenos"> 126</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">J</span><span class="p">,</span><span class="n">JJ</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">KK</span><span class="p">,</span><span class="n">KI</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">Jo</span><span class="p">,</span><span class="n">ERROR</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">KOBSN</span><span class="p">,</span><span class="n">ITEM</span><span class="w"></span>
<span class="linenos"> 127</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">IND_ELE</span><span class="p">,</span><span class="n">IND_VCOORD</span><span class="w"></span>
<span class="linenos"> 128</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">IND_ELE_MAR</span><span class="p">,</span><span class="n">IND_ELEU</span><span class="p">,</span><span class="n">IND_ELEF</span><span class="p">,</span><span class="n">IND_ELE_stat</span><span class="p">,</span><span class="n">IND_ELE_tth</span><span class="p">,</span><span class="n">IND_ELE_esh</span><span class="w"></span>
<span class="linenos"> 129</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">IND_LAT</span><span class="p">,</span><span class="n">IND_LON</span><span class="p">,</span><span class="n">IND_TIME</span><span class="p">,</span><span class="n">IND_obsClear</span><span class="w"></span>
<span class="linenos"> 130</span>
<span class="linenos"> 131</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="nb">SUM</span>
<span class="linenos"> 132</span><span class="nb">    </span><span class="kt">real</span><span class="w">                   </span><span class="kd">::</span><span class="w"> </span><span class="n">ELEVFACT</span><span class="w"></span>
<span class="linenos"> 133</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="p">,</span><span class="n">idtyp</span><span class="p">,</span><span class="n">lati</span><span class="p">,</span><span class="nb">long</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">elev</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 134</span><span class="w">                              </span><span class="n">drnd</span><span class="p">,</span><span class="n">date_h</span><span class="p">,</span><span class="n">hhmm_h</span><span class="p">,</span><span class="n">oars</span><span class="p">,</span><span class="n">runn</span><span class="w"></span>
<span class="linenos"> 135</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">IND055200</span><span class="w"></span>
<span class="linenos"> 136</span>
<span class="linenos"> 137</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">iele</span><span class="p">,</span><span class="n">NELE</span><span class="p">,</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="n">NVAL</span><span class="p">,</span><span class="n">NT</span><span class="p">,</span><span class="n">NELE_INFO</span><span class="w"></span>
<span class="linenos"> 138</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">bit_alt</span><span class="p">,</span><span class="n">btyp_offset</span><span class="p">,</span><span class="n">btyp_offset_uni</span><span class="w"></span>
<span class="linenos"> 139</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="p">,</span><span class="n">BKSTP</span><span class="w"></span>
<span class="linenos"> 140</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">BURP_TYP</span><span class="w"></span>
<span class="linenos"> 141</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">STNID</span><span class="p">,</span><span class="n">STN_RESUME</span><span class="p">,</span><span class="n">STID</span><span class="w"></span>
<span class="linenos"> 142</span><span class="w">    </span><span class="kt">LOGICAL</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">HIRES</span><span class="p">,</span><span class="n">HIPCS</span><span class="w"></span>
<span class="linenos"> 143</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">NDATA_SF</span><span class="w"></span>
<span class="linenos"> 144</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">IFLAG</span><span class="w"></span>
<span class="linenos"> 145</span>
<span class="linenos"> 146</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">OBS_START</span><span class="p">,</span><span class="n">SAVE_OBS</span><span class="w"></span>
<span class="linenos"> 147</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">IL_INDEX</span><span class="p">,</span><span class="n">IRLN</span><span class="p">,</span><span class="n">INLV</span><span class="p">,</span><span class="n">LK</span><span class="p">,</span><span class="n">VNM</span><span class="w"></span>
<span class="linenos"> 148</span><span class="w">    </span><span class="kt">real</span><span class="w">                   </span><span class="kd">::</span><span class="w"> </span><span class="n">OBS</span><span class="p">,</span><span class="n">OMA</span><span class="p">,</span><span class="n">OMP</span><span class="p">,</span><span class="n">OER</span><span class="p">,</span><span class="n">FSO</span><span class="p">,</span><span class="n">FGE</span><span class="p">,</span><span class="n">OBSVA</span><span class="p">,</span><span class="n">CONVFACT</span><span class="p">,</span><span class="w"> </span><span class="n">BCOR</span><span class="p">,</span><span class="w"> </span><span class="n">obsClear</span><span class="w"></span>
<span class="linenos"> 149</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">FLG</span><span class="p">,</span><span class="nb">TIME</span><span class="p">,</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">ILEMD</span><span class="p">,</span><span class="n">VCOORD_POS</span><span class="p">,</span><span class="n">ILEMZBCOR</span><span class="p">,</span><span class="n">ILEMTBCOR</span><span class="p">,</span><span class="n">ILEMHBCOR</span><span class="w"></span>
<span class="linenos"> 150</span>
<span class="linenos"> 151</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="n">NBLOC_LIST</span><span class="p">),</span><span class="n">bl</span><span class="w"></span>
<span class="linenos"> 152</span>
<span class="linenos"> 153</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">post_bit</span><span class="p">,</span><span class="n">STATUS_HIRES</span><span class="p">,</span><span class="n">BIT_STATUS</span><span class="p">,</span><span class="n">FILEN</span><span class="w"></span>
<span class="linenos"> 154</span><span class="w">    </span><span class="kt">LOGICAL</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">REGRUP</span><span class="p">,</span><span class="n">WINDS</span><span class="p">,</span><span class="n">OMA_SFC_EXIST</span><span class="p">,</span><span class="n">OMA_ALT_EXIST</span><span class="w"></span>
<span class="linenos"> 155</span>
<span class="linenos"> 156</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">LISTE_ELE</span><span class="p">(</span><span class="n">maxElements</span><span class="p">),</span><span class="n">LISTE_ELE_SFC</span><span class="p">(</span><span class="n">maxElements</span><span class="p">),</span><span class="n">is_in_list</span><span class="w"></span>
<span class="linenos"> 157</span><span class="w">    </span>
<span class="linenos"> 158</span><span class="w">    </span><span class="kt">LOGICAL</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">LBLOCK_OER_CP</span><span class="p">,</span><span class="w"> </span><span class="n">LBLOCK_FGE_CP</span><span class="w"></span>
<span class="linenos"> 159</span><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">BURP_BLOCK</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">BLOCK_OER_CP</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_FGE_CP</span><span class="w"></span>
<span class="linenos"> 160</span><span class="w">    </span><span class="kt">logical</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">FSOFound</span><span class="w"></span>
<span class="linenos"> 161</span><span class="w">    </span><span class="kt">logical</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">btClearElementFound</span><span class="w"> </span>
<span class="linenos"> 162</span>
<span class="linenos"> 163</span><span class="w">    </span><span class="c">! ensure kdtrees object is null</span>
<span class="linenos"> 164</span><span class="w">    </span><span class="k">nullify</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 165</span>
<span class="linenos"> 166</span><span class="w">    </span><span class="n">STATUS_HIRES</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 167</span><span class="w">    </span><span class="n">FAMILYTYPE2</span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SCRAP&#39;</span><span class="w"></span>
<span class="linenos"> 168</span><span class="w">    </span><span class="n">vcord_type</span><span class="p">(:)</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 169</span><span class="w">    </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 170</span><span class="w">    </span><span class="n">NELE_INFO</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 171</span><span class="w">    </span><span class="n">NELE_SFC</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 172</span><span class="w">    </span><span class="n">NELE</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 173</span><span class="w">    </span><span class="n">NELEMS</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 174</span><span class="w">    </span><span class="n">NELEMS_SFC</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 175</span><span class="w">    </span><span class="n">NELEMS_GPS</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 176</span><span class="w">    </span><span class="n">ILEMU</span><span class="o">=</span><span class="mi">11003</span><span class="w"></span>
<span class="linenos"> 177</span><span class="w">    </span><span class="n">ILEMV</span><span class="o">=</span><span class="mi">11004</span><span class="w"></span>
<span class="linenos"> 178</span><span class="w">    </span><span class="n">ILEMD</span><span class="o">=</span><span class="mi">11001</span><span class="w"></span>
<span class="linenos"> 179</span><span class="w">    </span><span class="n">ILEMZBCOR</span><span class="o">=</span><span class="mi">15234</span><span class="w"> </span><span class="c">! bcor element for GP  ZTD observations</span>
<span class="linenos"> 180</span><span class="w">    </span><span class="n">ILEMTBCOR</span><span class="o">=</span><span class="mi">12204</span><span class="w"> </span><span class="c">! bcor element for altitude TT observations</span>
<span class="linenos"> 181</span><span class="w">    </span><span class="n">ILEMHBCOR</span><span class="o">=</span><span class="mi">12243</span><span class="w"> </span><span class="c">! bcor element for altitude ES observations</span>
<span class="linenos"> 182</span><span class="w">    </span><span class="n">ELEVFACT</span><span class="o">=</span><span class="mf">0.</span><span class="w"></span>
<span class="linenos"> 183</span><span class="w">    </span><span class="n">ENFORCE_CLASSIC_SONDES</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 184</span><span class="w">    </span><span class="n">UA_HIGH_PRECISION_TT_ES</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 185</span><span class="w">    </span><span class="n">UA_FLAG_HIGH_PRECISION_TT_ES</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 186</span><span class="w">    </span><span class="n">LNMX</span><span class="o">=</span><span class="mi">100000</span><span class="w"></span>
<span class="linenos"> 187</span><span class="w">    </span><span class="n">LISTE_ELE_SFC</span><span class="p">(:)</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 188</span><span class="w">    </span><span class="n">LISTE_ELE</span><span class="p">(:)</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 189</span><span class="w">    </span><span class="k">SELECT CASE</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">))</span><span class="w"></span>
<span class="linenos"> 190</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;UA&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 191</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;multi&#39;</span><span class="w"></span>
<span class="linenos"> 192</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">7004</span><span class="w"></span>
<span class="linenos"> 193</span>
<span class="linenos"> 194</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_sfc&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 195</span>
<span class="linenos"> 196</span><span class="w">        </span><span class="n">FAMILYTYPE2</span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;UA&#39;</span><span class="w"></span>
<span class="linenos"> 197</span><span class="w">        </span><span class="n">ENFORCE_CLASSIC_SONDES</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 198</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 199</span><span class="w">        </span><span class="n">WINDS</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 200</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;AI&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 201</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;uni&#39;</span><span class="w"></span>
<span class="linenos"> 202</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">7004</span><span class="w"></span>
<span class="linenos"> 203</span>
<span class="linenos"> 204</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 205</span><span class="w">        </span><span class="n">WINDS</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 206</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;AL&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 207</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;uni&#39;</span><span class="w"></span>
<span class="linenos"> 208</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">7071</span><span class="w"></span>
<span class="linenos"> 209</span>
<span class="linenos"> 210</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 211</span><span class="w">        </span><span class="n">WINDS</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 212</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;SW&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 213</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;uni&#39;</span><span class="w"></span>
<span class="linenos"> 214</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">7004</span><span class="w"></span>
<span class="linenos"> 215</span>
<span class="linenos"> 216</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 217</span><span class="w">        </span><span class="n">WINDS</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 218</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 219</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;SF&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 220</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;uni&#39;</span><span class="w"></span>
<span class="linenos"> 221</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 222</span>
<span class="linenos"> 223</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_sfc&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 224</span>
<span class="linenos"> 225</span><span class="w">        </span><span class="n">FAMILYTYPE2</span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SFC&#39;</span><span class="w"></span>
<span class="linenos"> 226</span><span class="w">        </span><span class="n">WINDS</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 227</span><span class="w">        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;GP&#39;</span><span class="p">)</span><span class="w"> </span><span class="n">WINDS</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 228</span><span class="w">        </span><span class="n">ILEMU</span><span class="o">=</span><span class="mi">11215</span><span class="w"></span>
<span class="linenos"> 229</span><span class="w">        </span><span class="n">ILEMV</span><span class="o">=</span><span class="mi">11216</span><span class="w"></span>
<span class="linenos"> 230</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;GP&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 231</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;uni&#39;</span><span class="w"></span>
<span class="linenos"> 232</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 233</span>
<span class="linenos"> 234</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_gp&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 235</span>
<span class="linenos"> 236</span><span class="w">        </span><span class="n">FAMILYTYPE2</span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SFC&#39;</span><span class="w"></span>
<span class="linenos"> 237</span><span class="w">        </span><span class="n">WINDS</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 238</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;SC&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 239</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;uni&#39;</span><span class="w"></span>
<span class="linenos"> 240</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_sfc&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 241</span>
<span class="linenos"> 242</span><span class="w">        </span><span class="n">FAMILYTYPE2</span><span class="o">=</span><span class="s1">&#39;SCAT&#39;</span><span class="w"></span>
<span class="linenos"> 243</span><span class="w">        </span><span class="n">WINDS</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 244</span><span class="w">        </span><span class="n">ILEMU</span><span class="o">=</span><span class="mi">11215</span><span class="w"></span>
<span class="linenos"> 245</span><span class="w">        </span><span class="n">ILEMV</span><span class="o">=</span><span class="mi">11216</span><span class="w"></span>
<span class="linenos"> 246</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;PR&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 247</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;multi&#39;</span><span class="w"></span>
<span class="linenos"> 248</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">7006</span><span class="w"></span>
<span class="linenos"> 249</span><span class="w">        </span><span class="n">ELEVFACT</span><span class="o">=</span><span class="mf">1.</span><span class="w"></span>
<span class="linenos"> 250</span>
<span class="linenos"> 251</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 252</span><span class="w">        </span><span class="n">WINDS</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 253</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;RO&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 254</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;multi&#39;</span><span class="w"></span>
<span class="linenos"> 255</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">7007</span><span class="w"></span>
<span class="linenos"> 256</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">7040</span><span class="w"></span>
<span class="linenos"> 257</span>
<span class="linenos"> 258</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 259</span><span class="w">        </span><span class="n">WINDS</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 260</span><span class="w">        </span><span class="n">NELE_INFO</span><span class="o">=</span><span class="mi">16</span><span class="w"></span>
<span class="linenos"> 261</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;TO&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 262</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;multi&#39;</span><span class="w"></span>
<span class="linenos"> 263</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">5042</span><span class="w"></span>
<span class="linenos"> 264</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">2150</span><span class="w"></span>
<span class="linenos"> 265</span><span class="w">        </span>
<span class="linenos"> 266</span><span class="w">        </span><span class="k">CALL </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_tovs&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 267</span>
<span class="linenos"> 268</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">addBtClearToBurp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 269</span><span class="k">          </span><span class="n">btClearElementFound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 270</span>
<span class="linenos"> 271</span><span class="w">          </span><span class="n">elementLoop</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">iele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NELEMS</span><span class="w"></span>
<span class="linenos"> 272</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BLISTELEMENTS</span><span class="p">(</span><span class="n">iele</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btClearElementId</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 273</span><span class="k">              </span><span class="n">btClearElementFound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 274</span><span class="w">              </span><span class="k">exit </span><span class="n">elementLoop</span><span class="w"></span>
<span class="linenos"> 275</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos"> 276</span><span class="k">          end do </span><span class="n">elementLoop</span><span class="w"></span>
<span class="linenos"> 277</span>
<span class="linenos"> 278</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">btClearElementFound</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 279</span><span class="w">            </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_updateBurp: btClearElement element should be in namelist.&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 280</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos"> 281</span>
<span class="linenos"> 282</span><span class="k">        </span><span class="n">NELE_INFO</span><span class="o">=</span><span class="mi">24</span><span class="w"></span>
<span class="linenos"> 283</span><span class="w">        </span><span class="n">WINDS</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 284</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CH&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 285</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;multi&#39;</span><span class="w">   </span><span class="c">! Both &#39;multi&#39; and &#39;uni&#39; are possible for this family.</span>
<span class="linenos"> 286</span><span class="w">                           </span><span class="c">! &#39;uni&#39; level data are assumed not to have any accompanynig vertical </span>
<span class="linenos"> 287</span><span class="w">                           </span><span class="c">! coordinate element in addition to having only one level.</span>
<span class="linenos"> 288</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="mi">7004</span><span class="p">,</span><span class="mi">7204</span><span class="p">,</span><span class="mi">7006</span><span class="p">,</span><span class="mi">7007</span><span class="p">,</span><span class="mi">5042</span><span class="p">,</span><span class="mi">2150</span><span class="p">,</span><span class="mi">2071</span><span class="p">,</span><span class="mi">0</span><span class="o">/</span><span class="p">)</span><span class="w">  </span><span class="c">! 0 must be at end.</span>
<span class="linenos"> 289</span>
<span class="linenos"> 290</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_chm_sfc&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 291</span><span class="w">        </span><span class="n">WINDS</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 292</span>
<span class="linenos"> 293</span><span class="w">        </span><span class="n">FAMILYTYPE2</span><span class="o">=</span><span class="s1">&#39;CH&#39;</span><span class="w"></span>
<span class="linenos"> 294</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_chm&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 295</span><span class="w">      </span><span class="k">CASE </span><span class="n">default</span><span class="w"></span>
<span class="linenos"> 296</span><span class="w">        </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_updateBurp: unknown familyType : &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">))</span><span class="w"></span>
<span class="linenos"> 297</span><span class="w">    </span><span class="k">END SELECT</span>
<span class="linenos"> 298</span>
<span class="linenos"> 299</span><span class="k">    </span><span class="n">NELE</span><span class="o">=</span><span class="n">NELEMS</span><span class="w"></span>
<span class="linenos"> 300</span><span class="w">    </span><span class="n">LISTE_ELE</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">)</span><span class="o">=</span><span class="n">BLISTELEMENTS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 301</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;GP&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos"> 302</span><span class="w">      </span><span class="c">! for GP ignore BLISTELEMENTS_SFC, and use instead LISTE_ELE_GPS</span>
<span class="linenos"> 303</span><span class="w">      </span><span class="n">NELE_SFC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NELEMS_GPS</span><span class="w"></span>
<span class="linenos"> 304</span><span class="w">      </span><span class="n">LISTE_ELE_SFC</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">)</span><span class="o">=</span><span class="n">LISTE_ELE_GPS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 305</span><span class="w">    </span><span class="k">else</span>
<span class="linenos"> 306</span><span class="k">      </span><span class="n">NELE_SFC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NELEMS_SFC</span><span class="w"></span>
<span class="linenos"> 307</span><span class="w">      </span><span class="n">LISTE_ELE_SFC</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">)</span><span class="o">=</span><span class="n">BLISTELEMENTS_SFC</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 308</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos"> 309</span><span class="k">    if</span><span class="p">(</span><span class="n">NELE</span><span class="w">     </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="s1">&#39; LISTE_ELE =&#39;</span><span class="p">,</span><span class="n">LISTE_ELE</span><span class="w"></span>
<span class="linenos"> 310</span><span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">NELE_SFC</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="s1">&#39; LISTE_ELE_SFC =&#39;</span><span class="p">,</span><span class="n">LISTE_ELE_SFC</span><span class="w"></span>
<span class="linenos"> 311</span>
<span class="linenos"> 312</span><span class="w">    </span><span class="n">TYPE_RESUME</span><span class="o">=</span><span class="s1">&#39;POSTALT&#39;</span><span class="w"></span>
<span class="linenos"> 313</span><span class="w">    </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_update&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 314</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; BN_ITEMS   =&#39;</span><span class="p">,</span><span class="n">BN_ITEMS</span><span class="w"></span>
<span class="linenos"> 315</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; ITEMS TO ADD IN BURP FILE REPORTS =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">BN_ITEMS</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 316</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; BTYP OF UPDATED BURP FILE=&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">TYPE_RESUME</span><span class="w"></span>
<span class="linenos"> 317</span>
<span class="linenos"> 318</span><span class="w">    </span><span class="c">! check if there is FSO calculation</span>
<span class="linenos"> 319</span><span class="w">    </span><span class="n">FSOFound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 320</span><span class="w">    </span><span class="k">do </span><span class="n">item</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">BN_ITEMS</span><span class="w"></span>
<span class="linenos"> 321</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;FSO&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">FSOFound</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 322</span><span class="w">    </span><span class="k">end do</span>
<span class="linenos"> 323</span>
<span class="linenos"> 324</span><span class="k">    SELECT CASE</span><span class="p">(</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">TYPE_RESUME</span><span class="p">))</span><span class="w"></span>
<span class="linenos"> 325</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s2">&quot;BGCKALT&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;POSTALT&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 326</span><span class="w">        </span><span class="n">BIT_STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span>
<span class="linenos"> 327</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s2">&quot;DERIALT&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 328</span><span class="w">        </span><span class="n">BIT_STATUS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11</span><span class="w"> </span>
<span class="linenos"> 329</span><span class="w">    </span><span class="k">END SELECT </span>
<span class="linenos"> 330</span>
<span class="linenos"> 331</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">BURP_TYP</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;uni&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 332</span><span class="k">      </span><span class="n">btyp_offset</span><span class="o">=</span><span class="mi">256</span><span class="w"></span>
<span class="linenos"> 333</span><span class="w">    </span><span class="k">else</span>
<span class="linenos"> 334</span><span class="k">      </span><span class="n">btyp_offset</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 335</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos"> 336</span>
<span class="linenos"> 337</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familytype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;AL&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 338</span><span class="k">      </span><span class="n">btyp_offset</span><span class="o">=</span><span class="mi">255</span><span class="w"></span>
<span class="linenos"> 339</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos"> 340</span>
<span class="linenos"> 341</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FAMILYTYPE2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;SCAT&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 342</span><span class="k">      </span><span class="n">btyp_offset</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 343</span><span class="w">      </span><span class="n">btyp_offset_uni</span><span class="o">=</span><span class="w"> </span><span class="mi">256</span><span class="w"> </span><span class="o">+</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 344</span><span class="w">    </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FAMILYTYPE2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;SFC&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 345</span><span class="k">      </span><span class="n">btyp_offset</span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 346</span><span class="w">      </span><span class="n">btyp_offset_uni</span><span class="o">=</span><span class="w"> </span><span class="mi">256</span><span class="w"> </span><span class="o">+</span><span class="mi">32</span><span class="w"></span>
<span class="linenos"> 347</span><span class="w">    </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FAMILYTYPE2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;UA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 348</span><span class="k">      </span><span class="n">btyp_offset_uni</span><span class="o">=</span><span class="w"> </span><span class="mi">256</span><span class="w"> </span><span class="o">+</span><span class="mi">32</span><span class="w"></span>
<span class="linenos"> 349</span><span class="w">    </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FAMILYTYPE2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;CH&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 350</span><span class="k">      </span><span class="n">btyp_offset_uni</span><span class="o">=</span><span class="w"> </span><span class="mi">256</span><span class="w"></span>
<span class="linenos"> 351</span><span class="w">    </span><span class="k">else</span>
<span class="linenos"> 352</span><span class="k">      </span><span class="n">btyp_offset_uni</span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">999</span><span class="w"> </span><span class="c">!set to -999 when not used</span>
<span class="linenos"> 353</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos"> 354</span>
<span class="linenos"> 355</span>
<span class="linenos"> 356</span><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;----------------------------------------------------&#39;</span><span class="w"></span>
<span class="linenos"> 357</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;-----------     BEGIN brpr_updateBurp   ------------&#39;</span><span class="w"></span>
<span class="linenos"> 358</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;FAMILYTYPE   =&#39;</span><span class="p">,</span><span class="n">FAMILYTYPE</span><span class="w"></span>
<span class="linenos"> 359</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;BURP_TYP btyp_offset    =&#39;</span><span class="p">,</span><span class="n">BURP_TYP</span><span class="p">,</span><span class="w"> </span><span class="n">btyp_offset</span><span class="w"></span>
<span class="linenos"> 360</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;BURP_TYP btyp_offset_uni=&#39;</span><span class="p">,</span><span class="n">BURP_TYP</span><span class="p">,</span><span class="w"> </span><span class="n">btyp_offset_uni</span><span class="w"></span>
<span class="linenos"> 361</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;----------------------------------------------------&#39;</span><span class="w"></span>
<span class="linenos"> 362</span>
<span class="linenos"> 363</span>
<span class="linenos"> 364</span><span class="w">    </span><span class="c">! initialisation</span>
<span class="linenos"> 365</span>
<span class="linenos"> 366</span><span class="w">    </span><span class="nb">SUM</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 367</span><span class="w">    </span><span class="n">opt_missing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MISSING&#39;</span><span class="w"></span>
<span class="linenos"> 368</span>
<span class="linenos"> 369</span>
<span class="linenos"> 370</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Set_Options</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 371</span><span class="w">       </span><span class="p">&amp;</span><span class="w"> </span><span class="n">REAL_OPTNAME</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">opt_missing</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 372</span><span class="w">       </span><span class="p">&amp;</span><span class="w"> </span><span class="n">REAL_OPTNAME_VALUE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 373</span><span class="w">       </span><span class="p">&amp;</span><span class="w"> </span><span class="n">CHAR_OPTNAME</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MSGLVL&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 374</span><span class="w">       </span><span class="p">&amp;</span><span class="w"> </span><span class="n">CHAR_OPTNAME_VALUE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FATAL&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 375</span><span class="w">       </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 376</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Options&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 377</span>
<span class="linenos"> 378</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">File_in</span><span class="w">      </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 379</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Init FILE_in&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 380</span>
<span class="linenos"> 381</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">Rpt_in</span><span class="p">,</span><span class="n">CP_RPT</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 382</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">Block_in</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 383</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_OMA</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 384</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_OMP</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 385</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_OER</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 386</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_FGE</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 387</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_FSO</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 388</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_OMA_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 389</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_OMP_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 390</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_OER_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 391</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_FGE_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 392</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_FSO_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 393</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_FLG_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 394</span><span class="w">    </span>
<span class="linenos"> 395</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_FLG</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 396</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">Block_FLG_CP</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 397</span>
<span class="linenos"> 398</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 399</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_MAR_MUL_CP</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 400</span>
<span class="linenos"> 401</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_OBS_SFC_CP</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 402</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_MAR_SFC_CP</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 403</span>
<span class="linenos"> 404</span><span class="w">    </span><span class="k">Call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_GEN</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 405</span><span class="w">    </span><span class="k">Call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_OBS_BND</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 406</span><span class="w">    </span><span class="k">Call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_MAR_BND</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 407</span><span class="w">    </span><span class="k">Call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">BLOCK_ORB</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 408</span>
<span class="linenos"> 409</span><span class="w">    </span><span class="c">! opening file</span>
<span class="linenos"> 410</span><span class="w">    </span><span class="c">! ------------</span>
<span class="linenos"> 411</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;OPENING BURP FILE FOR UPDATE = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">brp_file</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 412</span>
<span class="linenos"> 413</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="w"> </span><span class="n">FILENAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">brp_file</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 414</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"> </span><span class="n">MODE</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">FILE_ACC_APPEND</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 415</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 416</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_new error while opening burp file &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">brp_file</span><span class="p">))</span><span class="w"></span>
<span class="linenos"> 417</span>
<span class="linenos"> 418</span><span class="w">    </span><span class="c">! obtain input burp file number of reports</span>
<span class="linenos"> 419</span><span class="w">    </span><span class="c">! ----------------------------------------</span>
<span class="linenos"> 420</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="w"> </span><span class="n">NRPTS</span><span class="o">=</span><span class="n">nb_rpts</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 421</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">Rpt_in</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 422</span>
<span class="linenos"> 423</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;-----------------------------------------&#39;</span><span class="w"></span>
<span class="linenos"> 424</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;IOSTAT    =&#39;</span><span class="p">,</span><span class="n">error</span><span class="w"></span>
<span class="linenos"> 425</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;NUMBER OF REPORTS IN FILE  = &#39;</span><span class="p">,</span><span class="n">nb_rpts</span><span class="w"></span>
<span class="linenos"> 426</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;-----------------------------------------&#39;</span><span class="w"></span>
<span class="linenos"> 427</span>
<span class="linenos"> 428</span><span class="w">    </span><span class="c">! scan input burp file to get all reports address</span>
<span class="linenos"> 429</span><span class="w">    </span><span class="c">! -----------------------------------------------</span>
<span class="linenos"> 430</span>
<span class="linenos"> 431</span><span class="w">    </span><span class="k">Allocate</span><span class="p">(</span><span class="n">address</span><span class="p">(</span><span class="n">nb_rpts</span><span class="p">))</span><span class="w"></span>
<span class="linenos"> 432</span><span class="w">    </span><span class="n">address</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 433</span><span class="w">    </span><span class="nb">count</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 434</span><span class="w">    </span><span class="n">ref_rpt</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 435</span><span class="w">    </span><span class="n">bit_alt</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 436</span><span class="w">    </span><span class="n">stn_resume</span><span class="o">=</span><span class="s1">&#39;NOT_FOUND&#39;</span><span class="w"></span>
<span class="linenos"> 437</span>
<span class="linenos"> 438</span><span class="w">    </span><span class="k">do</span>
<span class="linenos"> 439</span><span class="k">      </span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Report</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 440</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">REPORT</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 441</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">SEARCH_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_rpt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 442</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 443</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Find_Report #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 444</span><span class="w">      </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="n">STNID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stnid</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 445</span><span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">stnid</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 446</span><span class="k">        </span><span class="n">STN_RESUME</span><span class="o">=</span><span class="n">stnid</span><span class="w"></span>
<span class="linenos"> 447</span><span class="w">        </span><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">stnid</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 448</span><span class="w">          </span><span class="k">CASE</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;BGCKALT&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&gt;&gt;POSTALT&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 449</span><span class="w">            </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 450</span><span class="w">          </span><span class="k">CASE</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;DERIALT&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 451</span><span class="w">            </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">2</span><span class="w"></span>
<span class="linenos"> 452</span><span class="w">        </span><span class="k">END SELECT </span>
<span class="linenos"> 453</span><span class="k">      END IF</span>
<span class="linenos"> 454</span>
<span class="linenos"> 455</span><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">Exit</span>
<span class="linenos"> 456</span><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="nb">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">nb_rpts</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 457</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_updateBurp: ERROR: count = nb_rpts:&#39;</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">nb_rpts</span><span class="w"></span>
<span class="linenos"> 458</span><span class="w">        </span><span class="k">exit</span>
<span class="linenos"> 459</span><span class="k">      end if</span>
<span class="linenos"> 460</span><span class="k">      </span><span class="nb">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 461</span><span class="w">      </span><span class="n">address</span><span class="p">(</span><span class="nb">count</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_rpt</span><span class="w"></span>
<span class="linenos"> 462</span><span class="w">    </span><span class="k">end do</span>
<span class="linenos"> 463</span>
<span class="linenos"> 464</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">stn_resume</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;NOT_FOUND&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 465</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_updateBurp: WARNING: No RESUME record found in this file, &#39;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 466</span><span class="w">                 </span><span class="s1">&#39;check if found during reading of all files&#39;</span><span class="w"></span>
<span class="linenos"> 467</span><span class="w">      </span><span class="c">! try to get value from previously read file</span>
<span class="linenos"> 468</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">type_resume</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="s1">&#39;UNKNOWN&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 469</span><span class="k">        </span><span class="n">stn_resume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">type_resume</span><span class="w"></span>
<span class="linenos"> 470</span><span class="w">        </span><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">stn_resume</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 471</span><span class="w">          </span><span class="k">CASE</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;BGCKALT&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&gt;&gt;POSTALT&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 472</span><span class="w">            </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 473</span><span class="w">          </span><span class="k">CASE</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;DERIALT&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 474</span><span class="w">            </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">2</span><span class="w"></span>
<span class="linenos"> 475</span><span class="w">          </span><span class="k">CASE </span><span class="n">DEFAULT</span><span class="w"></span>
<span class="linenos"> 476</span><span class="w">            </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_updateBurp: WARNING: Unknown RESUME record found, assume BGCKALT&#39;</span><span class="w"></span>
<span class="linenos"> 477</span><span class="w">            </span><span class="n">stn_resume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&gt;&gt;BGCKALT&#39;</span><span class="w"></span>
<span class="linenos"> 478</span><span class="w">            </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 479</span><span class="w">        </span><span class="k">END SELECT </span>
<span class="linenos"> 480</span><span class="k">      else</span>
<span class="linenos"> 481</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_updateBurp: WARNING: No file read has RESUME record, assume BGCKALT&#39;</span><span class="w"></span>
<span class="linenos"> 482</span><span class="w">        </span><span class="n">stn_resume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&gt;&gt;BGCKALT&#39;</span><span class="w"></span>
<span class="linenos"> 483</span><span class="w">        </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 484</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos"> 485</span><span class="k">    end if</span>
<span class="linenos"> 486</span>
<span class="linenos"> 487</span><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(a9,1x,a16,1x,i2)&#39;</span><span class="w"> </span><span class="p">)</span><span class="n">STN_RESUME</span><span class="p">,</span><span class="s1">&#39; bit_alt==== &gt;  &#39;</span><span class="p">,</span><span class="n">bit_alt</span><span class="w"></span>
<span class="linenos"> 488</span>
<span class="linenos"> 489</span><span class="w">    </span><span class="n">BTYP10obs</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mi">291</span><span class="w"> </span><span class="o">-</span><span class="n">btyp_offset</span><span class="w"></span>
<span class="linenos"> 490</span><span class="w">    </span><span class="n">BTYP10obs_uni</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">291</span><span class="w"> </span><span class="o">-</span><span class="n">btyp_offset_uni</span><span class="w"></span>
<span class="linenos"> 491</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bit_alt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">btyp10obs</span><span class="w">     </span><span class="o">=</span><span class="w">  </span><span class="n">BTYP10obs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="linenos"> 492</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bit_alt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">btyp10obs_uni</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BTYP10obs_uni</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="linenos"> 493</span>
<span class="linenos"> 494</span><span class="w">    </span><span class="n">BTYP10flg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">483</span><span class="w"> </span><span class="o">-</span><span class="n">btyp_offset</span><span class="w"></span>
<span class="linenos"> 495</span><span class="w">    </span><span class="n">BTYP10flg_uni</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">483</span><span class="w"> </span><span class="o">-</span><span class="n">btyp_offset_uni</span><span class="w"></span>
<span class="linenos"> 496</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bit_alt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">BTYP10flg</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BTYP10flg</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="linenos"> 497</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bit_alt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">BTYP10flg_uni</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BTYP10flg_uni</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="linenos"> 498</span><span class="w">    </span><span class="n">BTYP10des</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">160</span><span class="w"></span>
<span class="linenos"> 499</span>
<span class="linenos"> 500</span><span class="w">    </span><span class="n">BTYP10inf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">96</span><span class="w"></span>
<span class="linenos"> 501</span>
<span class="linenos"> 502</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="s1">&#39; NUMBER OF VALID REPORTS IN FILE = &#39;</span><span class="p">,</span><span class="nb">count</span>
<span class="linenos"> 503</span><span class="nb">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="s1">&#39; BTYP10obs BTYP10obs_uni         = &#39;</span><span class="p">,</span><span class="n">BTYP10obs</span><span class="p">,</span><span class="n">BTYP10obs_uni</span><span class="w"></span>
<span class="linenos"> 504</span>
<span class="linenos"> 505</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 506</span>
<span class="linenos"> 507</span><span class="k">      </span><span class="n">OBS_START</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 508</span><span class="w">      </span><span class="n">SAVE_OBS</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 509</span><span class="w">      </span><span class="k">DO </span><span class="n">Jo</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 510</span><span class="w">        </span><span class="n">filen</span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">Jo</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 511</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">filen</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">filenumb</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 512</span><span class="k">          </span><span class="n">OBS_START</span><span class="o">=</span><span class="n">Jo</span><span class="w"></span>
<span class="linenos"> 513</span><span class="w">          </span><span class="n">SAVE_OBS</span><span class="o">=</span><span class="n">Jo</span><span class="w"></span>
<span class="linenos"> 514</span><span class="w">          </span><span class="k">exit</span>
<span class="linenos"> 515</span><span class="k">        end if</span>
<span class="linenos"> 516</span><span class="k">      END DO</span>
<span class="linenos"> 517</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="s1">&#39;  FILE = &#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">brp_file</span><span class="p">),</span><span class="s1">&#39; OBS_START= &#39;</span><span class="p">,</span><span class="n">OBS_START</span><span class="w"></span>
<span class="linenos"> 518</span>
<span class="linenos"> 519</span><span class="w">      </span><span class="c">! Create a new report.</span>
<span class="linenos"> 520</span><span class="w">      </span><span class="c">! The factor 12 before &#39;LNMX&#39; is arbitrary.</span>
<span class="linenos"> 521</span><span class="w">      </span><span class="c">! We increase it from time to time as we encounter some</span>
<span class="linenos"> 522</span><span class="w">      </span><span class="c">! problems.</span>
<span class="linenos"> 523</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">Cp_rpt</span><span class="p">,</span><span class="w"> </span><span class="n">ALLOC_SPACE</span><span class="o">=</span><span class="mi">12</span><span class="o">*</span><span class="n">LNMX</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 524</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: error while allocating Cp_rpt&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 525</span>
<span class="linenos"> 526</span><span class="w">      </span><span class="c">! LOOP ON REPORTS</span>
<span class="linenos"> 527</span><span class="w">      </span><span class="n">REPORTS</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">kk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span>
<span class="linenos"> 528</span>
<span class="linenos"> 529</span><span class="nb">        </span><span class="k">call </span><span class="n">BURP_Get_Report</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 530</span><span class="w">                </span><span class="p">&amp;</span><span class="w"> </span><span class="n">REPORT</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 531</span><span class="w">                </span><span class="p">&amp;</span><span class="w"> </span><span class="n">REF</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">(</span><span class="n">kk</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 532</span><span class="w">                </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 533</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Get_Report #1&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 534</span><span class="w">        </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 535</span><span class="w">               </span><span class="n">STNID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stnid</span><span class="w"> </span><span class="p">,</span><span class="n">TEMPS</span><span class="w"> </span><span class="o">=</span><span class="n">hhmm_h</span><span class="p">,</span><span class="n">FLGS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="p">,</span><span class="n">IDTYP</span><span class="w"> </span><span class="o">=</span><span class="n">idtyp</span><span class="p">,</span><span class="n">LATI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lati</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 536</span><span class="w">               </span><span class="p">,</span><span class="nb">LONG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">long</span><span class="w"> </span><span class="p">,</span><span class="n">DX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="p">,</span><span class="n">DY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dy</span><span class="p">,</span><span class="n">ELEV</span><span class="o">=</span><span class="n">elev</span><span class="p">,</span><span class="n">DRND</span><span class="w"> </span><span class="o">=</span><span class="n">drnd</span><span class="p">,</span><span class="n">DATE</span><span class="w"> </span><span class="o">=</span><span class="n">date_h</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 537</span><span class="w">               </span><span class="p">,</span><span class="n">OARS</span><span class="w"> </span><span class="o">=</span><span class="n">oars</span><span class="p">,</span><span class="n">RUNN</span><span class="o">=</span><span class="n">runn</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 538</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: burp_get_property #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 539</span>
<span class="linenos"> 540</span><span class="w">        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">stnid</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos"> 541</span><span class="k">          write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="s1">&#39; RESUME RECORD POSITION IN BURP FILE =&#39;</span><span class="p">,</span><span class="n">stnid</span><span class="p">,</span><span class="n">kk</span><span class="w"></span>
<span class="linenos"> 542</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Copy_Header</span><span class="p">(</span><span class="n">TO</span><span class="o">=</span><span class="n">Cp_rpt</span><span class="p">,</span><span class="n">FROM</span><span class="o">=</span><span class="n">Rpt_in</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 543</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Init_Report_Write</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="n">Cp_Rpt</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 544</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: Burp_Init_Report_Write #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 545</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">Cp_Rpt</span><span class="p">,</span><span class="n">STNID</span><span class="w"> </span><span class="o">=</span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="o">//</span><span class="n">TYPE_RESUME</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 546</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Delete_Report</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 547</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Delete_Report #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 548</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Write_Report</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="n">Cp_rpt</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 549</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_report #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 550</span><span class="w">          </span><span class="k">cycle </span><span class="n">REPORTS</span><span class="w"></span>
<span class="linenos"> 551</span><span class="w">        </span><span class="k">ELSE</span><span class="w"></span>
<span class="linenos"> 552</span><span class="w">          </span><span class="c">!write(*,*) &#39; UPDATING STN IN BURP FILE =&#39;,  TRIM(FAMILYTYPE),KK,stnid,lati,LONG,dx,DY,elev,idtyp</span>
<span class="linenos"> 553</span><span class="w">        </span><span class="k">END IF</span>
<span class="linenos"> 554</span><span class="k">        call </span><span class="n">BURP_Copy_Header</span><span class="p">(</span><span class="n">TO</span><span class="o">=</span><span class="n">Cp_rpt</span><span class="p">,</span><span class="n">FROM</span><span class="o">=</span><span class="n">Rpt_in</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 555</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_Init_Report_Write</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="n">Cp_Rpt</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 556</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: Burp_Init_Report_Write #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 557</span>
<span class="linenos"> 558</span><span class="w">        </span><span class="c">! FIRST LOOP ON BLOCKS</span>
<span class="linenos"> 559</span>
<span class="linenos"> 560</span><span class="w">        </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 561</span>
<span class="linenos"> 562</span><span class="w">        </span><span class="n">LBLOCK_OER_CP</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 563</span><span class="w">        </span><span class="n">LBLOCK_FGE_CP</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 564</span><span class="w">        </span><span class="n">HIRES</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 565</span><span class="w">        </span><span class="n">HIPCS</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 566</span><span class="w">        </span><span class="n">REGRUP</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 567</span><span class="w">        </span><span class="n">NDATA_SF</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 568</span><span class="w">        </span><span class="c">!WRITE(*,*)&#39;  record number =&#39;,kk,&#39; obs_start =&#39;,obs_start</span>
<span class="linenos"> 569</span><span class="w">        </span><span class="n">BLOCK_LIST</span><span class="p">(:)</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 570</span><span class="w">        </span><span class="n">BLOCKS0</span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="linenos"> 571</span><span class="k">          </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Block</span><span class="p">(</span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 572</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"> </span><span class="k">BLOCK</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 573</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"> </span><span class="n">SEARCH_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_blk</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 574</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 575</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Find_Block #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 576</span>
<span class="linenos"> 577</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_blk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">EXIT </span><span class="n">BLOCKS0</span><span class="w"></span>
<span class="linenos"> 578</span>
<span class="linenos"> 579</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 580</span><span class="w">                                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NELE</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 581</span><span class="w">                                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NVAL</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nvale</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 582</span><span class="w">                                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NT</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">nte</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 583</span><span class="w">                                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BFAM</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">bfam</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 584</span><span class="w">                                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BTYP</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 585</span><span class="w">                                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BKTYP</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">bktyp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 586</span><span class="w">                                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BKNAT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BKNAT</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 587</span><span class="w">                                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BKSTP</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BKSTP</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 588</span><span class="w">                                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 589</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Get_Property #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 590</span><span class="w">          </span><span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familytype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;AL&#39;</span><span class="p">)</span><span class="k">then</span><span class="w"></span>
<span class="linenos"> 591</span>
<span class="linenos"> 592</span><span class="w">            </span><span class="c">! Fudge the block type, because the data are simulated</span>
<span class="linenos"> 593</span><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">btyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1024</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 594</span><span class="k">              </span><span class="n">btyp</span><span class="o">=</span><span class="mi">1152</span><span class="w"></span>
<span class="linenos"> 595</span><span class="w">            </span><span class="k">else if</span><span class="p">(</span><span class="n">btyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7168</span><span class="p">)</span><span class="k">then</span>
<span class="linenos"> 596</span><span class="k">              </span><span class="n">btyp</span><span class="o">=</span><span class="mi">7296</span><span class="w"></span>
<span class="linenos"> 597</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos"> 598</span><span class="k">          end if</span>
<span class="linenos"> 599</span>
<span class="linenos"> 600</span><span class="k">          </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 601</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w">  </span><span class="n">BTYP10des</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 602</span><span class="k">            </span><span class="n">Block_FLG_CP</span><span class="o">=</span><span class="n">BLOCK_IN</span><span class="w"></span>
<span class="linenos"> 603</span><span class="w">            </span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">BTYP</span><span class="w"></span>
<span class="linenos"> 604</span><span class="w">            </span><span class="n">REGRUP</span><span class="o">=</span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 605</span><span class="w">          </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs_uni</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bkstp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 606</span><span class="k">            </span><span class="n">BLOCK_OBS_SFC_CP</span><span class="o">=</span><span class="n">BLOCK_IN</span><span class="w"></span>
<span class="linenos"> 607</span><span class="w">            </span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">BTYP</span><span class="w"></span>
<span class="linenos"> 608</span><span class="w">            </span><span class="n">NDATA_SF</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 609</span><span class="w">          </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10flg_uni</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bkstp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 610</span><span class="k">            </span><span class="n">BLOCK_MAR_SFC_CP</span><span class="o">=</span><span class="n">BLOCK_IN</span><span class="w"></span>
<span class="linenos"> 611</span><span class="w">            </span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">BTYP</span><span class="w"></span>
<span class="linenos"> 612</span><span class="w">          </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 613</span><span class="k">            </span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="n">BTYP</span><span class="w"></span>
<span class="linenos"> 614</span><span class="w">            </span><span class="n">BLOCK_OBS_MUL_CP</span><span class="o">=</span><span class="n">BLOCK_IN</span><span class="w"></span>
<span class="linenos"> 615</span><span class="w">          </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10flg</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 616</span><span class="k">            </span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="n">BTYP</span><span class="w"></span>
<span class="linenos"> 617</span><span class="w">            </span><span class="n">BLOCK_MAR_MUL_CP</span><span class="o">=</span><span class="n">BLOCK_IN</span><span class="w"></span>
<span class="linenos"> 618</span><span class="w">          </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10inf</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">btyp10</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">btyp10inf</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 619</span><span class="k">            </span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BTYP</span><span class="w"></span>
<span class="linenos"> 620</span><span class="w">            </span><span class="n">BLOCK_GEN</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">BLOCK_IN</span><span class="w"></span>
<span class="linenos"> 621</span><span class="w">          </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familytype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;RO&#39;</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">btyp</span><span class="w"> </span><span class="o">==</span><span class="w">  </span><span class="mi">9217</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 622</span><span class="k">            </span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BTYP</span><span class="w"></span>
<span class="linenos"> 623</span><span class="w">            </span><span class="n">BLOCK_OBS_BND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BLOCK_IN</span><span class="w"></span>
<span class="linenos"> 624</span><span class="w">          </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familytype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;RO&#39;</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">btyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">15361</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 625</span><span class="k">            </span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BTYP</span><span class="w"></span>
<span class="linenos"> 626</span><span class="w">            </span><span class="n">BLOCK_MAR_BND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BLOCK_IN</span><span class="w"></span>
<span class="linenos"> 627</span><span class="w">          </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familytype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;RO&#39;</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">btyp</span><span class="w"> </span><span class="o">==</span><span class="w">  </span><span class="mi">9220</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 628</span><span class="k">            </span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BTYP</span><span class="w"></span>
<span class="linenos"> 629</span><span class="w">            </span><span class="n">BLOCK_ORB</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">BLOCK_IN</span><span class="w"></span>
<span class="linenos"> 630</span><span class="w">          </span><span class="k">else</span><span class="w"></span>
<span class="linenos"> 631</span><span class="w">            </span><span class="c">!WRITE(*, *)&#39; POUR STATION bloc NON CONNU: &#39;,STNID,ref_blk,bfam,familytype</span>
<span class="linenos"> 632</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos"> 633</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">bkstp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">14</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 634</span><span class="k">              </span><span class="n">LBLOCK_OER_CP</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 635</span><span class="w">              </span><span class="n">BLOCK_OER_CP</span><span class="o">=</span><span class="n">BLOCK_IN</span><span class="w"></span>
<span class="linenos"> 636</span><span class="w">          </span><span class="k">else  if</span><span class="w"> </span><span class="p">(</span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.</span><span class="nb">and</span><span class="p">.</span><span class="n">bkstp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">15</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 637</span><span class="k">              </span><span class="n">LBLOCK_FGE_CP</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 638</span><span class="w">              </span><span class="n">BLOCK_FGE_CP</span><span class="o">=</span><span class="n">BLOCK_IN</span><span class="w"></span>
<span class="linenos"> 639</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos"> 640</span><span class="k">        end do </span><span class="n">BLOCKS0</span><span class="w"></span>
<span class="linenos"> 641</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">TYPE_RESUME</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;POSTALT&#39;</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">TYPE_RESUME</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;BGCKALT&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos"> 642</span><span class="k">          </span><span class="n">post_bit</span><span class="o">=</span><span class="mi">2</span><span class="w"></span>
<span class="linenos"> 643</span><span class="w">        </span><span class="k">else</span>
<span class="linenos"> 644</span><span class="k">          </span><span class="n">post_bit</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 645</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos"> 646</span><span class="k">        </span>
<span class="linenos"> 647</span><span class="k">        </span><span class="n">BLOCKS1</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">bl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NBLOC_LIST</span><span class="w"></span>
<span class="linenos"> 648</span>
<span class="linenos"> 649</span><span class="w">          </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="n">bl</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos"> 650</span><span class="k">          </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Block</span><span class="p">(</span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 651</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"> </span><span class="k">BLOCK</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 652</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BTYP</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="n">bl</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 653</span><span class="w">                               </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 654</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Find_Block #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 655</span>
<span class="linenos"> 656</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_blk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">BLOCKS1</span><span class="w"></span>
<span class="linenos"> 657</span>
<span class="linenos"> 658</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 659</span><span class="w">                           </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NELE</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 660</span><span class="w">                           </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NVAL</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nvale</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 661</span><span class="w">                           </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NT</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">nte</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 662</span><span class="w">                           </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BFAM</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">bfam</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 663</span><span class="w">                           </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BTYP</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 664</span><span class="w">                           </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BKTYP</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">bktyp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 665</span><span class="w">                           </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BKNAT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BKNAT</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 666</span><span class="w">                           </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 667</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Get_Property #3&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 668</span><span class="w">          </span><span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familytype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;AL&#39;</span><span class="p">)</span><span class="k">then</span><span class="w"></span>
<span class="linenos"> 669</span>
<span class="linenos"> 670</span><span class="w">            </span><span class="c">! Fudge the block type, because the data are simulated</span>
<span class="linenos"> 671</span><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">btyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1024</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 672</span><span class="k">              </span><span class="n">btyp</span><span class="o">=</span><span class="mi">1152</span><span class="w"></span>
<span class="linenos"> 673</span><span class="w">            </span><span class="k">else if</span><span class="p">(</span><span class="n">btyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7168</span><span class="p">)</span><span class="k">then</span>
<span class="linenos"> 674</span><span class="k">              </span><span class="n">btyp</span><span class="o">=</span><span class="mi">7296</span><span class="w"></span>
<span class="linenos"> 675</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos"> 676</span><span class="k">          end if</span><span class="w"></span>
<span class="linenos"> 677</span>
<span class="linenos"> 678</span><span class="w">          </span><span class="c">! observation block (btyp = 0100 100011X XXXX)</span>
<span class="linenos"> 679</span><span class="w">          </span><span class="c">!======================================================</span>
<span class="linenos"> 680</span><span class="w">          </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 681</span><span class="w">          </span><span class="c">!======================================================</span>
<span class="linenos"> 682</span>
<span class="linenos"> 683</span><span class="w">          </span><span class="n">OBS_START</span><span class="o">=</span><span class="n">SAVE_OBS</span><span class="w"></span>
<span class="linenos"> 684</span><span class="w">          </span><span class="c">!if ( btyp10 - btyp10obs_uni == 0 .and. bfam == 0 ) then</span>
<span class="linenos"> 685</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bl</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 686</span><span class="k">            </span><span class="n">OBSN</span><span class="o">=</span><span class="n">OBS_START</span><span class="w"></span>
<span class="linenos"> 687</span>
<span class="linenos"> 688</span><span class="w">            </span><span class="n">NDATA_SF</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 689</span><span class="w">            </span><span class="n">new_bktyp</span><span class="o">=</span><span class="n">bktyp</span><span class="w"></span>
<span class="linenos"> 690</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">post_bit</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 691</span><span class="k">              </span><span class="n">new_bktyp</span><span class="o">=</span><span class="nb">IBSET</span><span class="p">(</span><span class="n">bktyp</span><span class="p">,</span><span class="n">post_bit</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 692</span>
<span class="linenos"> 693</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">FSOFound</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos"> 694</span><span class="w">                </span><span class="c">! to correct the btyp of SC and UA surface observation for the block</span>
<span class="linenos"> 695</span><span class="w">                </span><span class="c">! of observation value and flag</span>
<span class="linenos"> 696</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_OBS_SFC_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BKTYP</span><span class="w"> </span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="w"> </span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 697</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_MAR_SFC_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BKTYP</span><span class="w"> </span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="w"> </span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 698</span><span class="w">              </span><span class="k">else</span>
<span class="linenos"> 699</span><span class="k">                call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_OBS_SFC_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BKTYP</span><span class="w"> </span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 700</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_MAR_SFC_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BKTYP</span><span class="w"> </span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 701</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos"> 702</span>
<span class="linenos"> 703</span><span class="k">            end if</span>
<span class="linenos"> 704</span>
<span class="linenos"> 705</span><span class="k">            </span><span class="n">il_index</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 706</span><span class="w">             </span>
<span class="linenos"> 707</span><span class="w">            </span><span class="c">!call BURP_Delete_BLOCK(Rpt_in,BLOCK=Block_in)</span>
<span class="linenos"> 708</span>
<span class="linenos"> 709</span><span class="w">            </span><span class="n">OMA_SFC_EXIST</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos"> 710</span>
<span class="linenos"> 711</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">WINDS</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 712</span>
<span class="linenos"> 713</span><span class="k">               call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_OMA_SFC</span><span class="p">,</span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="n">NBELE</span><span class="p">,</span><span class="n">NVAL</span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">10</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 714</span><span class="w">                             </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 715</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_OMA #1&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 716</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_OMP_SFC</span><span class="p">,</span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="n">NBELE</span><span class="p">,</span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">10</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 717</span><span class="w">                             </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 718</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_OMP_SFC #1&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 719</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_OER_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="n">NBELE</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">14</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 720</span><span class="w">                             </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 721</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_OER_SFC #1&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 722</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_FGE_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="n">NBELE</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">15</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 723</span><span class="w">                    </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 724</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_FGE_SFC #1&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 725</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_FSO_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="n">NBELE</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">2</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 726</span><span class="w">                             </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 727</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_FSO_SFC #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 728</span><span class="w">            </span><span class="k">else</span>
<span class="linenos"> 729</span>
<span class="linenos"> 730</span><span class="k">               </span><span class="n">IND_eleu</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">11215</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 731</span><span class="w">               </span><span class="n">IND_elef</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">11011</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 732</span>
<span class="linenos"> 733</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_OMA_SFC</span><span class="p">,</span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="n">NBELE</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">NVAL</span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">10</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 734</span><span class="w">                             </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 735</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_OMA_SFC #2&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 736</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_OMP_SFC</span><span class="p">,</span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="n">NBELE</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">10</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 737</span><span class="w">                             </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 738</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_OMP_SFC #2&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 739</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_OER_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="n">NBELE</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">14</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 740</span><span class="w">                             </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 741</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_OER_SFC #2&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 742</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_FGE_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="n">NBELE</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">15</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 743</span><span class="w">                             </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 744</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_FGE_SFC #2&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 745</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_FSO_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="n">NBELE</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">2</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 746</span><span class="w">                             </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 747</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_FSO_SFC #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 748</span><span class="w">               </span><span class="n">ILEMU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11215</span><span class="w"></span>
<span class="linenos"> 749</span><span class="w">               </span><span class="n">ILEMV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">11216</span><span class="w"></span>
<span class="linenos"> 750</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OMA_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 751</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMA_SFC ILEMU&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 752</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OMA_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 753</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMA_SFC ILEMV&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 754</span>
<span class="linenos"> 755</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OMP_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 756</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMP_SFC ILEMU&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 757</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OMP_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 758</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMP_SFC ILEMV&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 759</span><span class="w">   </span>
<span class="linenos"> 760</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OER_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 761</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OER_SFC ILEMU&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 762</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OER_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 763</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OER_SFC ILEMV&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 764</span>
<span class="linenos"> 765</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_FGE_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 766</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FGE_SFC ILEMU&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 767</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_FGE_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 768</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FGE_SFC ILEMV&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 769</span>
<span class="linenos"> 770</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_FSO_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 771</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FSO_SFC ILEMU&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 772</span><span class="w">               </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_FSO_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 773</span><span class="w">               </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FSO_SFC ILEMV&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 774</span>
<span class="linenos"> 775</span><span class="w">               </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos"> 776</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OMA_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 777</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OMA_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 778</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OMP_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 779</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OMP_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 780</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OER_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 781</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OER_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 782</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_FGE_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 783</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_FGE_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 784</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_FSO_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 785</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_FSO_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 786</span><span class="w">               </span><span class="k">end do</span>
<span class="linenos"> 787</span><span class="k">               </span><span class="n">il_index</span><span class="o">=</span><span class="mi">2</span><span class="w"></span>
<span class="linenos"> 788</span>
<span class="linenos"> 789</span><span class="w">               </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">IND_eleu</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_elef</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos"> 790</span><span class="k">                 call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_OBS_SFC_CP</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 791</span><span class="w">                 </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block #1&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 792</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OBS_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 793</span><span class="w">                 </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OBS_SFC_CP ILEMU&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 794</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OBS_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 795</span><span class="w">                 </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OBS_SFC_CP ILEMV&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 796</span><span class="w">                 </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos"> 797</span><span class="w">                   </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OBS_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 798</span><span class="w">                   </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OBS_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 799</span><span class="w">                 </span><span class="k">end do</span>
<span class="linenos"> 800</span>
<span class="linenos"> 801</span><span class="k">                 call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_MAR_SFC_CP</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 802</span><span class="w">                 </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp:  BURP_Resize_Block #2&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 803</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_MAR_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="o">+</span><span class="mi">200000</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 804</span><span class="w">                 </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_MAR_SFC_CP ILEMU&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 805</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_MAR_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="o">+</span><span class="mi">200000</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 806</span><span class="w">                 </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_MAR_SFC_CP ILEMV&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 807</span><span class="w">                 </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos"> 808</span><span class="w">                   </span><span class="k">call </span><span class="n">BURP_Set_tblval</span><span class="p">(</span><span class="n">Block_MAR_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">tblval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 809</span><span class="w">                   </span><span class="k">call </span><span class="n">BURP_Set_tblval</span><span class="p">(</span><span class="n">Block_MAR_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">tblval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 810</span><span class="w">                 </span><span class="k">end do</span>
<span class="linenos"> 811</span><span class="k">                 </span><span class="n">il_index</span><span class="o">=</span><span class="mi">2</span><span class="w"></span>
<span class="linenos"> 812</span><span class="w">                 </span><span class="n">nbele</span><span class="o">=</span><span class="n">nbele</span><span class="w"> </span><span class="o">+</span><span class="mi">2</span><span class="w"></span>
<span class="linenos"> 813</span><span class="w">               </span><span class="k">end if</span>
<span class="linenos"> 814</span>
<span class="linenos"> 815</span><span class="k">             end if</span><span class="w"></span>
<span class="linenos"> 816</span>
<span class="linenos"> 817</span><span class="c">!=========================================</span>
<span class="linenos"> 818</span><span class="w">             </span><span class="n">REGRUP_SFC</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos"> 819</span><span class="c">!=========================================</span>
<span class="linenos"> 820</span><span class="w">               </span><span class="n">KOBSN</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos"> 821</span>
<span class="linenos"> 822</span><span class="c">!-------------------------------------------</span>
<span class="linenos"> 823</span><span class="w">               </span><span class="n">elems_sfc</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">IL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NBELE</span><span class="w">  </span>
<span class="linenos"> 824</span><span class="c">!-------------------------------------------</span>
<span class="linenos"> 825</span>
<span class="linenos"> 826</span><span class="w">                 </span><span class="n">iele</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 827</span><span class="w">                 </span><span class="n">iele</span><span class="o">=</span><span class="n">BURP_Get_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_SFC_CP</span><span class="p">,</span><span class="nb">INDEX</span><span class="w"> </span><span class="o">=</span><span class="n">il</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 828</span><span class="w">                 </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_GET_ELEMENT #1&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 829</span>
<span class="linenos"> 830</span><span class="w">                 </span><span class="n">IND_ELE_MAR</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_MAR_SFC_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="o">+</span><span class="mi">200000</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 831</span><span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele_mar</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos"> 832</span>
<span class="linenos"> 833</span><span class="k">                 </span><span class="n">IND_ele</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_SFC_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 834</span><span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind_ele</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ELE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element not found in BLOCK_OBS_SFC_CP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 835</span>
<span class="linenos"> 836</span><span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 837</span><span class="k">                   if</span><span class="p">(</span><span class="w"> </span><span class="n">OMA_SFC_EXIST</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 838</span><span class="k">                     if</span><span class="w"> </span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ILEMU</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ILEMV</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 839</span><span class="k">                       </span><span class="n">il_index</span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 840</span><span class="w">                       </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="w"> </span><span class="p">(</span><span class="n">BLOCK_OMA_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="w"> </span><span class="n">il_index</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 841</span><span class="w">                       </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMA_SFC&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 842</span><span class="w">                       </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="w"> </span><span class="p">(</span><span class="n">BLOCK_OMP_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="w"> </span><span class="n">il_index</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 843</span><span class="w">                       </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMP_SFC&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 844</span><span class="w">                       </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="w"> </span><span class="p">(</span><span class="n">BLOCK_OER_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="w"> </span><span class="n">il_index</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 845</span><span class="w">                       </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OER_SFC&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 846</span><span class="w">                       </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="w"> </span><span class="p">(</span><span class="n">BLOCK_FGE_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="w"> </span><span class="n">il_index</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 847</span><span class="w">                       </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FGE_SFC&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 848</span><span class="w">                       </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="w"> </span><span class="p">(</span><span class="n">BLOCK_FSO_SFC</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="w"> </span><span class="n">il_index</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 849</span><span class="w">                       </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FSO_SFC&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 850</span><span class="w">                     </span><span class="k">end if</span>
<span class="linenos"> 851</span><span class="k">                   end if</span>
<span class="linenos"> 852</span><span class="k">                 end if</span>
<span class="linenos"> 853</span>
<span class="linenos"> 854</span><span class="k">                 </span><span class="n">is_in_list</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 855</span><span class="w">                 </span><span class="n">is_in_list</span><span class="o">=</span><span class="n">FIND_INDEX</span><span class="p">(</span><span class="n">LISTE_ELE_SFC</span><span class="p">,</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 856</span><span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">is_in_list</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w">   </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w">  </span><span class="o">/=</span><span class="w"> </span><span class="n">ILEMU</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ILEMV</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">ELEMS_SFC</span><span class="w"></span>
<span class="linenos"> 857</span><span class="w">                 </span><span class="n">IND_ele_stat</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OMA_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 858</span><span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele_stat</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ele_stat</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element not found in BLOCK_OMA_SFC #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 859</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OMA_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ELE_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 860</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OMP_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ELE_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 861</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OER_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ELE_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 862</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_FGE_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ELE_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 863</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_FSO_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ELE_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 864</span>
<span class="linenos"> 865</span><span class="w">                 </span><span class="n">IFLAG</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_MAR_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_ele_mar</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 866</span><span class="w">                 </span><span class="n">OBSVA</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Rval</span><span class="w">  </span><span class="p">(</span><span class="n">Block_OBS_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_ele</span><span class="w">    </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 867</span><span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">OBSVA</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ILEMU</span><span class="w">  </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ILEMV</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos"> 868</span>
<span class="linenos"> 869</span><span class="k">                 if</span><span class="w"> </span><span class="p">(</span><span class="n">OBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 870</span><span class="k">                   write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="s1">&#39; debordement  surface OBS_START=&#39;</span><span class="p">,</span><span class="n">OBS_START</span><span class="w"></span>
<span class="linenos"> 871</span><span class="w">                   </span><span class="k">cycle</span>
<span class="linenos"> 872</span><span class="k">                 end if</span>
<span class="linenos"> 873</span>
<span class="linenos"> 874</span><span class="k">                 </span><span class="n">IRLN</span><span class="o">=</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 875</span><span class="w">                 </span><span class="n">INLV</span><span class="o">=</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_NLV</span><span class="p">,</span><span class="n">OBSN</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 876</span>
<span class="linenos"> 877</span><span class="w">                 </span><span class="n">IND_ELE_stat</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OMA_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 878</span><span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE_stat</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element not found in BLOCK_OMA_SFC #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 879</span><span class="w">                 </span><span class="n">STID</span><span class="o">=</span><span class="n">obs_elem_c</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="s1">&#39;STID&#39;</span><span class="p">,</span><span class="n">obs_start</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 880</span><span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">STID</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">stnid</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos"> 881</span>
<span class="linenos"> 882</span><span class="k">                 </span><span class="n">OBSDATA</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">LK</span><span class="o">=</span><span class="n">IRLN</span><span class="p">,</span><span class="n">IRLN</span><span class="o">+</span><span class="n">INLV</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 883</span>
<span class="linenos"> 884</span><span class="w">                   </span><span class="n">VNM</span><span class="o">=</span><span class="n">obs_bodyElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VNM</span><span class="w"> </span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 885</span><span class="w">                   </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">VNM</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">iele</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then </span>
<span class="linenos"> 886</span><span class="k">                     </span><span class="n">OBS</span><span class="o">=</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VAR</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 887</span><span class="w">                     </span><span class="n">OMA</span><span class="o">=</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_OMA</span><span class="w"> </span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 888</span><span class="w">                     </span><span class="n">OMP</span><span class="o">=</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_OMP</span><span class="w"> </span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 889</span><span class="w">                     </span><span class="n">OER</span><span class="o">=</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_OER</span><span class="w"> </span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 890</span><span class="w">                     </span><span class="n">FGE</span><span class="o">=</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_HPHT</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 891</span><span class="w">                     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RB</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FSO</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 892</span><span class="k">                       </span><span class="n">FSO</span><span class="o">=</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FSO</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 893</span><span class="w">                     </span><span class="k">else</span>
<span class="linenos"> 894</span><span class="k">                       </span><span class="n">FSO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos"> 895</span><span class="w">                     </span><span class="k">end if</span>
<span class="linenos"> 896</span><span class="k">                     if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RB</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_BCOR</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 897</span><span class="k">                       </span><span class="n">BCOR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_BCOR</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 898</span><span class="w">                     </span><span class="k">else</span>
<span class="linenos"> 899</span><span class="k">                       </span><span class="n">BCOR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos"> 900</span><span class="w">                     </span><span class="k">end if</span>
<span class="linenos"> 901</span><span class="k">                     </span><span class="n">FLG</span><span class="o">=</span><span class="n">obs_bodyElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FLG</span><span class="w"> </span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 902</span><span class="w">                     </span><span class="n">KOBSN</span><span class="o">=</span><span class="w"> </span><span class="n">KOBSN</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 903</span><span class="w">                     </span><span class="nb">SUM</span><span class="o">=</span><span class="nb">SUM</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 904</span><span class="w">                     </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OER_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OER</span><span class="w">   </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 905</span><span class="w">                     </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FGE_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FGE</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 906</span><span class="w">                     </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FSO_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FSO</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 907</span>
<span class="linenos"> 908</span><span class="w">                     </span><span class="n">IND_ELE_stat</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OMA_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 909</span><span class="w">                     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE_stat</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ELE_stat</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element not found in BLOCK_OMA_SFC #3&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 910</span><span class="w">                     </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OMA_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OMA</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 911</span>
<span class="linenos"> 912</span><span class="w">                     </span><span class="n">IND_ELE_stat</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OMP_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 913</span><span class="w">                     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE_stat</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ELE_stat</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element not found in BLOCK_OMP_SFC #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 914</span><span class="w">                     </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OMP_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OMP</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 915</span>
<span class="linenos"> 916</span><span class="w">                     </span><span class="n">IND_ELE_stat</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_FSO_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 917</span><span class="w">                     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE_stat</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ELE_stat</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element not found in BLOCK_FSO_SFC #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 918</span><span class="w">                     </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FSO_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FSO</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 919</span><span class="w">   </span>
<span class="linenos"> 920</span><span class="w">                     </span><span class="k">call </span><span class="n">BURP_Set_tblval</span><span class="p">(</span><span class="n">Block_MAR_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_mar</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="n">TBLVAL</span><span class="o">=</span><span class="w"> </span><span class="n">FLG</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 921</span><span class="w">   </span>
<span class="linenos"> 922</span><span class="w">                     </span><span class="c">!OBS=obs_bodyElem_r(obsdat,OBS_VAR,LK)</span>
<span class="linenos"> 923</span><span class="w">                     </span><span class="n">IND_ele</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_SFC_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 924</span><span class="w">                     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ele</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element not found in BLOCK_OBS_SFC #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 925</span><span class="w">                     </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OBS_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OBS</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 926</span>
<span class="linenos"> 927</span><span class="w">                     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">BUFR_NEZD</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 928</span><span class="k">                       </span><span class="n">IND_ele</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_SFC_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">ILEMZBCOR</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 929</span><span class="w">                       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">obs_columnActive_RB</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_BCOR</span><span class="p">))</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos"> 930</span><span class="w">                            </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OBS_SFC_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BCOR</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 931</span><span class="w">                     </span><span class="k">end if</span>
<span class="linenos"> 932</span><span class="k">                        </span>
<span class="linenos"> 933</span><span class="k">                     exit</span>
<span class="linenos"> 934</span><span class="k">                   end if</span>
<span class="linenos"> 935</span>
<span class="linenos"> 936</span><span class="k">                 end do  </span><span class="n">OBSDATA</span><span class="w"></span>
<span class="linenos"> 937</span><span class="c">!-------------------------------------------</span>
<span class="linenos"> 938</span><span class="w">               </span><span class="k">end do  </span><span class="n">elems_sfc</span><span class="w"></span>
<span class="linenos"> 939</span><span class="c">!-------------------------------------------</span>
<span class="linenos"> 940</span>
<span class="linenos"> 941</span><span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">REGRUP</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">KOBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w">   </span><span class="p">)</span><span class="w">  </span><span class="k">then</span>
<span class="linenos"> 942</span><span class="k">                 </span><span class="n">STATUS</span><span class="o">=</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ST1</span><span class="p">,</span><span class="n">OBS_START</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 943</span><span class="w">                 </span><span class="n">STATUS</span><span class="o">=</span><span class="nb">IBSET</span><span class="p">(</span><span class="n">STATUS</span><span class="p">,</span><span class="n">BIT_STATUS</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 944</span><span class="w">                 </span><span class="n">ind055200</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_FLG_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">055200</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 945</span><span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind055200</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind055200</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element 055200 not found in Block_FLG_CP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 946</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Set_tblval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FLG_CP</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">ind055200</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="n">TBLVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STATUS</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 947</span><span class="w">                 </span><span class="n">OBSN</span><span class="o">=</span><span class="n">OBSN</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 948</span><span class="w">                 </span><span class="n">OBS_START</span><span class="o">=</span><span class="n">OBS_START</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos"> 949</span><span class="w">               </span><span class="k">end if</span><span class="w"></span>
<span class="linenos"> 950</span><span class="c">!==============================================</span>
<span class="linenos"> 951</span><span class="w">             </span><span class="k">end do  </span><span class="n">REGRUP_SFC</span><span class="w"></span>
<span class="linenos"> 952</span><span class="c">!=============================================</span>
<span class="linenos"> 953</span>
<span class="linenos"> 954</span><span class="w">             </span><span class="k">do </span><span class="n">item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">BN_ITEMS</span><span class="w"></span>
<span class="linenos"> 955</span>
<span class="linenos"> 956</span><span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;OMA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 957</span><span class="k">                 call </span><span class="n">BURP_Reduce_Block</span><span class="p">(</span><span class="n">BLOCK_OMA_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NEW_NELE</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 958</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_OMA_SFC</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos"> 959</span><span class="w">                      </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 960</span><span class="w">                 </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_OMA_SFC&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 961</span><span class="w">                 </span><span class="k">cycle</span>
<span class="linenos"> 962</span><span class="k">               end if</span>
<span class="linenos"> 963</span><span class="k">               if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;OMP&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 964</span><span class="k">                 call </span><span class="n">BURP_Reduce_Block</span><span class="p">(</span><span class="n">BLOCK_OMP_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NEW_NELE</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 965</span><span class="w">                 </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_OMP_SFC</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos"> 966</span><span class="w">                      </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 967</span><span class="w">                 </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_OMP_SFC&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 968</span><span class="w">                 </span><span class="k">cycle</span>
<span class="linenos"> 969</span><span class="k">               end if</span>
<span class="linenos"> 970</span><span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;OER&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 971</span><span class="k">                if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">LBLOCK_OER_CP</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 972</span><span class="k">                  call </span><span class="n">BURP_Reduce_Block</span><span class="p">(</span><span class="n">BLOCK_OER_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NEW_NELE</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 973</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_OER_SFC</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos"> 974</span><span class="w">                       </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 975</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_OER_SFC&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 976</span><span class="w">                </span><span class="k">else</span>
<span class="linenos"> 977</span><span class="k">                  call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_OER_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BKTYP</span><span class="w"> </span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 978</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_OER_CP</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos"> 979</span><span class="w">                       </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 980</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_OER_CP&quot;</span><span class="p">)</span><span class="w">                 </span>
<span class="linenos"> 981</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos"> 982</span><span class="k">                cycle</span>
<span class="linenos"> 983</span><span class="k">              end if</span>
<span class="linenos"> 984</span><span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;FGE&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 985</span><span class="k">                if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">LBLOCK_FGE_CP</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos"> 986</span><span class="k">                  call </span><span class="n">BURP_Reduce_Block</span><span class="p">(</span><span class="n">BLOCK_FGE_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NEW_NELE</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 987</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_FGE_SFC</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos"> 988</span><span class="w">                       </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 989</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_FGE_SFC&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos"> 990</span><span class="w">                </span><span class="k">else</span>
<span class="linenos"> 991</span><span class="k">                  call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_FGE_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BKTYP</span><span class="w"> </span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 992</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_FGE_CP</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos"> 993</span><span class="w">                       </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 994</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_FGE_CP&quot;</span><span class="p">)</span><span class="w">                 </span>
<span class="linenos"> 995</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos"> 996</span><span class="k">                cycle</span>
<span class="linenos"> 997</span><span class="k">              end if</span>
<span class="linenos"> 998</span>
<span class="linenos"> 999</span><span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;FSO&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1000</span><span class="k">                call </span><span class="n">BURP_Reduce_Block</span><span class="p">(</span><span class="n">BLOCK_FSO_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">NEW_NELE</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1001</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_FSO_SFC</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos">1002</span><span class="w">                     </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1003</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_FSO_SFC&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1004</span><span class="w">                </span><span class="k">cycle</span>
<span class="linenos">1005</span><span class="k">              end if</span>
<span class="linenos">1006</span>
<span class="linenos">1007</span><span class="k">            end do</span>
<span class="linenos">1008</span>
<span class="linenos">1009</span><span class="k">            call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_OBS_SFC_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BFAM</span><span class="w"> </span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1010</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_MAR_SFC_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BFAM</span><span class="w"> </span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1011</span>
<span class="linenos">1012</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_OBS_SFC_CP</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos">1013</span><span class="w">                                   </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1014</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_OBS_SFC_CP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1015</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_MAR_SFC_CP</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos">1016</span><span class="w">                                   </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1017</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_MAR_SFC_CP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1018</span><span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">KOBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">REGRUP</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">1019</span><span class="k">              </span><span class="n">STATUS</span><span class="o">=</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ST1</span><span class="p">,</span><span class="n">OBS_START</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1020</span><span class="w">              </span><span class="n">STATUS</span><span class="o">=</span><span class="nb">IBSET</span><span class="p">(</span><span class="n">STATUS</span><span class="p">,</span><span class="n">BIT_STATUS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1021</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">CP_RPT</span><span class="w"> </span><span class="p">,</span><span class="n">FLGS</span><span class="w"> </span><span class="o">=</span><span class="n">STATUS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1022</span><span class="w">            </span><span class="k">END IF</span>
<span class="linenos">1023</span>
<span class="linenos">1024</span><span class="k">            </span><span class="n">SAVE_OBS</span><span class="o">=</span><span class="n">OBS_START</span><span class="w"></span>
<span class="linenos">1025</span><span class="w">            </span><span class="n">NDATA_SF</span><span class="o">=</span><span class="n">KOBSN</span><span class="w"></span>
<span class="linenos">1026</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">BLOCK_LIST</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">  </span><span class="n">KOBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">regrup</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">1027</span><span class="k">              </span><span class="n">SAVE_OBS</span><span class="o">=</span><span class="n">SAVE_OBS</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1028</span><span class="w">              </span><span class="n">OBS_START</span><span class="o">=</span><span class="n">OBS_START</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1029</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">1030</span>
<span class="linenos">1031</span><span class="k">          end if</span><span class="w">  </span><span class="c">! bl == 2</span>
<span class="linenos">1032</span>
<span class="linenos">1033</span>
<span class="linenos">1034</span><span class="w">          </span><span class="c">!if ( btyp10 - btyp10obs == 0 .and. bfam == 0 ) then</span>
<span class="linenos">1035</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bl</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1036</span><span class="k">            </span><span class="n">ILEMU</span><span class="o">=</span><span class="mi">11003</span><span class="w"></span>
<span class="linenos">1037</span><span class="w">            </span><span class="n">ILEMV</span><span class="o">=</span><span class="mi">11004</span><span class="w"></span>
<span class="linenos">1038</span><span class="w">            </span><span class="n">new_bktyp</span><span class="o">=</span><span class="n">bktyp</span><span class="w"></span>
<span class="linenos">1039</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">post_bit</span><span class="w">  </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1040</span><span class="k">              </span><span class="n">new_bktyp</span><span class="o">=</span><span class="nb">IBSET</span><span class="p">(</span><span class="n">bktyp</span><span class="p">,</span><span class="n">post_bit</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1041</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BKTYP</span><span class="w"> </span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1042</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_MAR_MUL_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BKTYP</span><span class="w"> </span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1043</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">1044</span><span class="k">            </span><span class="n">OBSN</span><span class="o">=</span><span class="n">OBS_START</span><span class="w"></span>
<span class="linenos">1045</span><span class="w">            </span><span class="n">NVAL</span><span class="o">=</span><span class="n">NVALE</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="w"></span>
<span class="linenos">1046</span>
<span class="linenos">1047</span><span class="w">            </span><span class="n">il_index</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1048</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">10</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1049</span><span class="w">                  </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1050</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_OMA&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1051</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_OMP</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">10</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1052</span><span class="w">                  </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1053</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_OMP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1054</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_OER</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">14</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1055</span><span class="w">                  </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1056</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_OER&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1057</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_FGE</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">15</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1058</span><span class="w">                  </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1059</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_FGE&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1060</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">BLOCK_FSO</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"> </span><span class="o">=</span><span class="n">nvale</span><span class="p">,</span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="p">,</span><span class="n">bfam</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">BKNAT</span><span class="o">=</span><span class="n">BKNAT</span><span class="p">,</span><span class="n">BKTYP</span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">,</span><span class="n">BKSTP</span><span class="o">=</span><span class="mi">2</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1061</span><span class="w">                  </span><span class="p">,</span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1062</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_New BLOCK_FSO&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1063</span>
<span class="linenos">1064</span><span class="w">            </span><span class="n">VCOORD_POS</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1065</span><span class="w">            </span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1066</span><span class="w">            </span><span class="n">IND_VCOORD</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1067</span><span class="w">            </span><span class="k">do while</span><span class="w"> </span><span class="p">(</span><span class="n">vcord_type</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_VCOORD</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1068</span><span class="w">               </span><span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span>
<span class="linenos">1069</span><span class="w">               </span><span class="n">IND_VCOORD</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">vcord_type</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1070</span><span class="w">            </span><span class="k">end do</span>
<span class="linenos">1071</span><span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">IND_VCOORD</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1072</span><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="s1">&#39;CH&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">1073</span><span class="k">                 </span><span class="n">ELEVFACT</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<span class="linenos">1074</span><span class="w">                 </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">vcord_type</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7006</span><span class="p">)</span><span class="w"> </span><span class="n">ELEVFACT</span><span class="o">=</span><span class="mf">1.0</span><span class="w"></span>
<span class="linenos">1075</span><span class="w">              </span><span class="k">END IF</span>
<span class="linenos">1076</span><span class="k">              call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">vcord_type</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1077</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMA&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1078</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">BLOCK_OMP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">vcord_type</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1079</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1080</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">BLOCK_OER</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">vcord_type</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1081</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OER&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1082</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">BLOCK_FGE</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">vcord_type</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1083</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FGE&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1084</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">BLOCK_FSO</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">vcord_type</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1085</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FSO #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1086</span><span class="w">              </span><span class="n">VCOORD_POS</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1087</span><span class="w">            </span><span class="k">ELSE IF</span><span class="w"> </span><span class="p">(</span><span class="n">IND_VCOORD</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">1088</span><span class="w">              </span><span class="c">!write(*,*) &#39;  PAS DE COORDONNEE VERTICALE famille &#39;,trim(FAMILYTYPE)</span>
<span class="linenos">1089</span><span class="w">              </span><span class="n">il_index</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1090</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">1091</span><span class="k">            </span><span class="n">VCOORD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">99</span><span class="mf">9.</span><span class="w"></span>
<span class="linenos">1092</span>
<span class="linenos">1093</span><span class="w">            </span><span class="n">IND_eleu</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1094</span><span class="w">            </span><span class="n">IND_elef</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">ILEMD</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1095</span>
<span class="linenos">1096</span><span class="w">            </span><span class="n">OMA_ALT_EXIST</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">1097</span><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">WINDS</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_eleu</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_elef</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1098</span><span class="k">              call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1099</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block BLOCK_OMA #1&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1100</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1101</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMA ILEMU&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1102</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1103</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMA ILEMV&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1104</span><span class="w">              </span><span class="n">OMA_ALT_EXIST</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">1105</span>
<span class="linenos">1106</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_OMP</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1107</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block BLOCK_OMP #1&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1108</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OMP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1109</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMP ILEMU&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1110</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OMP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1111</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMP ILEMV&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1112</span>
<span class="linenos">1113</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_OER</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1114</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block BLOCK_OER #1&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1115</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OER</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1116</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OER ILEMU&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1117</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OER</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1118</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OER ILEMV&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1119</span>
<span class="linenos">1120</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_FGE</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1121</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block BLOCK_FGE #1&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1122</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_FGE</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1123</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FGE ILEMU&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1124</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_FGE</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1125</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FGE ILEMV&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1126</span>
<span class="linenos">1127</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_FSO</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1128</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block BLOCK_FSO #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1129</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_FSO</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1130</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FSO ILEMU&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1131</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_FSO</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1132</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FSO ILEMV&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1133</span>
<span class="linenos">1134</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1135</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block BLOCK_OBS_MUL_CP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1136</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1137</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OBS_MUL_CP ILEMU&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1138</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1139</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OBS_MUL_CP ILEMV&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1140</span>
<span class="linenos">1141</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_MAR_MUL_CP</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1142</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block BLOCK_MAR_MUL_CP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1143</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_MAR_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMU</span><span class="o">+</span><span class="mi">200000</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1144</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_MAR_MUL_CP ILEMU&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1145</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="w"> </span><span class="n">BLOCK_MAR_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">ILEMV</span><span class="o">+</span><span class="mi">200000</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1146</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_MAR_MUL_CP ILEMV&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1147</span>
<span class="linenos">1148</span><span class="w">              </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">1149</span><span class="w">                </span><span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">1150</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OMA</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1151</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OMA</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1152</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OMP</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1153</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OMP</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1154</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OER</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1155</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OER</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1156</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FGE</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1157</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FGE</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1158</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FSO</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1159</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FSO</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">VCOORD_POS</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1160</span>
<span class="linenos">1161</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w">  </span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1162</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w">  </span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1163</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_tblval</span><span class="p">(</span><span class="n">BLOCK_MAR_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">TBLVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1164</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_tblval</span><span class="p">(</span><span class="n">BLOCK_MAR_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">2</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">TBLVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1165</span><span class="w">                </span><span class="k">end do</span>
<span class="linenos">1166</span><span class="k">              end do</span>
<span class="linenos">1167</span><span class="k">              </span><span class="n">nbele</span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">2</span><span class="w"></span>
<span class="linenos">1168</span>
<span class="linenos">1169</span><span class="w">              </span><span class="n">il_index</span><span class="o">=</span><span class="n">il_index</span><span class="o">+</span><span class="mi">2</span><span class="w"></span>
<span class="linenos">1170</span><span class="w">            </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">1171</span><span class="w">            </span><span class="c">!call BURP_Delete_BLOCK(Rpt_in,BLOCK=Block_in)</span>
<span class="linenos">1172</span>
<span class="linenos">1173</span><span class="w">            </span><span class="c">! LAT LON TIME IN DATA BLOCK</span>
<span class="linenos">1174</span><span class="w">            </span><span class="n">IND_LAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">5001</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1175</span><span class="w">            </span><span class="n">IND_LON</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">6001</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1176</span><span class="w">            </span><span class="n">IND_TIME</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">4015</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1177</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_LAT</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_LON</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_TIME</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">HIRES</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">1178</span><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">ENFORCE_CLASSIC_SONDES</span><span class="p">)</span><span class="w"> </span><span class="n">hires</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">1179</span>
<span class="linenos">1180</span><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FAMILYTYPE2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;UA&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">UA_HIGH_PRECISION_TT_ES</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">HIPCS</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">1181</span>
<span class="linenos">1182</span><span class="w">            </span><span class="c">!print * , &#39; hires =true ? ndata_sf &#39;,stnid,hires,NDATA_SF</span>
<span class="linenos">1183</span>
<span class="linenos">1184</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">HIRES</span><span class="w"> </span><span class="p">.</span><span class="nb">AND</span><span class="p">.</span><span class="w"> </span><span class="n">NDATA_SF</span><span class="w">  </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">OBS_START</span><span class="w"> </span><span class="o">=</span><span class="n">OBS_START</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1185</span><span class="w">            </span><span class="n">OBSN</span><span class="o">=</span><span class="n">OBS_START</span><span class="w"></span>
<span class="linenos">1186</span><span class="w">            </span><span class="n">STATUS_HIRES</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1187</span>
<span class="linenos">1188</span><span class="w">            </span><span class="n">regrup_LOOP</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">1189</span><span class="w">              </span><span class="n">KOBSN</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1190</span>
<span class="linenos">1191</span><span class="w">              </span><span class="n">levels</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">1192</span>
<span class="linenos">1193</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">OBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">))</span><span class="w"> </span><span class="k">then </span>
<span class="linenos">1194</span><span class="k">                  write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; debordement  altitude OBSN=&#39;</span><span class="p">,</span><span class="n">OBSN</span><span class="w"></span>
<span class="linenos">1195</span><span class="w">                </span><span class="k">else</span>
<span class="linenos">1196</span><span class="k">                  </span><span class="n">IRLN</span><span class="o">=</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1197</span><span class="w">                  </span><span class="n">INLV</span><span class="o">=</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_NLV</span><span class="p">,</span><span class="n">OBSN</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1198</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">j</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">HIRES</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">INLV</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1199</span><span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">PPPandVNM</span><span class="p">))</span><span class="w">     </span><span class="k">deallocate</span><span class="p">(</span><span class="n">PPPandVNM</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1200</span><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">bodyIndexList</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">bodyIndexList</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1201</span><span class="w">                    </span><span class="k">allocate</span><span class="p">(</span><span class="n">PPPandVNM</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">INLV</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1202</span><span class="w">                    </span><span class="k">allocate</span><span class="p">(</span><span class="n">bodyIndexList</span><span class="p">(</span><span class="n">INLV</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1203</span><span class="w">                    </span><span class="n">bodyCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1204</span><span class="w">                    </span><span class="k">do </span><span class="n">LK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IRLN</span><span class="p">,</span><span class="w"> </span><span class="n">IRLN</span><span class="o">+</span><span class="n">INLV</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1205</span><span class="w">                      </span><span class="n">bodyCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bodyCount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1206</span><span class="w">                      </span><span class="n">PPPandVNM</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">bodyCount</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_PPP</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="p">(</span><span class="n">ELEV</span><span class="o">-</span><span class="mi">40</span><span class="mf">0.</span><span class="p">)</span><span class="o">*</span><span class="n">ELEVFACT</span><span class="w"></span>
<span class="linenos">1207</span><span class="w">                      </span><span class="n">PPPandVNM</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">bodyCount</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">obs_bodyElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VNM</span><span class="p">,</span><span class="n">LK</span><span class="p">),</span><span class="mi">8</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1208</span><span class="w">                      </span><span class="n">bodyIndexList</span><span class="p">(</span><span class="n">bodyCount</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lk</span><span class="w"></span>
<span class="linenos">1209</span><span class="w">                    </span><span class="k">end do</span>
<span class="linenos">1210</span><span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">kdtree2_destroy</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1211</span><span class="w">                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">kdtree2_create</span><span class="p">(</span><span class="n">PPPandVNM</span><span class="p">,</span><span class="w"> </span><span class="n">sort</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="n">rearrange</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">1212</span><span class="w">                  </span><span class="k">end if </span>
<span class="linenos">1213</span><span class="k">                end if</span><span class="w"></span>
<span class="linenos">1214</span>
<span class="linenos">1215</span><span class="w">                </span><span class="c">!pikpik</span>
<span class="linenos">1216</span><span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">HIRES</span><span class="p">)</span><span class="w"> </span><span class="n">KOBSN</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1217</span><span class="w">                </span><span class="c">!pikpik</span>
<span class="linenos">1218</span>
<span class="linenos">1219</span><span class="w">                </span><span class="c">! Loop over elements to add all to the new blocks and the initialize values </span>
<span class="linenos">1220</span><span class="w">                </span><span class="n">elems0</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">IL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NBELE</span><span class="w"></span>
<span class="linenos">1221</span>
<span class="linenos">1222</span><span class="w">                  </span><span class="n">iele</span><span class="o">=</span><span class="n">BURP_Get_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="nb">INDEX</span><span class="w"> </span><span class="o">=</span><span class="n">il</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1223</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Get_Element BLOCK_OBS_MUL_CP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1224</span>
<span class="linenos">1225</span><span class="w">                  </span><span class="n">IND_ELE_MAR</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_MAR_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="o">+</span><span class="mi">200000</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1226</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele_mar</span><span class="w"> </span><span class="o">&lt;</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">1227</span>
<span class="linenos">1228</span><span class="k">                  </span><span class="n">IND_ele</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1229</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IND_LAT</span><span class="w">  </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">hires</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">1230</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IND_LON</span><span class="w">  </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">hires</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">1231</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IND_TIME</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">hires</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">1232</span><span class="k">                  </span><span class="n">IND_ELE_STAT</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1233</span><span class="w">                  </span><span class="n">IND_ele_STAT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1234</span>
<span class="linenos">1235</span><span class="w">                  </span><span class="k">if</span><span class="p">(</span><span class="n">j</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">il</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ind_vcoord</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_ELE_STAT</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1236</span>
<span class="linenos">1237</span><span class="k">                    </span><span class="n">il_index</span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1238</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1239</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block BLOCK_OMA #2&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1240</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="w"> </span><span class="p">(</span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il_index</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1241</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMA&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1242</span>
<span class="linenos">1243</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_OMP</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1244</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block BLOCK_OMP #2&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1245</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="w"> </span><span class="p">(</span><span class="n">BLOCK_OMP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il_index</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1246</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OMP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1247</span>
<span class="linenos">1248</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_OER</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1249</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block BLOCK_OER #2&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1250</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="w"> </span><span class="p">(</span><span class="n">BLOCK_OER</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il_index</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1251</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_OER&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1252</span>
<span class="linenos">1253</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_FGE</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1254</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block BLOCK_FGE #2&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1255</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="w"> </span><span class="p">(</span><span class="n">BLOCK_FGE</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il_index</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1256</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FGE&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1257</span>
<span class="linenos">1258</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">BLOCK_FSO</span><span class="p">,</span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1259</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Resize_Block BLOCK_FSO #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1260</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="w"> </span><span class="p">(</span><span class="n">BLOCK_FSO</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il_index</span><span class="p">,</span><span class="n">ElEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1261</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Set_Element BLOCK_FSO #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1262</span>
<span class="linenos">1263</span><span class="w">                    </span><span class="k">do </span><span class="n">ki</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">1264</span><span class="w">                      </span><span class="k">do </span><span class="n">jj</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">1265</span><span class="w">                        </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OMA</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">ki</span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1266</span><span class="w">                        </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OMP</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">ki</span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1267</span><span class="w">                        </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OER</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">ki</span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1268</span><span class="w">                        </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FGE</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">ki</span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1269</span><span class="w">                        </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FSO</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">jj</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">ki</span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1270</span><span class="w">                      </span><span class="k">end do</span>
<span class="linenos">1271</span><span class="k">                    end do</span>
<span class="linenos">1272</span>
<span class="linenos">1273</span><span class="k">                  end if</span>
<span class="linenos">1274</span>
<span class="linenos">1275</span><span class="k">                end do </span><span class="n">elems0</span><span class="w"></span>
<span class="linenos">1276</span>
<span class="linenos">1277</span><span class="w">                </span><span class="c">! Loop over elements to update the values</span>
<span class="linenos">1278</span><span class="w">                </span><span class="n">elems</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">IL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NBELE</span><span class="w">  </span>
<span class="linenos">1279</span>
<span class="linenos">1280</span><span class="w">                  </span><span class="n">iele</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1281</span><span class="w">                  </span><span class="n">iele</span><span class="o">=</span><span class="n">BURP_Get_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="nb">INDEX</span><span class="w"> </span><span class="o">=</span><span class="n">il</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1282</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Get_Element BLOCK_OBS_MUL_CP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1283</span>
<span class="linenos">1284</span><span class="w">                  </span><span class="n">IND_ELE_MAR</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_MAR_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="o">+</span><span class="mi">200000</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1285</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele_mar</span><span class="w"> </span><span class="o">&lt;</span><span class="w">  </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">1286</span>
<span class="linenos">1287</span><span class="k">                  </span><span class="n">IND_ele</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1288</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IND_LAT</span><span class="w">  </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">hires</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">1289</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IND_LON</span><span class="w">  </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">hires</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">1290</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IND_TIME</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">hires</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">1291</span><span class="k">                  </span><span class="n">IND_ELE_STAT</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1292</span><span class="w">                  </span><span class="n">IND_ele_STAT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1293</span><span class="w">                  </span><span class="n">VCOORD</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1294</span><span class="w">                                      </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_VCOORD</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1295</span><span class="w">                                      </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1296</span><span class="w">                                      </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1297</span><span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">il</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">IND_VCOORD</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">1298</span><span class="k">                    call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OMA</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1299</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OMP</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1300</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_OER</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1301</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FGE</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1302</span><span class="w">                    </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FSO</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1303</span><span class="w">                  </span><span class="k">END IF</span>
<span class="linenos">1304</span>
<span class="linenos">1305</span><span class="k">                  </span><span class="n">IND_ele</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1306</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ele</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element not found in BLOCK_OBS_MUL_CP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1307</span>
<span class="linenos">1308</span><span class="w">                  </span><span class="n">is_in_list</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1309</span><span class="w">                  </span><span class="n">is_in_list</span><span class="o">=</span><span class="n">FIND_INDEX</span><span class="p">(</span><span class="n">LISTE_ELE</span><span class="p">,</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1310</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">is_in_list</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w">   </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w">  </span><span class="o">/=</span><span class="w"> </span><span class="n">ILEMU</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ILEMV</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">1311</span>
<span class="linenos">1312</span><span class="k">                  </span><span class="n">IFLAG</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_MAR_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_ELE_MAR</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1313</span><span class="w">                  </span><span class="n">OBSVA</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Rval</span><span class="w">  </span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_ele</span><span class="w">    </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">J</span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1314</span><span class="w">                  </span><span class="c">!if( idtyp == 168 ) print * , &#39; bobossmi avant vcoord obsva    stnid =&#39;,  VCOORD,OBSVA,stnid</span>
<span class="linenos">1315</span>
<span class="linenos">1316</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">VCOORD</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CYCLE </span><span class="n">ELEMS</span><span class="w"></span>
<span class="linenos">1317</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">OBSVA</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ILEMU</span><span class="w">  </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">ILEMV</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">CYCLE </span><span class="n">ELEMS</span><span class="w"></span>
<span class="linenos">1318</span>
<span class="linenos">1319</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">OBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">))</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; debordement  altitude OBSN=&#39;</span><span class="p">,</span><span class="n">OBSN</span><span class="w"></span>
<span class="linenos">1320</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">OBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">))</span><span class="w">  </span><span class="k">cycle</span>
<span class="linenos">1321</span><span class="k">                  </span><span class="nb">TIME</span><span class="o">=</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ETM</span><span class="p">,</span><span class="n">OBSN</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1322</span><span class="w">                  </span><span class="n">STID</span><span class="o">=</span><span class="n">obs_elem_c</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="s1">&#39;STID&#39;</span><span class="p">,</span><span class="n">OBSN</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1323</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">STID</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">stnid</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">1324</span>
<span class="linenos">1325</span><span class="k">                  </span><span class="n">convfact</span><span class="o">=</span><span class="mf">1.</span><span class="w"></span>
<span class="linenos">1326</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">10194</span><span class="p">)</span><span class="w"> </span><span class="n">convfact</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="n">ec_rg</span><span class="w"></span>
<span class="linenos">1327</span>
<span class="linenos">1328</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">INLV</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1329</span><span class="k">                    </span><span class="n">refPosition</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">vcoord</span><span class="w"></span>
<span class="linenos">1330</span><span class="w">                    </span><span class="n">refPosition</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iele</span><span class="w"></span>
<span class="linenos">1331</span><span class="w">                    </span><span class="k">call </span><span class="n">kdtree2_r_nearest</span><span class="p">(</span><span class="n">tp</span><span class="o">=</span><span class="n">tree</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1332</span><span class="w">                                           </span><span class="n">qv</span><span class="o">=</span><span class="n">refPosition</span><span class="p">,</span><span class="w"> </span><span class="n">r2</span><span class="o">=</span><span class="n">maxRadius</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1333</span><span class="w">                                           </span><span class="n">nfound</span><span class="o">=</span><span class="n">numFoundSearch</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1334</span><span class="w">                                           </span><span class="n">nalloc</span><span class="o">=</span><span class="n">maxNumSearch</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1335</span><span class="w">                                           </span><span class="n">results</span><span class="o">=</span><span class="n">searchResults</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1336</span><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">numFoundSearch</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">ELEMS</span><span class="w"></span>
<span class="linenos">1337</span><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">numFoundSearch</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1338</span><span class="k">                      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;vcoord, iele = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">vcoord</span><span class="p">,</span><span class="w"> </span><span class="n">iele</span><span class="w"></span>
<span class="linenos">1339</span><span class="w">                      </span><span class="k">do </span><span class="n">resultIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numFoundSearch</span><span class="w"></span>
<span class="linenos">1340</span><span class="w">                        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ppp = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">PPPandVNM</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">searchResults</span><span class="p">(</span><span class="n">resultIndex</span><span class="p">)%</span><span class="n">idx</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1341</span><span class="w">                        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;vnm = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">PPPandVNM</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">searchResults</span><span class="p">(</span><span class="n">resultIndex</span><span class="p">)%</span><span class="n">idx</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1342</span><span class="w">                      </span><span class="k">end do</span>
<span class="linenos">1343</span><span class="k">                      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_updateBurp: multiple obs matches found, taking closest&#39;</span><span class="w"></span>
<span class="linenos">1344</span><span class="w">                    </span><span class="k">end if</span>
<span class="linenos">1345</span><span class="k">                    </span><span class="n">lk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">bodyIndexList</span><span class="p">(</span><span class="n">searchResults</span><span class="p">(</span><span class="mi">1</span><span class="p">)%</span><span class="n">idx</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1346</span><span class="w">                  </span><span class="k">else</span>
<span class="linenos">1347</span><span class="k">                    cycle </span><span class="n">ELEMS</span><span class="w"></span>
<span class="linenos">1348</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">1349</span>
<span class="linenos">1350</span><span class="k">                 </span>
<span class="linenos">1351</span><span class="k">                  </span><span class="n">OBS</span><span class="o">=</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VAR</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="o">*</span><span class="n">convfact</span><span class="w"></span>
<span class="linenos">1352</span><span class="w">                  </span><span class="n">OMA</span><span class="o">=</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_OMA</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1353</span><span class="w">                  </span><span class="n">OMP</span><span class="o">=</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_OMP</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1354</span><span class="w">                  </span><span class="n">OER</span><span class="o">=</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_OER</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1355</span><span class="w">                  </span><span class="n">FGE</span><span class="o">=</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_HPHT</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1356</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RB</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FSO</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1357</span><span class="k">                    </span><span class="n">FSO</span><span class="o">=</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FSO</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1358</span><span class="w">                  </span><span class="k">else</span>
<span class="linenos">1359</span><span class="k">                    </span><span class="n">FSO</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">1360</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">1361</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RB</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_BCOR</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1362</span><span class="k">                    </span><span class="n">BCOR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_BCOR</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1363</span><span class="w">                  </span><span class="k">else</span>
<span class="linenos">1364</span><span class="k">                    </span><span class="n">BCOR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">1365</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">1366</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RB</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_BTCL</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1367</span><span class="k">                    </span><span class="n">obsClear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_BTCL</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1368</span><span class="w">                  </span><span class="k">else</span>
<span class="linenos">1369</span><span class="k">                    </span><span class="n">obsClear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">1370</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">1371</span><span class="k">                  </span><span class="n">FLG</span><span class="o">=</span><span class="n">obs_bodyElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FLG</span><span class="p">,</span><span class="n">LK</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1372</span><span class="w">                  </span><span class="n">KOBSN</span><span class="o">=</span><span class="w"> </span><span class="n">KOBSN</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1373</span><span class="w">                  </span><span class="n">IND_ELE_stat</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1374</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE_stat</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ELE_stat</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element not found in BLOCK_OMA&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1375</span><span class="w">                  </span><span class="k">if</span><span class="w">  </span><span class="p">(</span><span class="w"> </span><span class="n">OMA</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1376</span><span class="k">                    </span><span class="n">OMA</span><span class="o">=</span><span class="n">OMA</span><span class="o">*</span><span class="n">convfact</span><span class="w"></span>
<span class="linenos">1377</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">1378</span>
<span class="linenos">1379</span><span class="k">                  call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OMA</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OMA</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1380</span>
<span class="linenos">1381</span><span class="w">                  </span><span class="k">if</span><span class="p">(</span><span class="n">HIPCS</span><span class="p">)</span><span class="w"> </span><span class="k">then  </span>
<span class="linenos">1382</span><span class="k">                    </span><span class="n">IND_ELE_tth</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">12101</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1383</span><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE_tth</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ELE_tth</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element 12101 not found in BLOCK_OMA&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1384</span><span class="w">                    </span><span class="n">IND_ELE_esh</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">12239</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1385</span><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE_esh</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ELE_esh</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element 12239 not found in BLOCK_OMA&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1386</span><span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12001</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1387</span><span class="k">                      if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele_tth</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;PB1 SYLVAIN TTH&#39;</span><span class="w"> </span>
<span class="linenos">1388</span><span class="w">                      </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OMA</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_tth</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OMA</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1389</span><span class="w">                    </span><span class="k">end if</span>
<span class="linenos">1390</span><span class="k">                    if</span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12192</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1391</span><span class="k">                      if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele_esh</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;PB1 SYLVAIN ESH&#39;</span><span class="w"></span>
<span class="linenos">1392</span><span class="w">                      </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OMA</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_esh</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OMA</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1393</span><span class="w">                    </span><span class="k">end if</span>
<span class="linenos">1394</span><span class="k">                  endif</span><span class="w"></span>
<span class="linenos">1395</span>
<span class="linenos">1396</span><span class="w">                  </span><span class="c">!if(trim(familytype) == &#39;TO&#39; )print *,&#39; bingo  stnid kk vnm ppp flg omp &#39;,stnid,kk,vnm,ppp,flg,omp,oma</span>
<span class="linenos">1397</span><span class="w">                  </span><span class="nb">SUM</span><span class="o">=</span><span class="nb">SUM</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1398</span><span class="w">                  </span><span class="n">IND_ELE_stat</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OMP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1399</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE_stat</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ELE_stat</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;element not found in BLOCK_OMP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1400</span><span class="w">                  </span><span class="k">if</span><span class="w">  </span><span class="p">(</span><span class="w"> </span><span class="n">OMP</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1401</span><span class="k">                    </span><span class="n">OMP</span><span class="o">=</span><span class="n">OMP</span><span class="o">*</span><span class="n">convfact</span><span class="w"></span>
<span class="linenos">1402</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">1403</span><span class="k">                  call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w">  </span><span class="n">Block_OMP</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OMP</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1404</span>
<span class="linenos">1405</span><span class="w">                  </span><span class="k">if</span><span class="p">(</span><span class="n">HIPCS</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1406</span><span class="k">                    if</span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12001</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OMP</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_tth</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OMP</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1407</span><span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12192</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OMP</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_esh</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OMP</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1408</span><span class="w">                  </span><span class="k">endif</span>
<span class="linenos">1409</span>
<span class="linenos">1410</span><span class="k">                  call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w">  </span><span class="n">Block_OER</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OER</span><span class="w">  </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1411</span>
<span class="linenos">1412</span><span class="w">                  </span><span class="k">if</span><span class="p">(</span><span class="n">HIPCS</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1413</span><span class="k">                    if</span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12001</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OER</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_tth</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OER</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1414</span><span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12192</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OER</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_esh</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OER</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1415</span><span class="w">                  </span><span class="k">endif</span>
<span class="linenos">1416</span>
<span class="linenos">1417</span><span class="k">                  call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w">  </span><span class="n">Block_FGE</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FGE</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1418</span>
<span class="linenos">1419</span><span class="w">                  </span><span class="k">if</span><span class="p">(</span><span class="n">HIPCS</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1420</span><span class="k">                    if</span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12001</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_FGE</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_tth</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FGE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1421</span><span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12192</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_FGE</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_esh</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FGE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1422</span><span class="w">                  </span><span class="k">endif</span>
<span class="linenos">1423</span>
<span class="linenos">1424</span><span class="k">                  call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="w">  </span><span class="n">Block_FSO</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_stat</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FSO</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1425</span>
<span class="linenos">1426</span><span class="w">                  </span><span class="k">if</span><span class="p">(</span><span class="n">HIPCS</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1427</span><span class="k">                    if</span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12001</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_FSO</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_tth</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FSO</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1428</span><span class="w">                    </span><span class="k">if</span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12192</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_FSO</span><span class="p">,</span><span class="w">  </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele_esh</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FSO</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1429</span><span class="w">                  </span><span class="k">endif</span>
<span class="linenos">1430</span>
<span class="linenos">1431</span><span class="k">                  </span><span class="n">IND_ele_mar</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_MAR_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="o">+</span><span class="mi">200000</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1432</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE_mar</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ele_mar</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element not found in Block_MAR_MUL_CP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1433</span>
<span class="linenos">1434</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_tblval</span><span class="p">(</span><span class="n">Block_MAR_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ELE_MAR</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">TBLVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FLG</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1435</span>
<span class="linenos">1436</span><span class="w">                  </span><span class="k">if</span><span class="p">(</span><span class="n">HIPCS</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1437</span><span class="k">                    if</span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12001</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1438</span><span class="k">                      </span><span class="n">IND_ele_mar</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_MAR_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">212101</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1439</span><span class="w">                      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE_mar</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ele_mar</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element 212001 not found in Block_MAR_MUL_CP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1440</span><span class="w">                      </span><span class="k">call </span><span class="n">BURP_Set_tblval</span><span class="p">(</span><span class="n">Block_MAR_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ELE_MAR</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">TBLVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FLG</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1441</span><span class="w">                    </span><span class="k">endif</span>
<span class="linenos">1442</span><span class="k">                    if</span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12192</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1443</span><span class="k">                      </span><span class="n">IND_ele_mar</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_MAR_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">212239</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1444</span><span class="w">                      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ELE_mar</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ele_mar</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element 212239 not found in Block_MAR_MUL_CP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1445</span><span class="w">                      </span><span class="k">call </span><span class="n">BURP_Set_tblval</span><span class="p">(</span><span class="n">Block_MAR_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ELE_MAR</span><span class="w"> </span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">TBLVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FLG</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1446</span><span class="w">                    </span><span class="k">endif</span>
<span class="linenos">1447</span><span class="k">                  endif</span>
<span class="linenos">1448</span>
<span class="linenos">1449</span><span class="k">                  </span><span class="n">IND_ele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1450</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">BUFR_NBT3</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1451</span><span class="k">                    </span><span class="n">IND_ele</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">12233</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1452</span><span class="w">                  </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">BUFR_NETT</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1453</span><span class="k">                    </span><span class="n">IND_ele</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">ILEMTBCOR</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1454</span><span class="w">                  </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">BUFR_NEES</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1455</span><span class="k">                    </span><span class="n">IND_ele</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">ILEMHBCOR</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1456</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">1457</span><span class="k">                      </span>
<span class="linenos">1458</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">obs_columnActive_RB</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_BCOR</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1459</span><span class="k">                       call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BCOR</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1460</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">1461</span>
<span class="linenos">1462</span><span class="k">                  </span><span class="n">IND_obsClear</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">btClearElementId</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1463</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">IND_obsClear</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">obs_columnActive_RB</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_BTCL</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1464</span><span class="k">                    Call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_obsClear</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obsClear</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1465</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">1466</span>
<span class="linenos">1467</span><span class="k">                  </span><span class="n">IND_ele</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1468</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ele</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element not found in Block_OBS_MUL_CP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1469</span>
<span class="linenos">1470</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OBS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1471</span><span class="w">                  </span>
<span class="linenos">1472</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HIPCS</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1473</span><span class="k">                     if</span><span class="w"> </span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12001</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1474</span><span class="k">                        </span><span class="n">IND_ele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">12101</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1475</span><span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ele</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element 12101 not found in Block_OBS_MUL_CP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1476</span><span class="w">                        </span><span class="k">Call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OBS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1477</span><span class="w">                     </span><span class="k">end if</span>
<span class="linenos">1478</span><span class="k">                     if</span><span class="w"> </span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12192</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1479</span><span class="k">                        </span><span class="n">IND_ele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">12239</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1480</span><span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ele</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element 12239 not found in Block_OBS_MUL_CP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1481</span><span class="w">                        </span><span class="k">Call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">IND_ele</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="n">RVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OBS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1482</span><span class="w">                     </span><span class="k">end if</span>
<span class="linenos">1483</span><span class="k">                  end if</span>
<span class="linenos">1484</span><span class="k">                  </span>
<span class="linenos">1485</span><span class="k">                  IF</span><span class="w"> </span><span class="p">(</span><span class="n">HIRES</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">KOBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">1486</span><span class="k">                    </span><span class="n">STATUS</span><span class="o">=</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ST1</span><span class="p">,</span><span class="n">OBSN</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1487</span><span class="w">                    </span><span class="n">STATUS_HIRES</span><span class="o">=</span><span class="nb">ior</span><span class="p">(</span><span class="n">STATUS_HIRES</span><span class="p">,</span><span class="n">STATUS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1488</span><span class="w">                  </span><span class="k">END IF</span>
<span class="linenos">1489</span>
<span class="linenos">1490</span><span class="k">                end do </span><span class="n">ELEMS</span><span class="w"></span>
<span class="linenos">1491</span>
<span class="linenos">1492</span><span class="w">                </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">HIRES</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">KOBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">OBSN</span><span class="o">=</span><span class="n">OBSN</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1493</span>
<span class="linenos">1494</span><span class="w">              </span><span class="k">end do </span><span class="n">LEVELS</span><span class="w"></span>
<span class="linenos">1495</span>
<span class="linenos">1496</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">REGRUP</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">KOBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w">   </span><span class="p">)</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">1497</span><span class="k">                </span><span class="n">STATUS</span><span class="o">=</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ST1</span><span class="p">,</span><span class="n">OBS_START</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1498</span><span class="w">                </span><span class="n">STATUS</span><span class="o">=</span><span class="nb">IBSET</span><span class="p">(</span><span class="n">STATUS</span><span class="p">,</span><span class="n">BIT_STATUS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1499</span><span class="w">                </span><span class="n">ind055200</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_FLG_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">055200</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1500</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind055200</span><span class="o">==-</span><span class="mi">1</span><span class="p">)</span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind055200</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: element 55200 not found in Block_FLG_CP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1501</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_tblval</span><span class="p">(</span><span class="w"> </span><span class="n">Block_FLG_CP</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="n">ind055200</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="p">,</span><span class="n">TBLVAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">STATUS</span><span class="w"> </span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1502</span><span class="w">                </span><span class="n">OBSN</span><span class="o">=</span><span class="n">OBSN</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1503</span><span class="w">                </span><span class="n">OBS_START</span><span class="o">=</span><span class="n">OBS_START</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1504</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">1505</span>
<span class="linenos">1506</span><span class="k">            end do </span><span class="n">regrup_LOOP</span><span class="w"></span>
<span class="linenos">1507</span>
<span class="linenos">1508</span><span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">HIRES</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">KOBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">regrup</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">1509</span><span class="k">              </span><span class="n">STATUS</span><span class="o">=</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ST1</span><span class="p">,</span><span class="n">OBS_START</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1510</span><span class="c">!pik 8-2014   STATUS=IBSET(STATUS,BIT_STATUS)</span>
<span class="linenos">1511</span><span class="w">              </span><span class="n">STATUS_HIRES</span><span class="o">=</span><span class="nb">IBSET</span><span class="p">(</span><span class="n">STATUS_HIRES</span><span class="p">,</span><span class="n">BIT_STATUS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1512</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">CP_RPT</span><span class="w"> </span><span class="p">,</span><span class="n">FLGS</span><span class="w"> </span><span class="o">=</span><span class="n">STATUS_HIRES</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1513</span><span class="w">            </span><span class="k">END IF</span>
<span class="linenos">1514</span><span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="n">HIRES</span><span class="w"> </span><span class="p">)</span><span class="n">OBS_START</span><span class="o">=</span><span class="n">OBSN</span><span class="w"></span>
<span class="linenos">1515</span><span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">HIRES</span><span class="w"> </span><span class="p">)</span><span class="n">SAVE_OBS</span><span class="o">=</span><span class="n">OBS_START</span><span class="w"></span>
<span class="linenos">1516</span><span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">REGRUP</span><span class="p">)</span><span class="n">OBS_START</span><span class="o">=</span><span class="n">OBSN</span><span class="w"></span>
<span class="linenos">1517</span>
<span class="linenos">1518</span><span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">HIRES</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">regrup</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">KOBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">1519</span><span class="k">              </span><span class="n">STATUS</span><span class="o">=</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ST1</span><span class="p">,</span><span class="n">OBS_START</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1520</span><span class="w">              </span><span class="n">STATUS</span><span class="o">=</span><span class="nb">IBSET</span><span class="p">(</span><span class="n">STATUS</span><span class="p">,</span><span class="n">BIT_STATUS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1521</span><span class="w">              </span><span class="n">OBS_START</span><span class="o">=</span><span class="n">OBSN</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1522</span><span class="w">              </span><span class="n">OBSN</span><span class="o">=</span><span class="n">OBSN</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1523</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">CP_RPT</span><span class="w"> </span><span class="p">,</span><span class="n">FLGS</span><span class="w"> </span><span class="o">=</span><span class="n">STATUS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1524</span><span class="w">            </span><span class="k">END IF</span>
<span class="linenos">1525</span><span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">HIRES</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">regrup</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">KOBSN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">1526</span><span class="k">              write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; KOBSN=0  stnid=&#39;</span><span class="p">,</span><span class="n">stnid</span><span class="w"></span>
<span class="linenos">1527</span><span class="w">            </span><span class="k">END IF</span>
<span class="linenos">1528</span><span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">HIRES</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">  </span><span class="n">regrup</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">KOBSN</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">1529</span><span class="k">              </span><span class="n">numHeader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1530</span><span class="w">              </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39; KOBSN=0 regrup stnid=&#39;</span><span class="p">,</span><span class="n">kk</span><span class="p">,</span><span class="n">stnid</span><span class="p">,</span><span class="n">obsn</span><span class="p">,</span><span class="n">numHeader</span><span class="w"></span>
<span class="linenos">1531</span><span class="w">            </span><span class="k">END IF</span>
<span class="linenos">1532</span>
<span class="linenos">1533</span><span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="n">REGRUP</span><span class="p">)</span><span class="w"> </span><span class="n">SAVE_OBS</span><span class="o">=</span><span class="n">OBS_START</span><span class="w"></span>
<span class="linenos">1534</span>
<span class="linenos">1535</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_Reduce_Block</span><span class="p">(</span><span class="n">BLOCK_OMA</span><span class="p">,</span><span class="w"> </span><span class="n">NEW_NELE</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1536</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_Reduce_Block</span><span class="p">(</span><span class="n">BLOCK_OMP</span><span class="p">,</span><span class="w"> </span><span class="n">NEW_NELE</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1537</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_Reduce_Block</span><span class="p">(</span><span class="n">BLOCK_OER</span><span class="p">,</span><span class="w"> </span><span class="n">NEW_NELE</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1538</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_Reduce_Block</span><span class="p">(</span><span class="n">BLOCK_FGE</span><span class="p">,</span><span class="w"> </span><span class="n">NEW_NELE</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1539</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_Reduce_Block</span><span class="p">(</span><span class="n">BLOCK_FSO</span><span class="p">,</span><span class="w"> </span><span class="n">NEW_NELE</span><span class="w"> </span><span class="o">=</span><span class="n">il_index</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">1540</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_OBS_MUL_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BFAM</span><span class="w"> </span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1541</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_MAR_MUL_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BFAM</span><span class="w"> </span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1542</span>
<span class="linenos">1543</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_OBS_MUL_CP</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos">1544</span><span class="w">                      </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1545</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_OBS_MUL_CP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1546</span><span class="w">            </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_MAR_MUL_CP</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos">1547</span><span class="w">                      </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1548</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_MAR_MUL_CP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1549</span>
<span class="linenos">1550</span><span class="w">            </span><span class="k">do </span><span class="n">item</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">BN_ITEMS</span><span class="w"></span>
<span class="linenos">1551</span>
<span class="linenos">1552</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;OMA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1553</span><span class="k">                call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_OMA</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos">1554</span><span class="w">                          </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1555</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_OMA&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1556</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">1557</span><span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;OMP&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1558</span><span class="k">                call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_OMP</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos">1559</span><span class="w">                          </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1560</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_OMP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1561</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">1562</span><span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;OER&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1563</span><span class="k">                if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">LBLOCK_OER_CP</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1564</span><span class="k">                   call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_OER</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos">1565</span><span class="w">                          </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1566</span><span class="w">                   </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_OER&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1567</span><span class="w">                </span><span class="k">else</span>
<span class="linenos">1568</span><span class="k">                   call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_OER_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BKTYP</span><span class="w"> </span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1569</span><span class="w">                   </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_OER_CP</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos">1570</span><span class="w">                        </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1571</span><span class="w">                   </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_OER_CP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1572</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">1573</span><span class="k">              end if</span>
<span class="linenos">1574</span><span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;FGE&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1575</span><span class="k">                if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">LBLOCK_FGE_CP</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1576</span><span class="k">                   call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_FGE</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos">1577</span><span class="w">                          </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1578</span><span class="w">                   </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_FGE&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1579</span><span class="w">                </span><span class="k">else</span>
<span class="linenos">1580</span><span class="k">                   call </span><span class="n">BURP_Set_Property</span><span class="p">(</span><span class="n">BLOCK_FGE_CP</span><span class="w"> </span><span class="p">,</span><span class="n">BKTYP</span><span class="w"> </span><span class="o">=</span><span class="n">new_bktyp</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1581</span><span class="w">                   </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_FGE_CP</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos">1582</span><span class="w">                        </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1583</span><span class="w">                   </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_FGE_CP&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1584</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">1585</span><span class="k">              end if</span>
<span class="linenos">1586</span><span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;FSO&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1587</span><span class="k">                 call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_FSO</span><span class="p">,&amp;</span><span class="w"></span>
<span class="linenos">1588</span><span class="w">                        </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1589</span><span class="w">                 </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_FSO&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1590</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">1591</span>
<span class="linenos">1592</span><span class="k">            end do</span>
<span class="linenos">1593</span>
<span class="linenos">1594</span><span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">regrup</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">OBS_START</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OBSN</span><span class="w"></span>
<span class="linenos">1595</span><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">hires</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">SAVE_OBS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">OBS_START</span><span class="w"></span>
<span class="linenos">1596</span>
<span class="linenos">1597</span><span class="w">          </span><span class="k">end if</span><span class="w">  </span><span class="c">! bl == 4</span>
<span class="linenos">1598</span>
<span class="linenos">1599</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">bl</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1600</span><span class="k">            call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_GEN</span><span class="p">,</span><span class="w"> </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1601</span><span class="w">                                   </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1602</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_GEN&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1603</span><span class="w">          </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">1604</span>
<span class="linenos">1605</span><span class="w">          </span><span class="c">! descriptor block (btyp = 0010 100000X XXXX) </span>
<span class="linenos">1606</span>
<span class="linenos">1607</span><span class="w">          </span><span class="n">BTYP10des</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">160</span><span class="w"></span>
<span class="linenos">1608</span>
<span class="linenos">1609</span><span class="w">          </span><span class="c">!if ( BTYP10 - BTYP10des == 0 ) then</span>
<span class="linenos">1610</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="n">bl</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1611</span><span class="k">            </span><span class="n">OBS_START</span><span class="o">=</span><span class="n">SAVE_OBS</span><span class="w"></span>
<span class="linenos">1612</span><span class="w">          </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">1613</span>
<span class="linenos">1614</span><span class="w">          </span><span class="c">!==================== IASI  SPECIAL BLOCK==================</span>
<span class="linenos">1615</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">BTYP</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">9217</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">BTYP</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">15361</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">  </span><span class="n">IDTYP</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">186</span><span class="w">   </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1616</span><span class="k">            call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_in</span><span class="p">,</span><span class="w"> </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1617</span><span class="w">                                   </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1618</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block bloc special IASI&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1619</span><span class="w">          </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">1620</span><span class="w">          </span><span class="c">!==================== IASI  SPECIAL BLOCK==================</span>
<span class="linenos">1621</span>
<span class="linenos">1622</span><span class="w">          </span><span class="c">!==================== GPSRO BLOCKS TO KEEP IF THEY EXIST===</span>
<span class="linenos">1623</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">IDTYP</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">codtyp_get_codtyp</span><span class="p">(</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1624</span><span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">BTYP</span><span class="w"> </span><span class="o">==</span><span class="w">  </span><span class="mi">9217</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1625</span><span class="k">              Call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_OBS_BND</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1626</span><span class="w">                   </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1627</span><span class="w">                   </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1628</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_OBS_BND&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1629</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">1630</span><span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">BTYP</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">15361</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1631</span><span class="k">              Call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_MAR_BND</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1632</span><span class="w">                   </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1633</span><span class="w">                   </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1634</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_MAR_BND&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1635</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">1636</span><span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">BTYP</span><span class="w"> </span><span class="o">==</span><span class="w">  </span><span class="mi">9220</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1637</span><span class="k">              Call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">BLOCK_ORB</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1638</span><span class="w">                   </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1639</span><span class="w">                   </span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1640</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Block CP_RPT BLOCK_ORB&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1641</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">1642</span><span class="k">          end if</span><span class="w"></span>
<span class="linenos">1643</span><span class="w">          </span><span class="c">!==================== GPSRO BLOCKS=========================</span>
<span class="linenos">1644</span><span class="w">        </span><span class="k">end do </span><span class="n">BLOCKS1</span><span class="w"></span>
<span class="linenos">1645</span>
<span class="linenos">1646</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="n">REGRUP</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">1647</span><span class="k">          call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="w"> </span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">Block_FLG_CP</span><span class="p">,</span><span class="w"> </span><span class="n">ENCODE_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.,</span><span class="w"> </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">1648</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">1649</span>
<span class="linenos">1650</span><span class="k">        call </span><span class="n">BURP_Delete_Report</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1651</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Delete_Report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1652</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_Write_Report</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="n">CP_RPT</span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1653</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: BURP_Write_Report&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">1654</span>
<span class="linenos">1655</span><span class="w">      </span><span class="k">end do </span><span class="n">REPORTS</span><span class="w"></span>
<span class="linenos">1656</span>
<span class="linenos">1657</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">1658</span>
<span class="linenos">1659</span><span class="k">    call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">1660</span>
<span class="linenos">1661</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; BURPFILE  UPDATED SUM = &#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">brp_file</span><span class="p">),</span><span class="nb">SUM</span>
<span class="linenos">1662</span>
<span class="linenos">1663</span><span class="nb">  </span><span class="k">contains</span><span class="w"></span>
<span class="linenos">1664</span>
<span class="linenos">1665</span><span class="w">    </span><span class="c">!--------- cleanup -----</span>
<span class="linenos">1666</span><span class="w">    </span><span class="k">subroutine </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">1667</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">1668</span><span class="k">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errors</span><span class="p">(</span><span class="mi">26</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1669</span>
<span class="linenos">1670</span><span class="w">      </span><span class="n">errors</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1671</span><span class="w">      </span><span class="k">deallocate</span><span class="p">(</span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1672</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Rpt_in</span><span class="p">,</span><span class="n">CP_RPT</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1673</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1674</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_OMA</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1675</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_OMP</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1676</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_OER</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1677</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_FGE</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1678</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_FSO</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1679</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_OMA_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1680</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_OMP_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1681</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_OER_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1682</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_FGE_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1683</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_FSO_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">13</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1684</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_FLG_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">14</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1685</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_FLG</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">15</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1686</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_FLG_CP</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">16</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1687</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_MAR_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">17</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1688</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_MAR_SFC_CP</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">18</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1689</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_OBS_MUL_CP</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">19</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1690</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_OBS_SFC_CP</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">20</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1691</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_GEN</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">21</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1692</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_OBS_BND</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">23</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1693</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_MAR_BND</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">24</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1694</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_ORB</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">25</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1695</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">26</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1696</span><span class="w">      </span><span class="c">!Should we abort here ?</span>
<span class="linenos">1697</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">errors</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;brpr_updateBurp: error while deallocating memory: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">1698</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">associated</span><span class="p">(</span><span class="n">tree</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">kdtree2_destroy</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1699</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">PPPandVNM</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">PPPandVNM</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1700</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">bodyIndexList</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">bodyIndexList</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1701</span><span class="w">      </span>
<span class="linenos">1702</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">cleanup</span><span class="w"></span>
<span class="linenos">1703</span>
<span class="linenos">1704</span><span class="w">    </span><span class="c">!--------- handle_error -----</span>
<span class="linenos">1705</span><span class="w">    </span><span class="k">subroutine </span><span class="n">handle_error</span><span class="p">(</span><span class="n">icode</span><span class="p">,</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1706</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">1707</span><span class="k">      </span><span class="kt">character</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"></span>
<span class="linenos">1708</span><span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">1709</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icode</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">burp_noerr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1710</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;error code&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">1711</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">BURP_STR_ERROR</span><span class="p">()</span><span class="w"></span>
<span class="linenos">1712</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;history&quot;</span><span class="w"></span>
<span class="linenos">1713</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_STR_ERROR_HISTORY</span><span class="p">()</span><span class="w"></span>
<span class="linenos">1714</span><span class="w">        </span><span class="k">call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">1715</span><span class="w">        </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1716</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">1717</span><span class="k">    end subroutine </span><span class="n">handle_error</span><span class="w"></span>
<span class="linenos">1718</span>
<span class="linenos">1719</span><span class="w">  </span><span class="k">end subroutine </span><span class="n">brpr_updateBurp</span><span class="w"></span>
<span class="linenos">1720</span>
<span class="linenos">1721</span>
<span class="linenos">1722</span><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="n">NML_SECTION</span><span class="p">,</span><span class="w"> </span><span class="n">beSilent_opt</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1723</span>
<span class="linenos">1724</span><span class="w">    </span><span class="k">IMPLICIT NONE</span>
<span class="linenos">1725</span>
<span class="linenos">1726</span><span class="k">    </span><span class="kt">logical</span><span class="p">,</span><span class="w"> </span><span class="k">optional</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">beSilent_opt</span><span class="w"></span>
<span class="linenos">1727</span><span class="w">    </span><span class="kt">logical</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">beSilent</span><span class="w"></span>
<span class="linenos">1728</span><span class="w">    </span><span class="kt">INTEGER</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">NULNAM</span><span class="p">,</span><span class="n">IER</span><span class="p">,</span><span class="n">FNOM</span><span class="p">,</span><span class="n">FCLOS</span><span class="w"></span>
<span class="linenos">1729</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="w"> </span><span class="o">*</span><span class="mi">256</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">NAMFILE</span><span class="w"></span>
<span class="linenos">1730</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">NML_SECTION</span><span class="w"></span>
<span class="linenos">1731</span><span class="w">    </span><span class="kt">integer</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">itemIndex</span><span class="w"></span>
<span class="linenos">1732</span>
<span class="linenos">1733</span><span class="w">    </span><span class="k">NAMELIST</span><span class="w"> </span><span class="o">/</span><span class="n">NAMBURP_FILTER_CONV</span><span class="o">/</span><span class="n">NELEMS</span><span class="p">,</span><span class="w"> </span><span class="n">BLISTELEMENTS</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1734</span><span class="w">         </span><span class="n">ENFORCE_CLASSIC_SONDES</span><span class="p">,</span><span class="w"> </span><span class="n">UA_HIGH_PRECISION_TT_ES</span><span class="p">,</span><span class="w"> </span><span class="n">UA_FLAG_HIGH_PRECISION_TT_ES</span><span class="p">,</span><span class="w"> </span><span class="n">READ_QI_GA_MT_SW</span><span class="w"></span>
<span class="linenos">1735</span><span class="w">    </span><span class="k">NAMELIST</span><span class="w"> </span><span class="o">/</span><span class="n">NAMBURP_FILTER_SFC</span><span class="o">/</span><span class="w"> </span><span class="n">NELEMS_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">BLISTELEMENTS_SFC</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1736</span><span class="w">         </span><span class="n">NELEMS_GPS</span><span class="p">,</span><span class="w"> </span><span class="n">LISTE_ELE_GPS</span><span class="w"></span>
<span class="linenos">1737</span><span class="w">    </span><span class="k">NAMELIST</span><span class="w"> </span><span class="o">/</span><span class="n">NAMBURP_FILTER_TOVS</span><span class="o">/</span><span class="n">NELEMS</span><span class="p">,</span><span class="w"> </span><span class="n">BLISTELEMENTS</span><span class="w"></span>
<span class="linenos">1738</span><span class="w">    </span><span class="k">NAMELIST</span><span class="w"> </span><span class="o">/</span><span class="n">NAMBURP_FILTER_CHM_SFC</span><span class="o">/</span><span class="n">NELEMS_SFC</span><span class="p">,</span><span class="w"> </span><span class="n">BLISTELEMENTS_SFC</span><span class="w"></span>
<span class="linenos">1739</span><span class="w">    </span><span class="k">NAMELIST</span><span class="w"> </span><span class="o">/</span><span class="n">NAMBURP_FILTER_CHM</span><span class="o">/</span><span class="n">NELEMS</span><span class="p">,</span><span class="w"> </span><span class="n">BLISTELEMENTS</span><span class="w"></span>
<span class="linenos">1740</span><span class="w">    </span><span class="k">NAMELIST</span><span class="w"> </span><span class="o">/</span><span class="n">NAMBURP_UPDATE</span><span class="o">/</span><span class="n">BN_ITEMS</span><span class="p">,</span><span class="w"> </span><span class="n">BITEMLIST</span><span class="p">,</span><span class="w"> </span><span class="n">TYPE_RESUME</span><span class="w"></span>
<span class="linenos">1741</span>
<span class="linenos">1742</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">present</span><span class="p">(</span><span class="n">beSilent_opt</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1743</span><span class="k">      </span><span class="n">beSilent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beSilent_opt</span><span class="w"></span>
<span class="linenos">1744</span><span class="w">    </span><span class="k">else</span>
<span class="linenos">1745</span><span class="k">      </span><span class="n">beSilent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">1746</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">1747</span>
<span class="linenos">1748</span><span class="k">    </span><span class="n">NAMFILE</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="s2">&quot;flnml&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1749</span><span class="w">    </span><span class="n">nulnam</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1750</span><span class="w">    </span><span class="n">IER</span><span class="o">=</span><span class="n">FNOM</span><span class="p">(</span><span class="n">NULNAM</span><span class="p">,</span><span class="n">NAMFILE</span><span class="p">,</span><span class="s1">&#39;R/O&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1751</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; READ NML_SECTION =&#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">NML_SECTION</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1752</span>
<span class="linenos">1753</span><span class="w">    </span><span class="k">SELECT CASE</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">NML_SECTION</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1754</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;namburp_filter_gp&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1755</span><span class="w">        </span><span class="n">nElems_gps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">1756</span><span class="w">        </span><span class="n">LISTE_ELE_GPS</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpc_missingValue_int</span><span class="w"></span>
<span class="linenos">1757</span><span class="w">        </span><span class="k">READ</span><span class="p">(</span><span class="n">NULNAM</span><span class="p">,</span><span class="n">NML</span><span class="o">=</span><span class="n">NAMBURP_FILTER_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1758</span><span class="w">        </span><span class="k">call </span><span class="n">getListAndSize</span><span class="p">(</span><span class="n">nElems_gps</span><span class="p">,</span><span class="w"> </span><span class="n">LISTE_ELE_GPS</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;nElems_gps&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1759</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">beSilent</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">nml</span><span class="o">=</span><span class="n">NAMBURP_FILTER_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1760</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nElems_gps</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1761</span><span class="k">          call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpacma_nml (burpread_mod): no GPS elements specified in NAMBURP_FILTER_SFC&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1762</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">1763</span><span class="k">      CASE</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;namburp_filter_sfc&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1764</span><span class="w">        </span><span class="n">nElems_sfc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">1765</span><span class="w">        </span><span class="n">bListElements_sfc</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpc_missingValue_int</span><span class="w"></span>
<span class="linenos">1766</span><span class="w">        </span><span class="k">READ</span><span class="p">(</span><span class="n">NULNAM</span><span class="p">,</span><span class="n">NML</span><span class="o">=</span><span class="n">NAMBURP_FILTER_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1767</span><span class="w">        </span><span class="k">call </span><span class="n">getListAndSize</span><span class="p">(</span><span class="n">nelems_sfc</span><span class="p">,</span><span class="w"> </span><span class="n">blistelements_sfc</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;nelems_sfc&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1768</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">beSilent</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">nml</span><span class="o">=</span><span class="n">NAMBURP_FILTER_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1769</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nElems_sfc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1770</span><span class="k">          call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpacma_nml (burpread_mod): no SFC elements specified in NAMBURP_FILTER_SFC&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1771</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">1772</span><span class="k">      CASE</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1773</span><span class="w">        </span><span class="n">nElems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">1774</span><span class="w">        </span><span class="n">bListElements</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpc_missingValue_int</span><span class="w"></span>
<span class="linenos">1775</span><span class="w">        </span><span class="k">READ</span><span class="p">(</span><span class="n">NULNAM</span><span class="p">,</span><span class="n">NML</span><span class="o">=</span><span class="n">NAMBURP_FILTER_CONV</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1776</span><span class="w">        </span><span class="k">call </span><span class="n">getListAndSize</span><span class="p">(</span><span class="n">nelems</span><span class="p">,</span><span class="w"> </span><span class="n">blistelements</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;nelems&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1777</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">beSilent</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">nml</span><span class="o">=</span><span class="n">NAMBURP_FILTER_CONV</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1778</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nElems</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1779</span><span class="k">          call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpacma_nml (burpread_mod): no elements specified in NAMBURP_FILTER_CONV&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1780</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">1781</span><span class="k">      CASE</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;namburp_filter_tovs&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1782</span><span class="w">        </span><span class="n">nElems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">1783</span><span class="w">        </span><span class="n">bListElements</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpc_missingValue_int</span><span class="w"></span>
<span class="linenos">1784</span><span class="w">        </span><span class="k">READ</span><span class="p">(</span><span class="n">NULNAM</span><span class="p">,</span><span class="n">NML</span><span class="o">=</span><span class="n">NAMBURP_FILTER_TOVS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1785</span><span class="w">        </span><span class="k">call </span><span class="n">getListAndSize</span><span class="p">(</span><span class="n">nelems</span><span class="p">,</span><span class="w"> </span><span class="n">blistelements</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;nelems&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1786</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">beSilent</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">nml</span><span class="o">=</span><span class="n">NAMBURP_FILTER_TOVS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1787</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nElems</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1788</span><span class="k">          call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpacma_nml (burpread_mod): no elements specified in NAMBURP_FILTER_TOVS&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1789</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">1790</span><span class="k">      CASE</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;namburp_filter_chm_sfc&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1791</span><span class="w">        </span><span class="n">nElems_sfc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">1792</span><span class="w">        </span><span class="n">bListElements_sfc</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpc_missingValue_int</span><span class="w"></span>
<span class="linenos">1793</span><span class="w">        </span><span class="k">READ</span><span class="p">(</span><span class="n">NULNAM</span><span class="p">,</span><span class="n">NML</span><span class="o">=</span><span class="n">NAMBURP_FILTER_CHM_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1794</span><span class="w">        </span><span class="k">call </span><span class="n">getListAndSize</span><span class="p">(</span><span class="n">nelems_sfc</span><span class="p">,</span><span class="w"> </span><span class="n">blistelements_sfc</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;nelems_sfc&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1795</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">beSilent</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">nml</span><span class="o">=</span><span class="n">NAMBURP_FILTER_CHM_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1796</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nElems_sfc</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1797</span><span class="k">          call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpacma_nml (burpread_mod): no elements specified in NAMBURP_FILTER_CHM_SFC&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1798</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">1799</span><span class="k">      CASE</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;namburp_filter_chm&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1800</span><span class="w">        </span><span class="n">nElems</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">1801</span><span class="w">        </span><span class="n">bListElements</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpc_missingValue_int</span><span class="w"></span>
<span class="linenos">1802</span><span class="w">        </span><span class="k">READ</span><span class="p">(</span><span class="n">NULNAM</span><span class="p">,</span><span class="n">NML</span><span class="o">=</span><span class="n">NAMBURP_FILTER_CHM</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1803</span><span class="w">        </span><span class="k">call </span><span class="n">getListAndSize</span><span class="p">(</span><span class="n">nelems</span><span class="p">,</span><span class="w"> </span><span class="n">blistelements</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;nelems&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1804</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">beSilent</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">nml</span><span class="o">=</span><span class="n">NAMBURP_FILTER_CHM</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1805</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">nElems</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1806</span><span class="k">          call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpacma_nml (burpread_mod): no elements specified in NAMBURP_FILTER_CHM&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1807</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">1808</span><span class="k">      CASE</span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;namburp_update&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1809</span><span class="w">        </span><span class="n">BN_ITEMS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">1810</span><span class="w">        </span><span class="n">bItemList</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;***&#39;</span><span class="w"> </span>
<span class="linenos">1811</span><span class="w">        </span><span class="k">READ</span><span class="p">(</span><span class="n">NULNAM</span><span class="p">,</span><span class="n">NML</span><span class="o">=</span><span class="n">NAMBURP_UPDATE</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1812</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">BN_ITEMS</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1813</span><span class="k">          call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpacma_nml: check namburp_update namelist section, you should remove BN_ITEMS&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1814</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">1815</span><span class="k">        </span><span class="n">BN_ITEMS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1816</span><span class="w">        </span><span class="k">do </span><span class="n">itemIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">maxItems</span><span class="w"> </span>
<span class="linenos">1817</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bItemList</span><span class="p">(</span><span class="n">itemIndex</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;***&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="linenos">1818</span><span class="k">          </span><span class="n">BN_ITEMS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BN_ITEMS</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1819</span><span class="w">        </span><span class="k">end do</span>
<span class="linenos">1820</span><span class="k">        if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">beSilent</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">nml</span><span class="o">=</span><span class="n">NAMBURP_UPDATE</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1821</span><span class="w">      </span><span class="k">CASE </span><span class="n">default</span><span class="w"></span>
<span class="linenos">1822</span><span class="w">        </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpacma_nml: unknown namelist section &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">NML_SECTION</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1823</span><span class="w">      </span><span class="k">END SELECT</span>
<span class="linenos">1824</span>
<span class="linenos">1825</span><span class="k">    </span><span class="n">ier</span><span class="o">=</span><span class="n">FCLOS</span><span class="p">(</span><span class="n">NULNAM</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1826</span>
<span class="linenos">1827</span><span class="w">  </span><span class="k">contains</span>
<span class="linenos">1828</span>
<span class="linenos">1829</span><span class="k">    subroutine </span><span class="n">getListAndSize</span><span class="p">(</span><span class="n">numberElements</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">variable</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1830</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">1831</span><span class="k">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">numberElements</span><span class="w"></span>
<span class="linenos">1832</span><span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">list</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">1833</span><span class="w">      </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">variable</span><span class="w"></span>
<span class="linenos">1834</span><span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">listIndex</span><span class="w"></span>
<span class="linenos">1835</span><span class="w">      </span>
<span class="linenos">1836</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">numberElements</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">1837</span><span class="k">        call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpacma_nml: check &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">nml_section</span><span class="p">)</span><span class="o">//</span><span class="s1">&#39; namelist section, you should remove &#39;</span><span class="o">//</span><span class="nb">trim</span><span class="p">(</span><span class="n">variable</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1838</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">1839</span><span class="k">      </span><span class="n">numberElements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1840</span><span class="w">      </span><span class="k">do </span><span class="n">listIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">list</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1841</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="p">(</span><span class="n">listIndex</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="linenos">1842</span><span class="k">        </span><span class="n">numberElements</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numberElements</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1843</span><span class="w">      </span><span class="k">end do</span>
<span class="linenos">1844</span>
<span class="linenos">1845</span><span class="k">    end subroutine </span><span class="n">getListAndSize</span><span class="w"></span>
<span class="linenos">1846</span><span class="w">    </span>
<span class="linenos">1847</span><span class="w">  </span><span class="k">END SUBROUTINE </span><span class="n">BRPACMA_NML</span><span class="w"></span>
<span class="linenos">1848</span>
<span class="linenos">1849</span>
<span class="linenos">1850</span><span class="w">  </span><span class="k">subroutine </span><span class="n">brpr_readBurp</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">familytype</span><span class="p">,</span><span class="n">brp_file</span><span class="p">,</span><span class="n">filenumb</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1851</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">1852</span><span class="w">    </span><span class="c">!:Purpose: Select variables relative to airs in burp file. Read burp file.</span>
<span class="linenos">1853</span>
<span class="linenos">1854</span><span class="w">    </span><span class="c">!***********************************************************************</span>
<span class="linenos">1855</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">1856</span><span class="w">    </span><span class="c">!          WHEN SEARCHING FOR A SPECIFIC BLOCK BY ITS BTYP, VALUES OF</span>
<span class="linenos">1857</span><span class="w">    </span><span class="c">!          BIT 0 TO 3 ARE IRRELEVANT WHILE BIT 4 IS 0 FOR GLOBAL AND 1</span>
<span class="linenos">1858</span><span class="w">    </span><span class="c">!          FOR REGIONAL MODEL. HERE, WE SEARCH BLOCK BY THEIR FIRST</span>
<span class="linenos">1859</span><span class="w">    </span><span class="c">!          10 BITS (BIT 5 TO 14).</span>
<span class="linenos">1860</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">1861</span><span class="w">    </span><span class="c">!***********************************************************************</span>
<span class="linenos">1862</span><span class="w">    </span><span class="k">IMPLICIT NONE</span><span class="w"></span>
<span class="linenos">1863</span>
<span class="linenos">1864</span><span class="w">    </span><span class="c">! Arguments</span>
<span class="linenos">1865</span><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="p">(</span><span class="n">struct_obs</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">obsdat</span><span class="w"></span>
<span class="linenos">1866</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="w"> </span><span class="o">*</span><span class="mi">2</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">FAMILYTYPE</span><span class="w"></span>
<span class="linenos">1867</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">BRP_FILE</span><span class="w"> </span><span class="c">! name of burp file</span>
<span class="linenos">1868</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">FILENUMB</span><span class="w"></span>
<span class="linenos">1869</span>
<span class="linenos">1870</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">1871</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="w"> </span><span class="o">*</span><span class="mi">2</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">UNI_FAMILYTYPE</span><span class="w"></span>
<span class="linenos">1872</span>
<span class="linenos">1873</span><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">BURP_FILE</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">FILE_IN</span><span class="w"></span>
<span class="linenos">1874</span><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">BURP_RPT</span><span class="p">)</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">RPT_IN</span><span class="w"></span>
<span class="linenos">1875</span><span class="w">    </span><span class="k">TYPE</span><span class="p">(</span><span class="n">BURP_BLOCK</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">BLOCK_IN</span><span class="w"></span>
<span class="linenos">1876</span><span class="w">    </span>
<span class="linenos">1877</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">FAMILYTYPE2</span><span class="w"></span>
<span class="linenos">1878</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">OPT_MISSING</span><span class="w"></span>
<span class="linenos">1879</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">BTYP</span><span class="p">,</span><span class="n">BFAM</span><span class="p">,</span><span class="n">BKSTP</span><span class="p">,</span><span class="n">BTYP10</span><span class="p">,</span><span class="n">BTYP10FLG_uni</span><span class="p">,</span><span class="n">BTYP10obs_uni</span><span class="w"> </span>
<span class="linenos">1880</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">BTYP10DES</span><span class="p">,</span><span class="n">BTYP10INF</span><span class="p">,</span><span class="n">BTYP10OBS</span><span class="p">,</span><span class="n">BTYP10FLG</span><span class="w"></span>
<span class="linenos">1881</span>
<span class="linenos">1882</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">NB_RPTS</span><span class="p">,</span><span class="n">REF_RPT</span><span class="p">,</span><span class="n">REF_BLK</span><span class="p">,</span><span class="nb">COUNT</span><span class="p">,</span><span class="w"> </span><span class="n">numHeader</span><span class="w"></span>
<span class="linenos">1883</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">ADDRESS</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">1884</span>
<span class="linenos">1885</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">OBSVALUE</span><span class="p">(:,:,:),</span><span class="n">OBSVALUE_SFC</span><span class="p">(:,:,:)</span><span class="w"></span>
<span class="linenos">1886</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">OBSERV</span><span class="w">  </span><span class="p">(:,:),</span><span class="w">    </span><span class="n">OBSERV_SFC</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">1887</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">BiasCorrection_sfc</span><span class="p">(:,:,:)</span><span class="w"></span>
<span class="linenos">1888</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">BCOR_SFC</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">1889</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">PARAMETER</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">MAXRONVAL</span><span class="o">=</span><span class="mi">500</span><span class="w"></span>
<span class="linenos">1890</span><span class="w">    </span><span class="kt">real</span><span class="w">                   </span><span class="kd">::</span><span class="w"> </span><span class="n">ROLAT</span><span class="p">(</span><span class="n">MAXRONVAL</span><span class="p">),</span><span class="w"> </span><span class="n">ROLON</span><span class="p">(</span><span class="n">MAXRONVAL</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1891</span>
<span class="linenos">1892</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">MTVAL</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">1893</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">HAVAL</span><span class="p">(:),</span><span class="w"> </span><span class="n">GAVAL</span><span class="p">(:),</span><span class="w"> </span><span class="n">QI1VAL</span><span class="p">(:)</span><span class="w"> </span><span class="p">,</span><span class="n">QI2VAL</span><span class="p">(:),</span><span class="w"> </span><span class="n">LSVAL</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">1894</span><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">azimuth</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">1895</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">QCFLAG</span><span class="w">  </span><span class="p">(:,:,:),</span><span class="w">  </span><span class="n">QCFLAG_SFC</span><span class="p">(:,:,:)</span><span class="w"></span>
<span class="linenos">1896</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">QCFLAGS</span><span class="w"> </span><span class="p">(:,:),</span><span class="w">   </span><span class="n">QCFLAGS_SFC</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">1897</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">hiresTimeFlag</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">hiresLatFlag</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">1898</span>
<span class="linenos">1899</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">VCOORD</span><span class="w">  </span><span class="p">(:,:),</span><span class="w">  </span><span class="n">VCOORD_SFC</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">1900</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">VCORD</span><span class="w">   </span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">1901</span>
<span class="linenos">1902</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">LAT</span><span class="p">(:),</span><span class="n">LON</span><span class="p">(:),</span><span class="n">HHMM</span><span class="p">(:),</span><span class="n">DATE</span><span class="p">(:),</span><span class="n">GLBFLAG</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">1903</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">HLAT</span><span class="p">(:,:),</span><span class="w">  </span><span class="n">HLON</span><span class="p">(:,:),</span><span class="w">  </span><span class="n">HTIME</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">1904</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">PHASE</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">1905</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">dataQcFlagLEV</span><span class="p">(:),</span><span class="n">dataQcFlag2</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">1906</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">dataQcFlagLEV_sfc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1907</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">dataCloudFracLEV</span><span class="p">(:),</span><span class="n">dataCloudFrac</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">1908</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">dataCloudFracLEV_sfc</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1909</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">HLAT_SFC</span><span class="p">(:),</span><span class="n">HLON_SFC</span><span class="p">(:),</span><span class="n">HTIME_SFC</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">1910</span>
<span class="linenos">1911</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">RINFO</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">1912</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">TRINFO</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">1913</span>
<span class="linenos">1914</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">EMIS</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">SURF_EMIS</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">1915</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">BCOR</span><span class="p">(:,:),</span><span class="w"> </span><span class="n">BiasCorrection</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">1916</span><span class="w">    </span><span class="kt">real</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">BCOR2</span><span class="p">(:,:,:),</span><span class="w"> </span><span class="n">BiasCorrection2</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">1917</span>
<span class="linenos">1918</span><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">pre_obsReal</span><span class="p">),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">CFRAC</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">1919</span>
<span class="linenos">1920</span><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">pre_obsReal</span><span class="p">),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">RADMOY</span><span class="p">(:,:,:)</span><span class="w"></span>
<span class="linenos">1921</span><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">pre_obsReal</span><span class="p">),</span><span class="w"> </span><span class="k">ALLOCATABLE</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">radstd</span><span class="p">(:,:,:)</span><span class="w"></span>
<span class="linenos">1922</span>
<span class="linenos">1923</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">LISTE_INFO</span><span class="p">(</span><span class="mi">31</span><span class="p">),</span><span class="n">LISTE_ELE</span><span class="p">(</span><span class="n">maxElements</span><span class="p">),</span><span class="n">LISTE_ELE_SFC</span><span class="p">(</span><span class="n">maxElements</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1924</span><span class="w">    </span>
<span class="linenos">1925</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">NBELE</span><span class="p">,</span><span class="n">NVALE</span><span class="p">,</span><span class="n">NTE</span><span class="w"></span>
<span class="linenos">1926</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">J</span><span class="p">,</span><span class="n">JJ</span><span class="p">,</span><span class="n">K</span><span class="p">,</span><span class="n">KK</span><span class="p">,</span><span class="n">KL</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">ERROR</span><span class="p">,</span><span class="n">OBSN</span><span class="w"></span>
<span class="linenos">1927</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">info_elepos</span><span class="p">,</span><span class="n">IND_ELE</span><span class="p">,</span><span class="n">IND_VCOORD</span><span class="p">,</span><span class="n">IND_QCFLAG</span><span class="p">,</span><span class="n">IND_SW</span><span class="w"></span>
<span class="linenos">1928</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">IND055200</span><span class="p">,</span><span class="n">IND4208</span><span class="p">,</span><span class="n">ind4197</span><span class="p">,</span><span class="n">IND5002</span><span class="p">,</span><span class="n">IND6002</span><span class="p">,</span><span class="n">ind_al</span><span class="p">,</span><span class="n">IND5001</span><span class="p">,</span><span class="n">IND6001</span><span class="w"></span>
<span class="linenos">1929</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">IND_LAT</span><span class="p">,</span><span class="n">IND_LON</span><span class="p">,</span><span class="n">IND_TIME</span><span class="p">,</span><span class="n">IND_EMIS</span><span class="p">,</span><span class="n">IND_BCOR</span><span class="p">,</span><span class="n">IND_PHASE</span><span class="p">,</span><span class="n">IND_BCOR_TT</span><span class="p">,</span><span class="n">IND_BCOR_HU</span><span class="w"></span>
<span class="linenos">1930</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">FLAG_PASSAGE1</span><span class="p">,</span><span class="n">FLAG_PASSAGE2</span><span class="p">,</span><span class="n">FLAG_PASSAGE3</span><span class="p">,</span><span class="n">FLAG_PASSAGE4</span><span class="w"></span>
<span class="linenos">1931</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">IND_dataQcFlag0</span><span class="p">,</span><span class="w"> </span><span class="n">IND_dataQcFlag1</span><span class="p">,</span><span class="w"> </span><span class="n">IND_dataQcFlag2</span><span class="p">,</span><span class="w"> </span><span class="n">IND_dataCloudFrac</span><span class="w"> </span>
<span class="linenos">1932</span>
<span class="linenos">1933</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="nb">SUM</span><span class="p">,</span><span class="n">vcoord_type</span><span class="w"></span>
<span class="linenos">1934</span><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w">      </span><span class="kd">::</span><span class="w"> </span><span class="n">RELEV</span><span class="p">,</span><span class="n">XLAT</span><span class="p">,</span><span class="n">XLON</span><span class="p">,</span><span class="n">RELEV2</span><span class="w"></span>
<span class="linenos">1935</span><span class="w">    </span><span class="kt">real</span><span class="w">                   </span><span class="kd">::</span><span class="w"> </span><span class="n">XTIME</span><span class="p">,</span><span class="n">ROLAT0</span><span class="p">,</span><span class="n">ROLON0</span><span class="p">,</span><span class="n">ROLAT1</span><span class="p">,</span><span class="n">ROLON1</span><span class="w"></span>
<span class="linenos">1936</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="p">,</span><span class="n">idtyp</span><span class="p">,</span><span class="n">lati</span><span class="p">,</span><span class="nb">long</span><span class="p">,</span><span class="n">dx</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">elev</span><span class="w"></span>
<span class="linenos">1937</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">drnd</span><span class="p">,</span><span class="n">date_h</span><span class="p">,</span><span class="n">hhmm_h</span><span class="p">,</span><span class="n">oars</span><span class="p">,</span><span class="n">runn</span><span class="p">,</span><span class="n">YMD_DATE</span><span class="p">,</span><span class="n">HM</span><span class="p">,</span><span class="n">kstamp</span><span class="p">,</span><span class="n">kstamp2</span><span class="p">,</span><span class="n">HM_SFC</span><span class="p">,</span><span class="n">YMD_DATE_SFC</span><span class="w"></span>
<span class="linenos">1938</span>
<span class="linenos">1939</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">iele</span><span class="p">,</span><span class="n">NELE</span><span class="p">,</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="n">NVAL</span><span class="p">,</span><span class="n">NT</span><span class="p">,</span><span class="n">NELE_INFO</span><span class="p">,</span><span class="n">LN</span><span class="w"></span>
<span class="linenos">1940</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">bit_alt</span><span class="p">,</span><span class="n">btyp_offset</span><span class="p">,</span><span class="n">btyp_offset_uni</span><span class="w"></span>
<span class="linenos">1941</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">)</span><span class="w">     </span><span class="kd">::</span><span class="w"> </span><span class="n">BURP_TYP</span><span class="w"></span>
<span class="linenos">1942</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">STNID</span><span class="p">,</span><span class="n">STN_RESUME</span><span class="w"></span>
<span class="linenos">1943</span><span class="w">    </span><span class="kt">LOGICAL</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">HIRES</span><span class="p">,</span><span class="n">HIRES_SFC</span><span class="p">,</span><span class="n">HIPCS</span><span class="p">,</span><span class="n">phasePresent</span><span class="p">,</span><span class="n">LOK</span><span class="p">,</span><span class="n">LROK</span><span class="w"></span>
<span class="linenos">1944</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">NDATA</span><span class="p">,</span><span class="n">NDATA_SF</span><span class="w"></span>
<span class="linenos">1945</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">IER</span><span class="p">,</span><span class="n">date2</span><span class="p">,</span><span class="n">time2</span><span class="p">,</span><span class="n">time_sonde</span><span class="p">,</span><span class="n">NEWDATE</span><span class="w"></span>
<span class="linenos">1946</span><span class="w">    </span><span class="kt">real</span><span class="w">                   </span><span class="kd">::</span><span class="w"> </span><span class="n">RAD_MOY</span><span class="p">,</span><span class="n">RAD_STD</span><span class="w"></span>
<span class="linenos">1947</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">iclass</span><span class="p">,</span><span class="n">NCHANAVHRR</span><span class="p">,</span><span class="n">NCLASSAVHRR</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">iobs</span><span class="p">,</span><span class="n">inorm</span><span class="w"></span>
<span class="linenos">1948</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">infot</span><span class="w"></span>
<span class="linenos">1949</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">ILEMZBCOR</span><span class="p">,</span><span class="w"> </span><span class="n">ILEMTBCOR</span><span class="p">,</span><span class="w"> </span><span class="n">ILEMHBCOR</span><span class="w"></span>
<span class="linenos">1950</span><span class="w">    </span>
<span class="linenos">1951</span><span class="w">    </span>
<span class="linenos">1952</span><span class="w">    </span><span class="n">LISTE_INFO</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">31</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1953</span><span class="w">        </span><span class="mi">1007</span><span class="p">,</span><span class="mi">002019</span><span class="p">,</span><span class="mi">007024</span><span class="p">,</span><span class="mi">007025</span><span class="w"> </span><span class="p">,</span><span class="mi">005021</span><span class="p">,</span><span class="w"> </span><span class="mi">005022</span><span class="p">,</span><span class="w"> </span><span class="mi">008012</span><span class="p">,</span><span class="w"> </span><span class="mi">013039</span><span class="p">,</span><span class="mi">020010</span><span class="p">,</span><span class="mi">2048</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1954</span><span class="w">        </span><span class="mi">2022</span><span class="p">,</span><span class="mi">33060</span><span class="p">,</span><span class="mi">33062</span><span class="p">,</span><span class="mi">33039</span><span class="p">,</span><span class="mi">10035</span><span class="p">,</span><span class="mi">10036</span><span class="p">,</span><span class="mi">08046</span><span class="p">,</span><span class="mi">5043</span><span class="p">,</span><span class="w"> </span><span class="mi">013209</span><span class="p">,</span><span class="n">clwFgElementId</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1955</span><span class="w">        </span><span class="mi">1033</span><span class="p">,</span><span class="mi">2011</span><span class="p">,</span><span class="mi">4197</span><span class="p">,</span><span class="n">siFgElementId</span><span class="p">,</span><span class="mi">13208</span><span class="p">,</span><span class="mi">5040</span><span class="p">,</span><span class="mi">33078</span><span class="p">,</span><span class="mi">33079</span><span class="p">,</span><span class="mi">33080</span><span class="p">,</span><span class="mi">020029</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">1956</span><span class="w">        </span><span class="mi">25174</span><span class="w"> </span><span class="o">/</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1957</span>
<span class="linenos">1958</span><span class="w">    </span><span class="n">RELEV2</span><span class="o">=</span><span class="mf">0.0</span><span class="w"></span>
<span class="linenos">1959</span><span class="w">    </span><span class="n">FAMILYTYPE2</span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SCRAP&#39;</span><span class="w"></span>
<span class="linenos">1960</span><span class="w">    </span><span class="n">vcord_type</span><span class="p">(:)</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1961</span><span class="w">    </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1962</span><span class="w">    </span><span class="n">NELE_INFO</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1963</span><span class="w">    </span><span class="n">NELE_SFC</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1964</span><span class="w">    </span><span class="n">NELE</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1965</span><span class="w">    </span><span class="n">NELEMS</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1966</span><span class="w">    </span><span class="n">NELEMS_SFC</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1967</span><span class="w">    </span><span class="n">NELEMS_GPS</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">1968</span><span class="w">    </span><span class="n">ILEMZBCOR</span><span class="o">=</span><span class="mi">15234</span><span class="w"> </span><span class="c">! bcor element for GP  ZTD observations</span>
<span class="linenos">1969</span><span class="w">    </span><span class="n">ILEMTBCOR</span><span class="o">=</span><span class="mi">12204</span><span class="w"> </span><span class="c">! bcor element for altitude TT observations</span>
<span class="linenos">1970</span><span class="w">    </span><span class="n">ILEMHBCOR</span><span class="o">=</span><span class="mi">12243</span><span class="w"> </span><span class="c">! bcor element for altitude ES observations</span>
<span class="linenos">1971</span><span class="w">    </span><span class="n">ENFORCE_CLASSIC_SONDES</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">1972</span><span class="w">    </span><span class="n">UA_HIGH_PRECISION_TT_ES</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">1973</span><span class="w">    </span><span class="n">UA_FLAG_HIGH_PRECISION_TT_ES</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">1974</span><span class="w">    </span><span class="n">READ_QI_GA_MT_SW</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">1975</span><span class="w">    </span><span class="n">UNI_FAMILYTYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SF&#39;</span><span class="w"></span>
<span class="linenos">1976</span><span class="w">    </span><span class="n">LISTE_ELE_SFC</span><span class="p">(:)</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1977</span><span class="w">    </span><span class="n">LISTE_ELE</span><span class="p">(:)</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">1978</span><span class="w">    </span><span class="k">SELECT CASE</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">))</span><span class="w"></span>
<span class="linenos">1979</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;UA&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1980</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;multi&#39;</span><span class="w"></span>
<span class="linenos">1981</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">7004</span><span class="w"></span>
<span class="linenos">1982</span>
<span class="linenos">1983</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_sfc&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1984</span>
<span class="linenos">1985</span><span class="w">        </span><span class="n">FAMILYTYPE2</span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;UA&#39;</span><span class="w"></span>
<span class="linenos">1986</span><span class="w">        </span><span class="n">ENFORCE_CLASSIC_SONDES</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">1987</span>
<span class="linenos">1988</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1989</span><span class="w">        </span><span class="n">NELE_INFO</span><span class="o">=</span><span class="mi">23</span><span class="w"></span>
<span class="linenos">1990</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;AI&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1991</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;uni&#39;</span><span class="w"></span>
<span class="linenos">1992</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">7004</span><span class="w"></span>
<span class="linenos">1993</span>
<span class="linenos">1994</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1995</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;AL&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">1996</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;uni&#39;</span><span class="w"></span>
<span class="linenos">1997</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">7071</span><span class="w"></span>
<span class="linenos">1998</span>
<span class="linenos">1999</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2000</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;SW&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2001</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;uni&#39;</span><span class="w"></span>
<span class="linenos">2002</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">7004</span><span class="w"></span>
<span class="linenos">2003</span>
<span class="linenos">2004</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2005</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;SF&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2006</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;uni&#39;</span><span class="w"></span>
<span class="linenos">2007</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2008</span>
<span class="linenos">2009</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_sfc&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2010</span>
<span class="linenos">2011</span><span class="w">        </span><span class="n">FAMILYTYPE2</span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SFC&#39;</span><span class="w"></span>
<span class="linenos">2012</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;GP&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2013</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;uni&#39;</span><span class="w"></span>
<span class="linenos">2014</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2015</span>
<span class="linenos">2016</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_gp&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2017</span>
<span class="linenos">2018</span><span class="w">        </span><span class="n">FAMILYTYPE2</span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;SFC&#39;</span><span class="w"></span>
<span class="linenos">2019</span><span class="w">        </span><span class="n">UNI_FAMILYTYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;GP&#39;</span><span class="w"></span>
<span class="linenos">2020</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;SC&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2021</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2022</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;uni&#39;</span><span class="w"></span>
<span class="linenos">2023</span>
<span class="linenos">2024</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_sfc&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2025</span><span class="w">        </span><span class="c">! The following 2 lines are necessary because when this routine reads scatterometer</span>
<span class="linenos">2026</span><span class="w">        </span><span class="c">! burp files they are considered (possibly incorrectly) as non-surface observations</span>
<span class="linenos">2027</span><span class="w">        </span><span class="c">! but during update they are considered as surface observations</span>
<span class="linenos">2028</span><span class="w">        </span><span class="n">NELEMS</span><span class="o">=</span><span class="n">NELEMS_SFC</span><span class="w"></span>
<span class="linenos">2029</span><span class="w">        </span><span class="n">BLISTELEMENTS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELEMS</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BLISTELEMENTS_SFC</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELEMS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2030</span><span class="w">        </span><span class="n">NELEMS_SFC</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2031</span>
<span class="linenos">2032</span><span class="w">        </span><span class="n">FAMILYTYPE2</span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;UASFC2&#39;</span><span class="w"></span>
<span class="linenos">2033</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;PR&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2034</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;multi&#39;</span><span class="w"></span>
<span class="linenos">2035</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">7006</span><span class="w"></span>
<span class="linenos">2036</span>
<span class="linenos">2037</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2038</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;RO&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2039</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;multi&#39;</span><span class="w"></span>
<span class="linenos">2040</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">7007</span><span class="w"></span>
<span class="linenos">2041</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">7040</span><span class="w"></span>
<span class="linenos">2042</span>
<span class="linenos">2043</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2044</span><span class="w">        </span><span class="n">NELE_INFO</span><span class="o">=</span><span class="mi">18</span><span class="w"></span>
<span class="linenos">2045</span><span class="w">      </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;TO&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2046</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;multi&#39;</span><span class="w"></span>
<span class="linenos">2047</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">5042</span><span class="w"></span>
<span class="linenos">2048</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">2150</span><span class="w"></span>
<span class="linenos">2049</span>
<span class="linenos">2050</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_tovs&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2051</span>
<span class="linenos">2052</span><span class="w">        </span><span class="n">NELE_INFO</span><span class="o">=</span><span class="mi">31</span><span class="w"></span>
<span class="linenos">2053</span><span class="w">     </span><span class="k">CASE</span><span class="p">(</span><span class="s1">&#39;CH&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2054</span>
<span class="linenos">2055</span><span class="w">        </span><span class="n">BURP_TYP</span><span class="o">=</span><span class="s1">&#39;multi&#39;</span><span class="w">  </span><span class="c">! Both &#39;multi&#39; and &#39;uni&#39; are possible for this family.</span>
<span class="linenos">2056</span><span class="w">                          </span><span class="c">! &#39;uni&#39; level data are assumed not to have any accompanynig vertical </span>
<span class="linenos">2057</span><span class="w">                          </span><span class="c">! coordinate element in addition to having only one level.</span>
<span class="linenos">2058</span><span class="w">        </span><span class="n">vcord_type</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="mi">7004</span><span class="p">,</span><span class="mi">7204</span><span class="p">,</span><span class="mi">7006</span><span class="p">,</span><span class="mi">7007</span><span class="p">,</span><span class="mi">5042</span><span class="p">,</span><span class="mi">2150</span><span class="p">,</span><span class="mi">2071</span><span class="p">,</span><span class="mi">0</span><span class="o">/</span><span class="p">)</span><span class="w"> </span><span class="c">! 0 must be at end.</span>
<span class="linenos">2059</span><span class="w">        </span><span class="n">NELE_INFO</span><span class="o">=</span><span class="mi">18</span><span class="w"></span>
<span class="linenos">2060</span>
<span class="linenos">2061</span><span class="w">        </span><span class="n">UNI_FAMILYTYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;CH&#39;</span><span class="w"></span>
<span class="linenos">2062</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_chm_sfc&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2063</span>
<span class="linenos">2064</span><span class="w">        </span><span class="n">FAMILYTYPE2</span><span class="o">=</span><span class="s1">&#39;CH&#39;</span><span class="w"></span>
<span class="linenos">2065</span><span class="w">        </span><span class="k">call </span><span class="n">BRPACMA_NML</span><span class="p">(</span><span class="s1">&#39;namburp_filter_chm&#39;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">2066</span><span class="w">      </span><span class="k">CASE </span><span class="n">default</span><span class="w"></span>
<span class="linenos">2067</span><span class="w">        </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_readBurp: unknown familyType : &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2068</span><span class="w">    </span><span class="k">END SELECT</span>
<span class="linenos">2069</span>
<span class="linenos">2070</span><span class="k">    </span><span class="n">NELE</span><span class="o">=</span><span class="n">NELEMS</span><span class="w"></span>
<span class="linenos">2071</span><span class="w">    </span><span class="n">LISTE_ELE</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">)</span><span class="o">=</span><span class="n">BLISTELEMENTS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2072</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;GP&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">2073</span><span class="w">      </span><span class="c">! for GP ignore BLISTELEMENTS_SFC, and use instead LISTE_ELE_GPS</span>
<span class="linenos">2074</span><span class="w">      </span><span class="n">NELE_SFC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NELEMS_GPS</span><span class="w"></span>
<span class="linenos">2075</span><span class="w">      </span><span class="n">LISTE_ELE_SFC</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">)</span><span class="o">=</span><span class="n">LISTE_ELE_GPS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2076</span><span class="w">    </span><span class="k">else</span>
<span class="linenos">2077</span><span class="k">      </span><span class="n">NELE_SFC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NELEMS_SFC</span><span class="w"></span>
<span class="linenos">2078</span><span class="w">      </span><span class="n">LISTE_ELE_SFC</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">)</span><span class="o">=</span><span class="n">BLISTELEMENTS_SFC</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2079</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">2080</span>
<span class="linenos">2081</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">NELE</span><span class="w">     </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2082</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="s1">&#39; LISTE_ELE =&#39;</span><span class="p">,</span><span class="n">LISTE_ELE</span><span class="w"></span>
<span class="linenos">2083</span><span class="w">      </span><span class="k">call </span><span class="n">ovt_setup</span><span class="p">(</span><span class="n">LISTE_ELE</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2084</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">2085</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">NELE_SFC</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2086</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="s1">&#39; LISTE_ELE_SFC =&#39;</span><span class="p">,</span><span class="n">LISTE_ELE_SFC</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2087</span><span class="w">      </span><span class="k">call </span><span class="n">ovt_setup</span><span class="p">(</span><span class="n">LISTE_ELE_SFC</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2088</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">2089</span>
<span class="linenos">2090</span><span class="k">    </span><span class="n">btyp_offset_uni</span><span class="o">=-</span><span class="mi">999</span><span class="w"></span>
<span class="linenos">2091</span><span class="w">    </span><span class="n">btyp_offset</span><span class="o">=-</span><span class="mi">999</span><span class="w"></span>
<span class="linenos">2092</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">BURP_TYP</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;uni&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2093</span><span class="k">      </span><span class="n">btyp_offset</span><span class="o">=</span><span class="mi">256</span><span class="w"></span>
<span class="linenos">2094</span><span class="w">    </span><span class="k">else</span>
<span class="linenos">2095</span><span class="k">      </span><span class="n">btyp_offset</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2096</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">2097</span>
<span class="linenos">2098</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familytype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;AL&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2099</span><span class="k">      </span><span class="n">btyp_offset</span><span class="o">=</span><span class="mi">255</span><span class="w"></span>
<span class="linenos">2100</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">2101</span>
<span class="linenos">2102</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FAMILYTYPE2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;SFC&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2103</span><span class="k">      </span><span class="n">btyp_offset</span><span class="o">=</span><span class="w"> </span><span class="n">btyp_offset</span><span class="o">+</span><span class="mi">32</span><span class="w"></span>
<span class="linenos">2104</span><span class="w">      </span><span class="n">btyp_offset_uni</span><span class="o">=</span><span class="w"> </span><span class="mi">256</span><span class="w"> </span><span class="o">+</span><span class="mi">32</span><span class="w"></span>
<span class="linenos">2105</span><span class="w">    </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FAMILYTYPE2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;UA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2106</span><span class="k">      </span><span class="n">btyp_offset_uni</span><span class="o">=</span><span class="w"> </span><span class="mi">256</span><span class="w"> </span><span class="o">+</span><span class="mi">32</span><span class="w"></span>
<span class="linenos">2107</span><span class="w">    </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FAMILYTYPE2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;CH&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2108</span><span class="k">      </span><span class="n">btyp_offset_uni</span><span class="o">=</span><span class="w"> </span><span class="mi">256</span><span class="w"></span>
<span class="linenos">2109</span><span class="w">    </span><span class="k">else</span>
<span class="linenos">2110</span><span class="k">      </span><span class="n">btyp_offset_uni</span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">999</span><span class="w"> </span><span class="c">! set to -999 when not used</span>
<span class="linenos">2111</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">2112</span>
<span class="linenos">2113</span><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;-----------------------------------------------&#39;</span><span class="w"></span>
<span class="linenos">2114</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;-----------  BEGIN brpr_readBurp   ------------&#39;</span><span class="w"></span>
<span class="linenos">2115</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;FAMILYTYPE vcord_type   =&#39;</span><span class="p">,</span><span class="n">FAMILYTYPE</span><span class="p">,</span><span class="n">vcord_type</span><span class="w"></span>
<span class="linenos">2116</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;BURP_TYP btyp_offset    =&#39;</span><span class="p">,</span><span class="n">BURP_TYP</span><span class="p">,</span><span class="w"> </span><span class="n">btyp_offset</span><span class="w"></span>
<span class="linenos">2117</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;-----------------------------------------------&#39;</span><span class="w"></span>
<span class="linenos">2118</span>
<span class="linenos">2119</span>
<span class="linenos">2120</span><span class="w">    </span><span class="c">! initialisation</span>
<span class="linenos">2121</span><span class="w">    </span><span class="c">! --------------</span>
<span class="linenos">2122</span><span class="w">    </span><span class="nb">SUM</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2123</span><span class="w">    </span><span class="n">flag_passage1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2124</span><span class="w">    </span><span class="n">flag_passage2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2125</span><span class="w">    </span><span class="n">flag_passage3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2126</span><span class="w">    </span><span class="n">flag_passage4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2127</span><span class="w">    </span><span class="c">! initialiase the qc flag2 indice</span>
<span class="linenos">2128</span>
<span class="linenos">2129</span><span class="w">    </span><span class="n">opt_missing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MISSING&#39;</span><span class="w"></span>
<span class="linenos">2130</span>
<span class="linenos">2131</span>
<span class="linenos">2132</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Set_Options</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2133</span><span class="w">       </span><span class="p">&amp;</span><span class="w"> </span><span class="n">REAL_OPTNAME</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">opt_missing</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2134</span><span class="w">       </span><span class="p">&amp;</span><span class="w"> </span><span class="n">REAL_OPTNAME_VALUE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2135</span><span class="w">       </span><span class="p">&amp;</span><span class="w"> </span><span class="n">CHAR_OPTNAME</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MSGLVL&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2136</span><span class="w">       </span><span class="p">&amp;</span><span class="w"> </span><span class="n">CHAR_OPTNAME_VALUE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FATAL&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2137</span><span class="w">       </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2138</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Set_Options&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2139</span>
<span class="linenos">2140</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">File_in</span><span class="w">      </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2141</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_init File_in&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2142</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">Rpt_in</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2143</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">Block_in</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2144</span>
<span class="linenos">2145</span><span class="w">    </span><span class="c">! opening file</span>
<span class="linenos">2146</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;OPENING BURP FILE FOR READING = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">brp_file</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2147</span>
<span class="linenos">2148</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="w"> </span><span class="n">FILENAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">brp_file</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2149</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"> </span><span class="n">MODE</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">FILE_ACC_READ</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2150</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2151</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: Burp_New. Problem opening &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">brp_file</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2152</span>
<span class="linenos">2153</span>
<span class="linenos">2154</span><span class="w">    </span><span class="c">! obtain input burp file number of reports</span>
<span class="linenos">2155</span>
<span class="linenos">2156</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="w"> </span><span class="n">NRPTS</span><span class="o">=</span><span class="n">nb_rpts</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2157</span>
<span class="linenos">2158</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;-----------------------------------------&#39;</span><span class="w"></span>
<span class="linenos">2159</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;IOSTAT    =&#39;</span><span class="p">,</span><span class="n">error</span><span class="w"></span>
<span class="linenos">2160</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;NUMBER OF REPORTS IN FILE  = &#39;</span><span class="p">,</span><span class="n">nb_rpts</span><span class="w"></span>
<span class="linenos">2161</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;-----------------------------------------&#39;</span><span class="w"></span>
<span class="linenos">2162</span>
<span class="linenos">2163</span>
<span class="linenos">2164</span><span class="w">    </span><span class="c">! scan input burp file to get all reports address</span>
<span class="linenos">2165</span>
<span class="linenos">2166</span><span class="w">    </span><span class="k">Allocate</span><span class="p">(</span><span class="n">address</span><span class="p">(</span><span class="n">nb_rpts</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2167</span><span class="w">    </span><span class="n">address</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2168</span><span class="w">    </span><span class="nb">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2169</span><span class="w">    </span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2170</span><span class="w">    </span><span class="n">bit_alt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2171</span><span class="w">    </span><span class="n">stn_resume</span><span class="o">=</span><span class="s1">&#39;NOT_FOUND&#39;</span><span class="w"></span>
<span class="linenos">2172</span>
<span class="linenos">2173</span><span class="w">    </span><span class="k">do</span>
<span class="linenos">2174</span><span class="k">      </span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Report</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2175</span><span class="w">                    </span><span class="p">&amp;</span><span class="w"> </span><span class="n">REPORT</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">Rpt_in</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2176</span><span class="w">                    </span><span class="p">&amp;</span><span class="w"> </span><span class="n">SEARCH_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_rpt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2177</span><span class="w">                    </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2178</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Find_Report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2179</span><span class="w">      </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="n">STNID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stnid</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2180</span><span class="w">      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">stnid</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2181</span><span class="k">        </span><span class="n">STN_RESUME</span><span class="o">=</span><span class="n">stnid</span><span class="w"></span>
<span class="linenos">2182</span><span class="w">        </span><span class="n">TYPE_RESUME</span><span class="o">=</span><span class="n">STN_RESUME</span><span class="p">(</span><span class="mi">3</span><span class="p">:</span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2183</span><span class="w">        </span><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">stnid</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2184</span><span class="w">          </span><span class="k">CASE</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;BGCKALT&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&gt;&gt;POSTALT&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2185</span><span class="w">            </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2186</span><span class="w">          </span><span class="k">CASE</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;DERIALT&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2187</span><span class="w">            </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">2</span><span class="w"></span>
<span class="linenos">2188</span><span class="w">          </span><span class="k">CASE </span><span class="n">DEFAULT</span><span class="w"></span>
<span class="linenos">2189</span><span class="w">            </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_readBurp: WARNING: Unknown RESUME record found, assume BGCKALT&#39;</span><span class="w"></span>
<span class="linenos">2190</span><span class="w">            </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2191</span><span class="w">        </span><span class="k">END SELECT </span>
<span class="linenos">2192</span><span class="k">      END IF</span>
<span class="linenos">2193</span>
<span class="linenos">2194</span><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">Exit</span>
<span class="linenos">2195</span>
<span class="linenos">2196</span><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="nb">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">nb_rpts</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2197</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_readBurp: ERROR: count = nb_rpts:&#39;</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">nb_rpts</span><span class="w"></span>
<span class="linenos">2198</span><span class="w">        </span><span class="k">exit</span>
<span class="linenos">2199</span><span class="k">      end if</span>
<span class="linenos">2200</span>
<span class="linenos">2201</span><span class="k">      </span><span class="nb">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2202</span><span class="w">      </span><span class="n">address</span><span class="p">(</span><span class="nb">count</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_rpt</span><span class="w"></span>
<span class="linenos">2203</span><span class="w">    </span><span class="k">end do</span>
<span class="linenos">2204</span>
<span class="linenos">2205</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="n">stn_resume</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;NOT_FOUND&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2206</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_readBurp: WARNING: No RESUME record found in this file, &#39;</span><span class="w"> </span><span class="o">//</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2207</span><span class="w">                 </span><span class="s1">&#39;check if already read in another file&#39;</span><span class="w"></span>
<span class="linenos">2208</span><span class="w">      </span><span class="c">! try to get value from previously read file</span>
<span class="linenos">2209</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">type_resume</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="s1">&#39;UNKNOWN&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2210</span><span class="k">        </span><span class="n">stn_resume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">type_resume</span><span class="w"></span>
<span class="linenos">2211</span><span class="w">        </span><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">stn_resume</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2212</span><span class="w">          </span><span class="k">CASE</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;BGCKALT&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;&gt;&gt;POSTALT&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2213</span><span class="w">            </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2214</span><span class="w">          </span><span class="k">CASE</span><span class="p">(</span><span class="s2">&quot;&gt;&gt;DERIALT&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2215</span><span class="w">            </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">2</span><span class="w"></span>
<span class="linenos">2216</span><span class="w">          </span><span class="k">CASE </span><span class="n">DEFAULT</span><span class="w"></span>
<span class="linenos">2217</span><span class="w">            </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_readBurp: WARNING: Unknown RESUME record found, assume BGCKALT&#39;</span><span class="w"></span>
<span class="linenos">2218</span><span class="w">            </span><span class="n">stn_resume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&gt;&gt;BGCKALT&#39;</span><span class="w"></span>
<span class="linenos">2219</span><span class="w">            </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2220</span><span class="w">        </span><span class="k">END SELECT </span>
<span class="linenos">2221</span><span class="k">      else</span>
<span class="linenos">2222</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_readBurp: WARNING: No file read has RESUME record, assume BGCKALT&#39;</span><span class="w"></span>
<span class="linenos">2223</span><span class="w">        </span><span class="n">stn_resume</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&gt;&gt;BGCKALT&#39;</span><span class="w"></span>
<span class="linenos">2224</span><span class="w">        </span><span class="n">bit_alt</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2225</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">2226</span><span class="k">    end if</span>
<span class="linenos">2227</span>
<span class="linenos">2228</span><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">STN_RESUME</span><span class="p">,</span><span class="s1">&#39; bit_alt==== &gt;  &#39;</span><span class="p">,</span><span class="n">bit_alt</span><span class="w"></span>
<span class="linenos">2229</span>
<span class="linenos">2230</span>
<span class="linenos">2231</span><span class="w">    </span><span class="n">BTYP10obs</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mi">291</span><span class="w"> </span><span class="o">-</span><span class="n">btyp_offset</span><span class="w"></span>
<span class="linenos">2232</span><span class="w">    </span><span class="n">BTYP10obs_uni</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">291</span><span class="w"> </span><span class="o">-</span><span class="n">btyp_offset_uni</span><span class="w"></span>
<span class="linenos">2233</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bit_alt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">btyp10obs</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BTYP10obs</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="linenos">2234</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bit_alt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">btyp10obs_uni</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BTYP10obs_uni</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="linenos">2235</span>
<span class="linenos">2236</span><span class="w">    </span><span class="n">BTYP10flg</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mi">483</span><span class="w"> </span><span class="o">-</span><span class="n">btyp_offset</span><span class="w"></span>
<span class="linenos">2237</span><span class="w">    </span><span class="n">BTYP10flg_uni</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">483</span><span class="w"> </span><span class="o">-</span><span class="n">btyp_offset_uni</span><span class="w"></span>
<span class="linenos">2238</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bit_alt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">BTYP10flg</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BTYP10flg</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="linenos">2239</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">bit_alt</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="n">BTYP10flg_uni</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BTYP10flg_uni</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="linenos">2240</span>
<span class="linenos">2241</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="s1">&#39; NUMBER OF VALID REPORTS IN FILE = &#39;</span><span class="p">,</span><span class="nb">count</span>
<span class="linenos">2242</span><span class="nb">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="p">)</span><span class="w">  </span><span class="s1">&#39; BTYP10obs BTYP10obs_uni         = &#39;</span><span class="p">,</span><span class="n">BTYP10obs</span><span class="p">,</span><span class="n">BTYP10obs_uni</span><span class="w"></span>
<span class="linenos">2243</span>
<span class="linenos">2244</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">2245</span><span class="w">      </span><span class="c">! LOOP ON REPORTS</span>
<span class="linenos">2246</span><span class="w">      </span><span class="n">REPORTS</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">kk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span>
<span class="linenos">2247</span><span class="nb">            </span>
<span class="linenos">2248</span><span class="nb">        </span><span class="k">call </span><span class="n">BURP_Get_Report</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2249</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"> </span><span class="n">REPORT</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2250</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"> </span><span class="n">REF</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">(</span><span class="n">kk</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2251</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2252</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Report&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">2253</span><span class="w">        </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2254</span><span class="w">               </span><span class="n">STNID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stnid</span><span class="w"> </span><span class="p">,</span><span class="n">TEMPS</span><span class="w"> </span><span class="o">=</span><span class="n">hhmm_h</span><span class="p">,</span><span class="n">FLGS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="p">,</span><span class="n">IDTYP</span><span class="w"> </span><span class="o">=</span><span class="n">idtyp</span><span class="p">,</span><span class="n">LATI</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lati</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2255</span><span class="w">               </span><span class="p">,</span><span class="nb">LONG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">long</span><span class="w"> </span><span class="p">,</span><span class="n">DX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dx</span><span class="w"> </span><span class="p">,</span><span class="n">DY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dy</span><span class="p">,</span><span class="n">ELEV</span><span class="o">=</span><span class="n">elev</span><span class="p">,</span><span class="n">DRND</span><span class="w"> </span><span class="o">=</span><span class="n">drnd</span><span class="p">,</span><span class="n">DATE</span><span class="w"> </span><span class="o">=</span><span class="n">date_h</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2256</span><span class="w">               </span><span class="p">,</span><span class="n">OARS</span><span class="w"> </span><span class="o">=</span><span class="n">oars</span><span class="p">,</span><span class="n">RUNN</span><span class="o">=</span><span class="n">runn</span><span class="w"> </span><span class="p">,</span><span class="n">IOSTAT</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2257</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: burp_get_property&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2258</span><span class="w">        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">stnid</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span><span class="w"></span>
<span class="linenos">2259</span><span class="w">        </span><span class="c">!  LOOP ON BLOCKS</span>
<span class="linenos">2260</span>
<span class="linenos">2261</span><span class="w">        </span><span class="c">! Ensure the dataQcFlag arrays are not allocated before looping over blocks</span>
<span class="linenos">2262</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataQcFlag2</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">dataQcFlag2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2263</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataQcFlagLEV</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">dataQcFlagLEV</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2264</span><span class="w">        </span>
<span class="linenos">2265</span><span class="w">        </span><span class="c">! Ensure the dataCloudFrac arrays are not allocated before looping over blocks</span>
<span class="linenos">2266</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataCloudFrac</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">dataCloudFrac</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2267</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataCloudFracLEV</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">dataCloudFracLEV</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2268</span><span class="w">        </span>
<span class="linenos">2269</span><span class="w">        </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2270</span>
<span class="linenos">2271</span><span class="w">        </span><span class="n">HIRES</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="linenos">2272</span><span class="w">        </span><span class="n">HIPCS</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="linenos">2273</span><span class="w">        </span><span class="n">HIRES_SFC</span><span class="o">=</span><span class="p">.</span><span class="n">FALSE</span><span class="p">.</span><span class="w"></span>
<span class="linenos">2274</span><span class="w">        </span><span class="n">phasePresent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">2275</span><span class="w">        </span><span class="n">LROK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">2276</span>
<span class="linenos">2277</span><span class="w">        </span><span class="n">BLOCKS1</span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="linenos">2278</span>
<span class="linenos">2279</span><span class="k">          </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Block</span><span class="p">(</span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2280</span><span class="w">                    </span><span class="p">&amp;</span><span class="w"> </span><span class="k">BLOCK</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2281</span><span class="w">                    </span><span class="p">&amp;</span><span class="w"> </span><span class="n">SEARCH_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_blk</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2282</span><span class="w">                    </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2283</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Find_Block&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2284</span>
<span class="linenos">2285</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_blk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">EXIT </span><span class="n">BLOCKS1</span><span class="w"></span>
<span class="linenos">2286</span>
<span class="linenos">2287</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2288</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NELE</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2289</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NVAL</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nvale</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2290</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NT</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">nte</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2291</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BFAM</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">bfam</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2292</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BTYP</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2293</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BKSTP</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BKSTP</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2294</span><span class="w">                      </span><span class="p">&amp;</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2295</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Property&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2296</span>
<span class="linenos">2297</span><span class="w">          </span><span class="c">! Read slant latlon if type is RO</span>
<span class="linenos">2298</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familytype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;RO&#39;</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">LROK</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">.</span><span class="n">FALSE</span><span class="p">.)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2299</span><span class="k">            </span><span class="n">ROLAT0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="o">*</span><span class="n">lati</span><span class="o">-</span><span class="w"> </span><span class="mi">9</span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">2300</span><span class="w">            </span><span class="n">ROLON0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.01</span><span class="o">*</span><span class="nb">long</span>
<span class="linenos">2301</span><span class="nb">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ROLON0</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">18</span><span class="mf">0.</span><span class="p">)</span><span class="w"> </span><span class="n">ROLON0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ROLON0</span><span class="o">-</span><span class="mi">36</span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">2302</span><span class="w">            </span><span class="n">ROLAT</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ROLAT0</span><span class="w"></span>
<span class="linenos">2303</span><span class="w">            </span><span class="n">ROLON</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ROLON0</span><span class="w"></span>
<span class="linenos">2304</span><span class="w">            </span><span class="n">IND5001</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5001</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2305</span><span class="w">            </span><span class="n">IND6001</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6001</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2306</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND5001</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND6001</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2307</span><span class="k">              do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">2308</span><span class="w">                </span><span class="n">ROLAT1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2309</span><span class="w">                                       </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND5001</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2310</span><span class="w">                                       </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2311</span><span class="w">                                       </span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2312</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Rval Block_in 5001&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2313</span><span class="w">                </span><span class="n">ROLON1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2314</span><span class="w">                                       </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND6001</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2315</span><span class="w">                                       </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2316</span><span class="w">                                       </span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2317</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Rval Block_in 6001&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2318</span><span class="w">                </span><span class="n">lok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="o">-</span><span class="mi">9</span><span class="mf">0.1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ROLAT1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">ROLAT1</span><span class="w"> </span><span class="o">&lt;</span><span class="w">  </span><span class="mi">9</span><span class="mf">0.1</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2319</span><span class="w">                      </span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="mf">0.1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ROLON1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">ROLON1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">36</span><span class="mf">0.1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2320</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">lok</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">j</span><span class="o">&lt;=</span><span class="n">MAXRONVAL</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2321</span><span class="k">                  </span><span class="n">ROLAT</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ROLAT1</span><span class="w"></span>
<span class="linenos">2322</span><span class="w">                  </span><span class="n">ROLON</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ROLON1</span><span class="w"></span>
<span class="linenos">2323</span><span class="w">                  </span><span class="n">LROK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">TRUE</span><span class="p">.</span><span class="w"></span>
<span class="linenos">2324</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">2325</span><span class="k">              end do</span>
<span class="linenos">2326</span><span class="k">            end if</span>
<span class="linenos">2327</span><span class="k">          end if</span><span class="w"></span>
<span class="linenos">2328</span>
<span class="linenos">2329</span><span class="w">          </span><span class="c">! observation block (btyp = 0100 100011X XXXX)</span>
<span class="linenos">2330</span><span class="w">          </span><span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familytype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;AL&#39;</span><span class="p">)</span><span class="k">then</span><span class="w"></span>
<span class="linenos">2331</span>
<span class="linenos">2332</span><span class="w">            </span><span class="c">! Fudge the block type, because the data are simulated</span>
<span class="linenos">2333</span><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">btyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1024</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2334</span><span class="k">              </span><span class="n">btyp</span><span class="o">=</span><span class="mi">1152</span><span class="w"></span>
<span class="linenos">2335</span><span class="w">            </span><span class="k">else if</span><span class="p">(</span><span class="n">btyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7168</span><span class="p">)</span><span class="k">then</span>
<span class="linenos">2336</span><span class="k">              </span><span class="n">btyp</span><span class="o">=</span><span class="mi">7296</span><span class="w"></span>
<span class="linenos">2337</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">2338</span><span class="k">          end if</span>
<span class="linenos">2339</span><span class="k">          </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2340</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs_uni</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bkstp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">   </span><span class="c">! FAMILYTYPE = SF, GP data blocks</span>
<span class="linenos">2341</span>
<span class="linenos">2342</span><span class="w">            </span><span class="n">flag_passage3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2343</span>
<span class="linenos">2344</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">obsvalue_sfc</span><span class="p">(</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2345</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">BiasCorrection_sfc</span><span class="p">(</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2346</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">OBSERV_SFC</span><span class="p">(</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2347</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">BCOR_SFC</span><span class="p">(</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2348</span>
<span class="linenos">2349</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">vcoord_sfc</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2350</span>
<span class="linenos">2351</span><span class="w">            </span><span class="n">vcoord_type</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2352</span><span class="w">            </span><span class="n">vcoord_SFC</span><span class="p">(:)</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2353</span><span class="w">            </span><span class="n">obsvalue_sfc</span><span class="p">(:,:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2354</span><span class="w">            </span><span class="n">BiasCorrection_sfc</span><span class="p">(:,:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2355</span><span class="w">            </span><span class="n">IND_LAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">5001</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2356</span><span class="w">            </span><span class="n">IND_LON</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">6001</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2357</span><span class="w">            </span><span class="n">IND_TIME</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">4015</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2358</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_LAT</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_LON</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_TIME</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">HIRES_SFC</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">2359</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">HIRES_SFC</span><span class="p">)</span><span class="w"> </span><span class="k">allocate</span><span class="p">(</span><span class="n">HLAT_SFC</span><span class="p">(</span><span class="n">nte</span><span class="p">),</span><span class="n">HLON_SFC</span><span class="p">(</span><span class="n">nte</span><span class="p">),</span><span class="n">HTIME_SFC</span><span class="p">(</span><span class="n">nte</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2360</span><span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">HIRES_SFC</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">2361</span><span class="k">              do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2362</span><span class="w">                </span><span class="n">HLAT_SFC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2363</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_LAT</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2364</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2365</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2366</span><span class="w">                </span><span class="n">HLON_SFC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2367</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_LON</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2368</span><span class="w">        </span>
<span class="linenos">2369</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2370</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2371</span><span class="w">                </span><span class="n">HTIME_SFC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2372</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_TIME</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2373</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2374</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2375</span><span class="w">              </span><span class="k">end do</span>
<span class="linenos">2376</span><span class="k">            END IF</span>
<span class="linenos">2377</span>
<span class="linenos">2378</span><span class="k">            do </span><span class="n">IL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_SFC</span><span class="w"></span>
<span class="linenos">2379</span>
<span class="linenos">2380</span><span class="w">              </span><span class="n">iele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LISTE_ELE_SFC</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2381</span><span class="w">              </span><span class="n">IND_ele</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2382</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">2383</span>
<span class="linenos">2384</span><span class="k">              do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2385</span><span class="w">                </span><span class="n">obsvalue_sfc</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2386</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_ele</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2387</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2388</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2389</span><span class="w">              </span><span class="k">end do</span>
<span class="linenos">2390</span><span class="k">              </span>
<span class="linenos">2391</span><span class="k">              </span><span class="n">IND_ele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2392</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">BUFR_NEZD</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2393</span><span class="k">                </span><span class="n">IND_ele</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">ILEMZBCOR</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2394</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">2395</span><span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2396</span><span class="k">                do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2397</span><span class="w">                  </span><span class="n">BiasCorrection_sfc</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2398</span><span class="w">                                                </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_ele</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2399</span><span class="w">                                                </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2400</span><span class="w">                                                </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2401</span><span class="w">                </span><span class="k">end do</span>
<span class="linenos">2402</span><span class="k">              end if</span>
<span class="linenos">2403</span>
<span class="linenos">2404</span><span class="k">            end do</span>
<span class="linenos">2405</span><span class="k">            </span>
<span class="linenos">2406</span><span class="k">          end if</span>
<span class="linenos">2407</span>
<span class="linenos">2408</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10flg_uni</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bkstp</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! FAMILYTYPE = SF, GP flag blocks</span>
<span class="linenos">2409</span>
<span class="linenos">2410</span><span class="w">            </span><span class="n">flag_passage4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2411</span>
<span class="linenos">2412</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">qcflag_sfc</span><span class="w"> </span><span class="p">(</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2413</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">qcflags_SFC</span><span class="p">(</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2414</span><span class="w">            </span><span class="n">QCFLAGS_SFC</span><span class="p">(:,:)</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2415</span>
<span class="linenos">2416</span><span class="w">            </span><span class="k">do </span><span class="n">IL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_SFC</span><span class="w"></span>
<span class="linenos">2417</span><span class="w">              </span><span class="n">iele</span><span class="o">=</span><span class="n">LISTE_ELE_SFC</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">200000</span><span class="w"></span>
<span class="linenos">2418</span><span class="w">              </span><span class="n">IND_QCFLAG</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2419</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_QCFLAG</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">2420</span><span class="k">              DO </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2421</span><span class="w">                </span><span class="n">QCFLAG_sfc</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2422</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_QCFLAG</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2423</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2424</span><span class="w">                                         </span><span class="p">&amp;</span><span class="w"> </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2425</span><span class="w">                </span><span class="nb">SUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">SUM</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w">                </span>
<span class="linenos">2426</span><span class="w">              </span><span class="k">END DO</span>
<span class="linenos">2427</span><span class="k">            end do</span>
<span class="linenos">2428</span><span class="k">          end if</span>
<span class="linenos">2429</span>
<span class="linenos">2430</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="c">! non sfc-type DATA block</span>
<span class="linenos">2431</span>
<span class="linenos">2432</span><span class="w">            </span><span class="n">flag_passage3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2433</span>
<span class="linenos">2434</span><span class="w">            </span><span class="n">NVAL</span><span class="o">=</span><span class="n">NVALE</span><span class="w"> </span><span class="p">;</span><span class="w">  </span><span class="n">NT</span><span class="o">=</span><span class="n">NTE</span><span class="w"></span>
<span class="linenos">2435</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">obsvalue</span><span class="p">(</span><span class="n">NELE</span><span class="p">,</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">),</span><span class="n">VCOORD</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2436</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">OBSERV</span><span class="p">(</span><span class="n">NELE</span><span class="p">,</span><span class="n">nvale</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2437</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">VCORD</span><span class="p">(</span><span class="n">nvale</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2438</span><span class="w">                           </span>
<span class="linenos">2439</span><span class="w">            </span><span class="n">obsvalue</span><span class="p">(:,:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2440</span><span class="w">            </span><span class="n">OBSERV</span><span class="w">  </span><span class="p">(:,:)</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2441</span><span class="w">            </span><span class="n">VCOORD</span><span class="w">  </span><span class="p">(:,:)</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">2442</span><span class="w">            </span><span class="n">VCORD</span><span class="w">   </span><span class="p">(:)</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">2443</span>
<span class="linenos">2444</span><span class="w">            </span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2445</span><span class="w">            </span><span class="n">IND_VCOORD</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2446</span><span class="w">            </span><span class="k">do while</span><span class="w"> </span><span class="p">(</span><span class="n">vcord_type</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_VCOORD</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2447</span><span class="w">               </span><span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="w"> </span>
<span class="linenos">2448</span><span class="w">               </span><span class="n">IND_VCOORD</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">vcord_type</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2449</span><span class="w">            </span><span class="k">end do</span>
<span class="linenos">2450</span><span class="k">            </span><span class="n">vcoord_type</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2451</span><span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">IND_VCOORD</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">vcoord_type</span><span class="o">=</span><span class="n">vcord_type</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2452</span><span class="w">            </span><span class="c">!if (IND_VCOORD == -1)write(*,*) &#39;PAS DE COORDONNEE VERTICALE STNID=&#39;,STNID,trim(FAMILYTYPE)</span>
<span class="linenos">2453</span>
<span class="linenos">2454</span><span class="w">            </span><span class="c">! LAT LON TIME IN DATA BLOCK</span>
<span class="linenos">2455</span><span class="w">            </span><span class="n">IND_LAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">5001</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2456</span><span class="w">            </span><span class="n">IND_LON</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">6001</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2457</span><span class="w">            </span><span class="n">IND_TIME</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">4015</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2458</span><span class="w">            </span><span class="n">IND_EMIS</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">55043</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2459</span>
<span class="linenos">2460</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_LAT</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_LON</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_TIME</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">HIRES</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">2461</span>
<span class="linenos">2462</span><span class="w">            </span><span class="n">IND_BCOR</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2463</span><span class="w">            </span><span class="n">IND_BCOR_TT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2464</span><span class="w">            </span><span class="n">IND_BCOR_HU</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2465</span><span class="w">            </span><span class="n">IND_PHASE</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2466</span><span class="w">            </span><span class="n">phasePresent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">2467</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">FAMILYTYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;TO&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">IND_BCOR</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">12233</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2468</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">FAMILYTYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;AI&#39;</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">FAMILYTYPE2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;UA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2469</span><span class="k">               </span><span class="n">IND_BCOR_TT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">ILEMTBCOR</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2470</span><span class="w">               </span><span class="n">IND_BCOR_HU</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">ILEMHBCOR</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2471</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">2472</span><span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">FAMILYTYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;AI&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2473</span><span class="k">               </span><span class="n">IND_PHASE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">8004</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2474</span><span class="w">               </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_PHASE</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2475</span><span class="k">                  allocate</span><span class="p">(</span><span class="w"> </span><span class="n">phase</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2476</span><span class="w">                  </span><span class="n">phase</span><span class="p">(:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2477</span><span class="w">                  </span><span class="n">phasePresent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">2478</span><span class="w">               </span><span class="k">end if</span>
<span class="linenos">2479</span><span class="k">            end if</span>
<span class="linenos">2480</span>
<span class="linenos">2481</span><span class="k">            if</span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FAMILYTYPE2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;UA&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">UA_HIGH_PRECISION_TT_ES</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">HIPCS</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">2482</span>
<span class="linenos">2483</span><span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">HIRES</span><span class="p">)</span><span class="w"> </span><span class="k">allocate</span><span class="p">(</span><span class="n">HLAT</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">),</span><span class="n">HLON</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">),</span><span class="n">HTIME</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2484</span>
<span class="linenos">2485</span><span class="w">            </span><span class="c">! If ATMS or AMSUA, or AMSUB read the element 33081 or 33082</span>
<span class="linenos">2486</span><span class="w">            </span><span class="n">IND_dataQcFlag2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2487</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">idtyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">192</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">idtyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">164</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">idtyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">181</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">idtyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">182</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2488</span><span class="k">              </span><span class="n">IND_dataQcFlag0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">33081</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2489</span><span class="w">              </span><span class="n">IND_dataQcFlag1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">33032</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2490</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">IND_dataQcFlag0</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_dataQcFlag1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then </span>
<span class="linenos">2491</span><span class="k">                call  </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;readBurp : Got two valid indices for IND_dataQcFlag2 in family&#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2492</span><span class="w">              </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">IND_dataQcFlag0</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_dataQcFlag1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then </span>
<span class="linenos">2493</span><span class="k">                </span><span class="n">IND_dataQcFlag2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_dataQcFlag0</span><span class="w"></span>
<span class="linenos">2494</span><span class="w">              </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">IND_dataQcFlag0</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_dataQcFlag1</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then </span>
<span class="linenos">2495</span><span class="k">                </span><span class="n">IND_dataQcFlag2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_dataQcFlag1</span><span class="w"></span>
<span class="linenos">2496</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">2497</span><span class="k">            end if</span><span class="w"></span>
<span class="linenos">2498</span><span class="w">            </span>
<span class="linenos">2499</span><span class="w">            </span><span class="c">! Allocate arrays for dataQcFlag if they are found in the file</span>
<span class="linenos">2500</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_dataQcFlag2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2501</span><span class="k">              allocate</span><span class="p">(</span><span class="n">dataQcFlag2</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2502</span><span class="w">              </span><span class="k">allocate</span><span class="p">(</span><span class="n">dataQcFlagLEV</span><span class="p">(</span><span class="n">nvale</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2503</span><span class="w">              </span><span class="n">dataQcFlag2</span><span class="p">(:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">2504</span><span class="w">              </span><span class="n">dataQcFlagLEV</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">2505</span><span class="w">            </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">2506</span>
<span class="linenos">2507</span><span class="w">            </span><span class="c">! if CSR data idtyp = 185, then read ele 020081</span>
<span class="linenos">2508</span><span class="w">            </span><span class="n">IND_dataCloudFrac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2509</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">idtyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">185</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2510</span><span class="k">              </span><span class="n">IND_dataCloudFrac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">020081</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2511</span><span class="w">            </span><span class="k">end if</span><span class="w"> </span>
<span class="linenos">2512</span><span class="w">            </span><span class="c">! Allocate arrays for dataCloudFrac if they are found in the file</span>
<span class="linenos">2513</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_dataCloudFrac</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2514</span><span class="k">              allocate</span><span class="p">(</span><span class="n">dataCloudFrac</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2515</span><span class="w">              </span><span class="k">allocate</span><span class="p">(</span><span class="n">dataCloudFracLEV</span><span class="p">(</span><span class="n">nvale</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2516</span><span class="w">              </span><span class="n">dataCloudFrac</span><span class="p">(:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">2517</span><span class="w">              </span><span class="n">dataCloudFracLEV</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">2518</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">2519</span>
<span class="linenos">2520</span>
<span class="linenos">2521</span><span class="k">            allocate</span><span class="p">(</span><span class="n">EMIS</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2522</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">SURF_EMIS</span><span class="p">(</span><span class="n">nvale</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2523</span><span class="w">            </span><span class="n">EMIS</span><span class="p">(:,:)</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2524</span><span class="w">            </span>
<span class="linenos">2525</span><span class="w">            </span><span class="n">OBSVALUE</span><span class="p">(:,:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2526</span><span class="w">            </span>
<span class="linenos">2527</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_BCOR</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">                              </span><span class="c">! TOVS</span>
<span class="linenos">2528</span><span class="w">               </span><span class="k">allocate</span><span class="p">(</span><span class="n">BCOR</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2529</span><span class="w">               </span><span class="k">allocate</span><span class="p">(</span><span class="n">BiasCorrection</span><span class="p">(</span><span class="n">nele</span><span class="p">,</span><span class="n">nvale</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2530</span><span class="w">               </span><span class="n">BiasCorrection</span><span class="p">(:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="w"></span>
<span class="linenos">2531</span><span class="w">               </span><span class="n">BCOR</span><span class="p">(:,:)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2532</span><span class="w">            </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="n">IND_BCOR_TT</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">IND_BCOR_HU</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">  </span><span class="c">! conventional (UA or AI)</span>
<span class="linenos">2533</span><span class="w">               </span><span class="k">allocate</span><span class="p">(</span><span class="n">BCOR2</span><span class="p">(</span><span class="n">nele</span><span class="p">,</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2534</span><span class="w">               </span><span class="k">allocate</span><span class="p">(</span><span class="n">BiasCorrection2</span><span class="p">(</span><span class="n">nele</span><span class="p">,</span><span class="n">nvale</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2535</span><span class="w">               </span><span class="n">BCOR2</span><span class="p">(:,:,:)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2536</span><span class="w">            </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">2537</span><span class="w">           </span>
<span class="linenos">2538</span>
<span class="linenos">2539</span><span class="w">            </span><span class="c">! Get the observations and conventional data bias corrections for each element in LISTE_ELE</span>
<span class="linenos">2540</span><span class="w">              </span>
<span class="linenos">2541</span><span class="w">            </span><span class="k">do </span><span class="n">IL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"></span>
<span class="linenos">2542</span>
<span class="linenos">2543</span><span class="w">              </span><span class="n">iele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LISTE_ELE</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2544</span><span class="w">              </span><span class="n">IND_ele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2545</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">2546</span>
<span class="linenos">2547</span><span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="n">HIPCS</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12001</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2548</span><span class="k">                </span><span class="n">IND_ele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">12101</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2549</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ele</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: cannot find element 12101 in Block_in&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2550</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">2551</span><span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="n">HIPCS</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12192</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2552</span><span class="k">                </span><span class="n">IND_ele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">12239</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2553</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_ele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_ele</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: cannot find element 12239 in Block_in&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2554</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">2555</span><span class="k">              do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2556</span><span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">2557</span><span class="w">                  </span><span class="n">obsvalue</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">IND_ele</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="o">=</span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2558</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">BUFR_NETT</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_BCOR_TT</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2559</span><span class="w">                    </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BCOR2</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">IND_BCOR_TT</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="o">=</span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2560</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">BUFR_NEES</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">IND_BCOR_HU</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2561</span><span class="w">                    </span><span class="p">&amp;</span><span class="w"> </span><span class="n">BCOR2</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">IND_BCOR_HU</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="o">=</span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2562</span><span class="w">                </span><span class="k">end do</span>
<span class="linenos">2563</span><span class="k">              end do</span>
<span class="linenos">2564</span><span class="k">              </span>
<span class="linenos">2565</span><span class="k">            end do</span><span class="w"></span>
<span class="linenos">2566</span><span class="w">            </span>
<span class="linenos">2567</span><span class="w">            </span><span class="c">! Get other needed elements including vccord, TOVS bias corrections and AI phase of flight</span>
<span class="linenos">2568</span><span class="w">            </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2569</span><span class="w">              </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">2570</span><span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">HIRES</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">2571</span><span class="k">                    </span><span class="n">HLAT</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_LAT</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2572</span><span class="w">                    </span><span class="n">HLON</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_LON</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2573</span><span class="w">                    </span><span class="n">HTIME</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_TIME</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2574</span><span class="w">                  </span><span class="k">END IF</span>
<span class="linenos">2575</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">phasePresent</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2576</span><span class="k">                    </span><span class="n">phase</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_phase</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2577</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">2578</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">IND_dataQcFlag2</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2579</span><span class="k">                    </span><span class="n">dataQcFlag2</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_dataQcFlag2</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2580</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">2581</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">IND_dataCloudFrac</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2582</span><span class="k">                    </span><span class="n">dataCloudFrac</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_dataCloudFrac</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2583</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">2584</span><span class="k">                  IF</span><span class="w"> </span><span class="p">(</span><span class="n">IND_EMIS</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">2585</span><span class="k">                    </span><span class="n">EMIS</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_EMIS</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2586</span><span class="w">                  </span><span class="k">END IF</span>
<span class="linenos">2587</span><span class="k">                  IF</span><span class="w"> </span><span class="p">(</span><span class="n">IND_BCOR</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">2588</span><span class="k">                    </span><span class="n">BCOR</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_BCOR</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2589</span><span class="w">                  </span><span class="k">END IF</span>
<span class="linenos">2590</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_VCOORD</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2591</span><span class="k">                    </span><span class="n">VCOORD</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_VCOORD</span><span class="p">,</span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2592</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">2593</span><span class="k">              end do</span>
<span class="linenos">2594</span><span class="k">            end do</span><span class="w"></span>
<span class="linenos">2595</span>
<span class="linenos">2596</span><span class="c">!==================================================================================</span>
<span class="linenos">2597</span><span class="c">!</span>
<span class="linenos">2598</span><span class="c">! Lire les divers elements de la famille SW</span>
<span class="linenos">2599</span><span class="c">!</span>
<span class="linenos">2600</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">qi1val</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2601</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">qi2val</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2602</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">mtval</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2603</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">lsval</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2604</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">haval</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2605</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">gaval</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2606</span><span class="w">            </span><span class="n">QI1VAL</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2607</span><span class="w">            </span><span class="n">QI2VAL</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2608</span><span class="w">            </span><span class="n">MTVAL</span><span class="w"> </span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2609</span><span class="w">            </span><span class="n">LSVAL</span><span class="w"> </span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2610</span><span class="w">            </span><span class="n">HAVAL</span><span class="w"> </span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2611</span><span class="w">            </span><span class="n">GAVAL</span><span class="w"> </span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2612</span>
<span class="linenos">2613</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;SW&#39;</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">READ_QI_GA_MT_SW</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2614</span>
<span class="linenos">2615</span><span class="k">              </span><span class="n">IND_SW</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">33007</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2616</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_SW</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">2617</span><span class="k">              do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2618</span><span class="w">                </span><span class="n">QI1VAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2619</span><span class="w">                                           </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_SW</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2620</span><span class="w">                                           </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2621</span><span class="w">                                           </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2622</span><span class="w">                                           </span><span class="n">IOSTAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2623</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Tblval 33007&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2624</span><span class="w">              </span><span class="k">end do</span>
<span class="linenos">2625</span>
<span class="linenos">2626</span><span class="k">              </span><span class="n">IND_SW</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">33194</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2627</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_SW</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">2628</span><span class="k">              do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2629</span><span class="w">                </span><span class="n">QI2VAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2630</span><span class="w">                                          </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_SW</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2631</span><span class="w">                                          </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2632</span><span class="w">                                          </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2633</span><span class="w">                                          </span><span class="n">IOSTAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2634</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Tblval 33194&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2635</span><span class="w">              </span><span class="k">end do</span>
<span class="linenos">2636</span>
<span class="linenos">2637</span><span class="k">              </span><span class="n">IND_SW</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">2023</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2638</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_SW</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">2639</span><span class="k">              do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2640</span><span class="w">                </span><span class="n">MTVAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2641</span><span class="w">                                          </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_SW</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2642</span><span class="w">                                          </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2643</span><span class="w">                                          </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2644</span><span class="w">                                          </span><span class="n">IOSTAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2645</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Tblval 2023&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2646</span><span class="w">              </span><span class="k">end do</span>
<span class="linenos">2647</span>
<span class="linenos">2648</span><span class="k">              </span><span class="n">IND_SW</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">8012</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2649</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_SW</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">2650</span><span class="k">              do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2651</span><span class="w">                </span><span class="n">LSVAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2652</span><span class="w">                                          </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_SW</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2653</span><span class="w">                                          </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2654</span><span class="w">                                          </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2655</span><span class="w">                                          </span><span class="n">IOSTAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2656</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Tblval 8012&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2657</span><span class="w">              </span><span class="k">end do</span>
<span class="linenos">2658</span>
<span class="linenos">2659</span><span class="k">              </span><span class="n">IND_SW</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">13039</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2660</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_SW</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">2661</span><span class="k">              do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2662</span><span class="w">                </span><span class="n">GAVAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2663</span><span class="w">                                          </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_SW</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2664</span><span class="w">                                          </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2665</span><span class="w">                                          </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2666</span><span class="w">                                          </span><span class="n">IOSTAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2667</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Tblval 13039&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2668</span><span class="w">              </span><span class="k">end do</span>
<span class="linenos">2669</span>
<span class="linenos">2670</span><span class="k">              </span><span class="n">IND_SW</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">2163</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2671</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_SW</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">2672</span><span class="k">              do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2673</span><span class="w">                </span><span class="n">HAVAL</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2674</span><span class="w">                                          </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_SW</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2675</span><span class="w">                                          </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2676</span><span class="w">                                          </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2677</span><span class="w">                                          </span><span class="n">IOSTAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2678</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Tblval 2163&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2679</span><span class="w">              </span><span class="k">end do</span><span class="w"></span>
<span class="linenos">2680</span>
<span class="linenos">2681</span><span class="w">            </span><span class="c">!====================================================================</span>
<span class="linenos">2682</span><span class="w">            </span><span class="c">!</span>
<span class="linenos">2683</span><span class="w">            </span><span class="c">! Lire les divers elements de la famille AL</span>
<span class="linenos">2684</span><span class="w">            </span><span class="c">!</span>
<span class="linenos">2685</span><span class="w">            </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familytype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;AL&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2686</span><span class="k">              if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">azimuth</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2687</span><span class="k">                allocate</span><span class="p">(</span><span class="n">azimuth</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2688</span><span class="w">                </span><span class="n">azimuth</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">2689</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">2690</span>
<span class="linenos">2691</span><span class="w">              </span><span class="c">! Read in the azimuth)</span>
<span class="linenos">2692</span><span class="w">              </span><span class="n">ind_al</span><span class="o">=</span><span class="n">burp_find_element</span><span class="p">(</span><span class="n">block_in</span><span class="p">,</span><span class="w"> </span><span class="n">element</span><span class="o">=</span><span class="n">BUFR_NEAZ</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2693</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind_al</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">2694</span>
<span class="linenos">2695</span><span class="k">              do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2696</span><span class="w">                </span><span class="n">azimuth</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2697</span><span class="w">                                            </span><span class="n">nele_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind_al</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2698</span><span class="w">                                            </span><span class="n">nval_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2699</span><span class="w">                                            </span><span class="n">nt_ind</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2700</span><span class="w">                                            </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2701</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Rval BUFR_NEAZ&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2702</span><span class="w">              </span><span class="k">end do</span>
<span class="linenos">2703</span><span class="k">            end if</span><span class="w"> </span><span class="c">! AL</span>
<span class="linenos">2704</span><span class="w">            </span><span class="c">!</span>
<span class="linenos">2705</span><span class="w">            </span><span class="c">!====================================================================</span>
<span class="linenos">2706</span>
<span class="linenos">2707</span><span class="w">          </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">2708</span>
<span class="linenos">2709</span>
<span class="linenos">2710</span><span class="w">          </span><span class="c">! flag block (btyp = 0111 100011X XXXX)</span>
<span class="linenos">2711</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10flg</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">    </span><span class="c">! non-sfc type flag block</span>
<span class="linenos">2712</span>
<span class="linenos">2713</span><span class="w">            </span><span class="n">flag_passage4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2714</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">qcflag</span><span class="p">(</span><span class="w"> </span><span class="n">NELE</span><span class="p">,</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2715</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">qcflags</span><span class="p">(</span><span class="n">NELE</span><span class="p">,</span><span class="n">nvale</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2716</span><span class="w">            </span><span class="n">QCFLAG</span><span class="w"> </span><span class="p">(:,:,:)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2717</span><span class="w">            </span><span class="n">QCFLAGS</span><span class="p">(:,:)</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2718</span>
<span class="linenos">2719</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">hiresTimeFlag</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2720</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">hiresLatFlag</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2721</span><span class="w">            </span><span class="n">hiresTimeFlag</span><span class="p">(:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2722</span><span class="w">            </span><span class="n">hiresLatFlag</span><span class="p">(:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2723</span>
<span class="linenos">2724</span><span class="w">            </span><span class="k">do </span><span class="n">IL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"></span>
<span class="linenos">2725</span>
<span class="linenos">2726</span><span class="w">              </span><span class="n">iele</span><span class="o">=</span><span class="n">LISTE_ELE</span><span class="p">(</span><span class="n">IL</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2727</span>
<span class="linenos">2728</span><span class="w">              </span><span class="n">IND_QCFLAG</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">200000</span><span class="o">+</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2729</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_QCFLAG</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">2730</span>
<span class="linenos">2731</span><span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="n">UA_FLAG_HIGH_PRECISION_TT_ES</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2732</span><span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">HIPCS</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12001</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2733</span><span class="k">                  </span><span class="n">IND_QCFLAG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">212101</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2734</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_QCFLAG</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_QCFLAG</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: cannot find element 212101 in Block_in&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2735</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">2736</span><span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">HIPCS</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">iele</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">12192</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2737</span><span class="k">                  </span><span class="n">IND_QCFLAG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">212239</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2738</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_QCFLAG</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">IND_QCFLAG</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: cannot find element 212239 in Block_in&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2739</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">2740</span><span class="k">              end if</span>
<span class="linenos">2741</span>
<span class="linenos">2742</span><span class="k">              do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2743</span><span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">2744</span><span class="w">                  </span><span class="n">QCFLAG</span><span class="p">(</span><span class="n">IL</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2745</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_QCFLAG</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2746</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2747</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2748</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">   </span><span class="n">IOSTAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2749</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Tblval IND_QCFLAG&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2750</span><span class="w">                  </span><span class="nb">SUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">SUM</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2751</span><span class="w">                </span><span class="k">end do</span>
<span class="linenos">2752</span><span class="k">              end do</span>
<span class="linenos">2753</span>
<span class="linenos">2754</span><span class="k">            end do</span><span class="w"></span>
<span class="linenos">2755</span>
<span class="linenos">2756</span><span class="w">            </span><span class="c">! read the hires time and latitude flags, needed for UA thinning procedure</span>
<span class="linenos">2757</span><span class="w">            </span><span class="n">IND_QCFLAG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">204015</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2758</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_QCFLAG</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2759</span><span class="k">              do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2760</span><span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">2761</span><span class="w">                  </span><span class="n">hiresTimeFlag</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2762</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_QCFLAG</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2763</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2764</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2765</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">   </span><span class="n">IOSTAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2766</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Tblval 204015&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2767</span><span class="w">                  </span><span class="nb">SUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">SUM</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2768</span><span class="w">                </span><span class="k">end do</span>
<span class="linenos">2769</span><span class="k">              end do</span>
<span class="linenos">2770</span><span class="k">            end if</span>
<span class="linenos">2771</span><span class="k">            </span><span class="n">IND_QCFLAG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">205001</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2772</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">IND_QCFLAG</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2773</span><span class="k">              do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2774</span><span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">2775</span><span class="w">                  </span><span class="n">hiresLatFlag</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2776</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">IND_QCFLAG</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2777</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2778</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2779</span><span class="w">                                  </span><span class="p">&amp;</span><span class="w">   </span><span class="n">IOSTAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2780</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_Tblval 205001&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2781</span><span class="w">                  </span><span class="nb">SUM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">SUM</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2782</span><span class="w">                </span><span class="k">end do</span>
<span class="linenos">2783</span><span class="k">              end do</span>
<span class="linenos">2784</span><span class="k">            end if</span>
<span class="linenos">2785</span>
<span class="linenos">2786</span><span class="k">          end if</span><span class="w"></span>
<span class="linenos">2787</span>
<span class="linenos">2788</span><span class="w">          </span><span class="c">! info block (btyp = 0001 100000X XXXX) </span>
<span class="linenos">2789</span><span class="w">          </span><span class="n">BTYP10inf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">96</span><span class="w"></span>
<span class="linenos">2790</span>
<span class="linenos">2791</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10inf</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">(</span><span class="n">btyp10</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">btyp10inf</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2792</span>
<span class="linenos">2793</span><span class="k">            allocate</span><span class="p">(</span><span class="w"> </span><span class="n">RINFO</span><span class="p">(</span><span class="n">NELE_INFO</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2794</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">TRINFO</span><span class="p">(</span><span class="n">NELE_INFO</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2795</span>
<span class="linenos">2796</span><span class="w">            </span><span class="n">flag_passage2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2797</span>
<span class="linenos">2798</span><span class="w">            </span><span class="k">do </span><span class="n">kl</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NELE_INFO</span><span class="w"></span>
<span class="linenos">2799</span><span class="w">              </span><span class="n">info_elepos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2800</span><span class="w">                                 </span><span class="p">&amp;</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">LISTE_INFO</span><span class="p">(</span><span class="n">kl</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2801</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="n">info_elepos</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="k">then</span>
<span class="linenos">2802</span><span class="k">                </span>
<span class="linenos">2803</span><span class="k">                do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2804</span><span class="w">                  </span><span class="n">RINFO</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_rval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2805</span><span class="w">                              </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info_elepos</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2806</span><span class="w">                              </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2807</span><span class="w">                              </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2808</span><span class="w">                              </span><span class="p">&amp;</span><span class="w">   </span><span class="n">IOSTAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2809</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_rval info_elepos&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2810</span><span class="w">                  </span><span class="k">if</span><span class="w">  </span><span class="p">(</span><span class="n">RINFO</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">)</span><span class="w">  </span><span class="k">THEN    </span>
<span class="linenos">2811</span><span class="k">                    </span><span class="n">infot</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2812</span><span class="w">                            </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">info_elepos</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2813</span><span class="w">                            </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2814</span><span class="w">                            </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2815</span><span class="w">                            </span><span class="p">&amp;</span><span class="w">   </span><span class="n">IOSTAT</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2816</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_tblval info_elepos&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2817</span><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">infot</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">RINFO</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">infot</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2818</span><span class="w">                  </span><span class="k">END IF</span>
<span class="linenos">2819</span>
<span class="linenos">2820</span><span class="k">                end do</span>
<span class="linenos">2821</span>
<span class="linenos">2822</span><span class="k">              else</span>
<span class="linenos">2823</span><span class="k">                </span><span class="n">RINFO</span><span class="p">(</span><span class="n">kl</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nte</span><span class="p">)</span><span class="o">=</span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2824</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">2825</span>
<span class="linenos">2826</span><span class="k">            end do</span>
<span class="linenos">2827</span>
<span class="linenos">2828</span><span class="k">          end if</span><span class="w"></span>
<span class="linenos">2829</span>
<span class="linenos">2830</span>
<span class="linenos">2831</span><span class="w">          </span><span class="c">! descriptor block (btyp = 0010 100000X XXXX) </span>
<span class="linenos">2832</span><span class="w">          </span><span class="n">BTYP10des</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">160</span><span class="w"></span>
<span class="linenos">2833</span>
<span class="linenos">2834</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BTYP10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">BTYP10des</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2835</span>
<span class="linenos">2836</span><span class="k">            </span><span class="n">flag_passage1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2837</span>
<span class="linenos">2838</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">GLBFLAG</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2839</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="w">    </span><span class="n">lat</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2840</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="w">    </span><span class="n">lon</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2841</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="w">   </span><span class="n">date</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2842</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="w">   </span><span class="n">hhmm</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2843</span>
<span class="linenos">2844</span><span class="w">            </span><span class="c">! DATE  004208  HHMM 004197  STATUS 055200  LAT 005002  LON 006002  DELAY 004195</span>
<span class="linenos">2845</span><span class="w">            </span><span class="n">ind055200</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">055200</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2846</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind055200</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind055200</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: cannot find element 55200 in Block_in&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2847</span><span class="w">            </span><span class="n">ind5002</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">5002</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2848</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind5002</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind5002</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: cannot find element 5002 in Block_in&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2849</span><span class="w">            </span><span class="n">ind6002</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">6002</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2850</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind6002</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind6002</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: cannot find element 6002 in Block_in&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2851</span><span class="w">            </span><span class="n">ind4208</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">4208</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2852</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind4208</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind4208</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: cannot find element 4208 in Block_in&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2853</span><span class="w">            </span><span class="n">ind4197</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">4197</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2854</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind4197</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind4197</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: cannot find element 4197 in Block_in&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2855</span>
<span class="linenos">2856</span><span class="w">            </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2857</span><span class="w">              </span><span class="n">LAT</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2858</span><span class="w">                         </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind5002</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2859</span><span class="w">                         </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2860</span><span class="w">                         </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2861</span><span class="w">              </span><span class="n">LON</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2862</span><span class="w">                         </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind6002</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2863</span><span class="w">                         </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2864</span><span class="w">                         </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2865</span><span class="w">              </span><span class="n">HHMM</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2866</span><span class="w">                          </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind4197</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2867</span><span class="w">                          </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2868</span><span class="w">                          </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2869</span><span class="w">              </span><span class="n">DATE</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2870</span><span class="w">                          </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind4208</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2871</span><span class="w">                          </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2872</span><span class="w">                          </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2873</span><span class="w">              </span><span class="n">GLBFLAG</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2874</span><span class="w">                             </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind055200</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2875</span><span class="w">                             </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2876</span><span class="w">                             </span><span class="p">&amp;</span><span class="w">   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2877</span><span class="w">            </span><span class="k">end do</span>
<span class="linenos">2878</span>
<span class="linenos">2879</span><span class="k">          end if</span><span class="w"></span>
<span class="linenos">2880</span>
<span class="linenos">2881</span><span class="w">          </span><span class="c">!==================== IASI  SPECIAL BLOCK==================</span>
<span class="linenos">2882</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">BTYP</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">9217</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">  </span><span class="n">IDTYP</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">186</span><span class="w">   </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2883</span><span class="k">            </span><span class="n">NCLASSAVHRR</span><span class="o">=</span><span class="n">obs_getNclassAvhrr</span><span class="p">()</span><span class="w"></span>
<span class="linenos">2884</span><span class="w">            </span><span class="n">NCHANAVHRR</span><span class="o">=</span><span class="n">obs_getNchanAvhrr</span><span class="p">()</span><span class="w"></span>
<span class="linenos">2885</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">CFRAC</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">allocate</span><span class="p">(</span><span class="w"> </span><span class="n">CFRAC</span><span class="p">(</span><span class="n">NCLASSAVHRR</span><span class="p">,</span><span class="n">nte</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2886</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">RADMOY</span><span class="p">))</span><span class="w"> </span><span class="k">allocate</span><span class="p">(</span><span class="n">RADMOY</span><span class="p">(</span><span class="n">NCLASSAVHRR</span><span class="p">,</span><span class="n">NCHANAVHRR</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2887</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">radstd</span><span class="p">))</span><span class="w"> </span><span class="k">allocate</span><span class="p">(</span><span class="n">radstd</span><span class="p">(</span><span class="n">NCLASSAVHRR</span><span class="p">,</span><span class="n">NCHANAVHRR</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">2888</span>
<span class="linenos">2889</span><span class="w">            </span><span class="n">RADMOY</span><span class="p">(:,:,:)</span><span class="o">=</span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2890</span><span class="w">            </span><span class="n">RADSTD</span><span class="p">(:,:,:)</span><span class="o">=</span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2891</span><span class="w">            </span><span class="n">CFRAC</span><span class="p">(:,:)</span><span class="o">=</span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">2892</span>
<span class="linenos">2893</span><span class="w">            </span><span class="n">IASIQUAL</span><span class="p">:</span><span class="w"> </span><span class="k">DO </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2894</span><span class="w">              </span><span class="n">iclass</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2895</span>
<span class="linenos">2896</span><span class="w">              </span><span class="n">NVALS</span><span class="w"> </span><span class="p">:</span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">2897</span><span class="w">                </span><span class="k">DO  </span><span class="n">il</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nbele</span><span class="w"></span>
<span class="linenos">2898</span><span class="w">                  </span><span class="n">iele</span><span class="o">=</span><span class="n">BURP_Get_Element</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="nb">INDEX</span><span class="w"> </span><span class="o">=</span><span class="n">il</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2899</span><span class="w">                  </span><span class="k">SELECT CASE</span><span class="p">(</span><span class="n">iele</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2900</span><span class="w">                    </span><span class="k">CASE</span><span class="p">(</span><span class="mi">25085</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2901</span><span class="w">                      </span><span class="n">CFRAC</span><span class="p">(</span><span class="n">iclass</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_RVAL</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2902</span><span class="w">                      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_RVAL 25085&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2903</span><span class="w">                    </span><span class="k">CASE</span><span class="p">(</span><span class="mi">5042</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2904</span><span class="w">                      </span><span class="c">!ICHAN= BURP_Get_TBLVAL(Block_in,NELE_IND = il, NVAL_IND = j, NT_IND = k, IOSTAT = error)</span>
<span class="linenos">2905</span><span class="w">                      </span><span class="n">ICHAN</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_RVAL</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2906</span><span class="w">                      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_RVAL 5042&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2907</span><span class="w">                    </span><span class="k">CASE</span><span class="p">(</span><span class="mi">25142</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2908</span><span class="w">                      </span><span class="c">!INORM= BURP_Get_TBLVAL(Block_in,NELE_IND = il, NVAL_IND = j, NT_IND = k, IOSTAT = error)</span>
<span class="linenos">2909</span><span class="w">                      </span><span class="n">INORM</span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_RVAL</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2910</span><span class="w">                      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_RVAL 25142&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2911</span><span class="w">                    </span><span class="k">CASE</span><span class="p">(</span><span class="mi">14047</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2912</span><span class="w">                      </span><span class="n">RAD_MOY</span><span class="o">=</span><span class="n">BURP_Get_RVAL</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2913</span><span class="w">                      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_RVAL 14047&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2914</span><span class="w">                      </span><span class="n">RADMOY</span><span class="p">(</span><span class="n">iclass</span><span class="p">,</span><span class="n">ICHAN</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="n">RAD_MOY</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.d0</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">INORM</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10000</span><span class="mf">0.d0</span><span class="w"></span>
<span class="linenos">2915</span><span class="w">                    </span><span class="k">CASE</span><span class="p">(</span><span class="mi">14048</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2916</span><span class="w">                      </span><span class="n">RAD_STD</span><span class="o">=</span><span class="n">BURP_Get_RVAL</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">il</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="n">NT_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2917</span><span class="w">                      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: BURP_Get_RVAL 14048&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2918</span><span class="w">                      </span><span class="n">RADSTD</span><span class="p">(</span><span class="n">iclass</span><span class="p">,</span><span class="n">ICHAN</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="w"> </span><span class="n">RAD_STD</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="mf">0.d0</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mf">1.d0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">INORM</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">10000</span><span class="mf">0.d0</span><span class="w"></span>
<span class="linenos">2919</span><span class="w">                      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">ICHAN</span><span class="o">==</span><span class="n">NCHANAVHRR</span><span class="p">)</span><span class="w"> </span><span class="n">iclass</span><span class="o">=</span><span class="n">iclass</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">2920</span><span class="w">                      </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">iclass</span><span class="o">==</span><span class="p">(</span><span class="n">NCLASSAVHRR</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">EXIT </span><span class="n">NVALS</span><span class="w"></span>
<span class="linenos">2921</span><span class="w">                  </span><span class="k">END SELECT</span>
<span class="linenos">2922</span><span class="k">                END DO</span>
<span class="linenos">2923</span><span class="k">              end do </span><span class="n">NVALS</span><span class="w"></span>
<span class="linenos">2924</span>
<span class="linenos">2925</span><span class="w">            </span><span class="k">END DO </span><span class="n">IASIQUAL</span><span class="w"></span>
<span class="linenos">2926</span>
<span class="linenos">2927</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">2928</span>
<span class="linenos">2929</span><span class="k">        end do </span><span class="n">BLOCKS1</span><span class="w"></span>
<span class="linenos">2930</span>
<span class="linenos">2931</span><span class="w">        </span><span class="c">! Loop over observations/locations (nte &gt; 1 for families with grouped data like AI and TO)</span>
<span class="linenos">2932</span><span class="w">        </span><span class="c">! Fill obsSpaceData HEADER and BODY</span>
<span class="linenos">2933</span><span class="w">        </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">2934</span>
<span class="linenos">2935</span><span class="w">          </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="nb">allocated</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">2936</span>
<span class="linenos">2937</span><span class="k">            </span><span class="n">XLON</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lon</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="mf">1.</span><span class="o">-</span><span class="mi">1800</span><span class="mf">0.</span><span class="p">)</span><span class="o">*</span><span class="p">.</span><span class="mi">01</span><span class="w"></span>
<span class="linenos">2938</span><span class="w">            </span><span class="n">XLAT</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">lat</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="mf">1.</span><span class="o">-</span><span class="w"> </span><span class="mi">900</span><span class="mf">0.</span><span class="p">)</span><span class="o">*</span><span class="p">.</span><span class="mi">01</span><span class="w"></span>
<span class="linenos">2939</span><span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">xlon</span><span class="w">  </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">xlon</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">36</span><span class="mf">0.</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">xlon</span><span class="w"></span>
<span class="linenos">2940</span><span class="w">            </span><span class="n">XLON</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">XLON</span><span class="o">*</span><span class="n">MPC_RADIANS_PER_DEGREE_R8</span><span class="w"></span>
<span class="linenos">2941</span><span class="w">            </span><span class="n">XLAT</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">XLAT</span><span class="o">*</span><span class="n">MPC_RADIANS_PER_DEGREE_R8</span><span class="w"></span>
<span class="linenos">2942</span><span class="w">            </span><span class="n">YMD_DATE</span><span class="o">=</span><span class="n">date</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2943</span><span class="w">            </span><span class="n">HM</span><span class="w">      </span><span class="o">=</span><span class="n">hhmm</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2944</span><span class="w">            </span><span class="n">STATUS</span><span class="w">  </span><span class="o">=</span><span class="n">GLBFLAG</span><span class="p">(</span><span class="n">K</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2945</span><span class="w">            </span><span class="n">RELEV</span><span class="w">   </span><span class="o">=</span><span class="kt">REAL</span><span class="p">(</span><span class="n">ELEV</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">40</span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">2946</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">2947</span><span class="k">            </span><span class="n">XLON</span><span class="w">    </span><span class="o">=</span><span class="p">.</span><span class="mi">01</span><span class="o">*</span><span class="nb">LONG</span>
<span class="linenos">2948</span><span class="nb">            </span><span class="n">XLAT</span><span class="w">    </span><span class="o">=</span><span class="n">LATI</span><span class="o">*</span><span class="p">.</span><span class="mi">01</span><span class="w"> </span><span class="o">-</span><span class="mi">9</span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">2949</span><span class="w">            </span><span class="n">XLON</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">XLON</span><span class="o">*</span><span class="n">MPC_RADIANS_PER_DEGREE_R8</span><span class="w"></span>
<span class="linenos">2950</span><span class="w">            </span><span class="n">XLAT</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">XLAT</span><span class="o">*</span><span class="n">MPC_RADIANS_PER_DEGREE_R8</span><span class="w"></span>
<span class="linenos">2951</span><span class="w">            </span><span class="n">YMD_DATE</span><span class="o">=</span><span class="n">date_h</span><span class="w"></span>
<span class="linenos">2952</span><span class="w">            </span><span class="n">HM</span><span class="w">      </span><span class="o">=</span><span class="n">hhmm_h</span><span class="w"></span>
<span class="linenos">2953</span><span class="w">            </span><span class="n">RELEV</span><span class="w">   </span><span class="o">=</span><span class="kt">REAL</span><span class="p">(</span><span class="n">ELEV</span><span class="p">,</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">40</span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">2954</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">2955</span>
<span class="linenos">2956</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">RINFO</span><span class="p">))</span><span class="w">      </span><span class="n">TRINFO</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_INFO</span><span class="p">)</span><span class="w">     </span><span class="o">=</span><span class="n">RINFO</span><span class="w">       </span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_INFO</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2957</span>
<span class="linenos">2958</span>
<span class="linenos">2959</span><span class="w">          </span><span class="k">if</span><span class="p">(</span><span class="n">ENFORCE_CLASSIC_SONDES</span><span class="p">)</span><span class="w"> </span><span class="n">hires</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">2960</span>
<span class="linenos">2961</span><span class="w">          </span><span class="k">IF</span><span class="w">  </span><span class="p">(</span><span class="n">HIRES</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span><span class="w">  </span><span class="c">! LAT LON TIME IN DATA BLOCK (e.g. UA family)</span>
<span class="linenos">2962</span>
<span class="linenos">2963</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">EMIS</span><span class="p">))</span><span class="w"> </span><span class="n">SURF_EMIS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">)</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">EMIS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2964</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">BCOR</span><span class="p">))</span><span class="w"> </span><span class="n">BiasCorrection</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BCOR</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2965</span>
<span class="linenos">2966</span><span class="w">            </span><span class="n">NDATA</span><span class="w">   </span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2967</span><span class="w">            </span><span class="n">NDATA_SF</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">2968</span><span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">obsvalue_sfc</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">2969</span><span class="k">              </span><span class="n">OBSERV_SFC</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obsvalue_sfc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2970</span><span class="w">              </span><span class="n">BCOR_SFC</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BiasCorrection_sfc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2971</span><span class="w">              </span><span class="n">QCFLAGS_sfc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qcflag_sfc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2972</span><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">HIRES_SFC</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">2973</span><span class="k">                </span><span class="n">XLAT</span><span class="o">=</span><span class="n">HLAT_SFC</span><span class="p">(</span><span class="n">k</span><span class="p">);</span><span class="n">XLON</span><span class="o">=</span><span class="n">HLON_SFC</span><span class="p">(</span><span class="n">k</span><span class="p">);</span><span class="n">XTIME</span><span class="o">=</span><span class="n">HTIME_SFC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2974</span><span class="w">                </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">XLON</span><span class="w">  </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">XLON</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">36</span><span class="mf">0.</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">XLON</span><span class="w"></span>
<span class="linenos">2975</span><span class="w">                </span><span class="n">ier</span><span class="o">=</span><span class="w"> </span><span class="n">NEWDATE</span><span class="p">(</span><span class="n">kstamp2</span><span class="p">,</span><span class="n">YMD_DATE</span><span class="p">,</span><span class="n">HM</span><span class="o">*</span><span class="mi">10000</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2976</span><span class="w">                </span><span class="n">XLAT</span><span class="o">=</span><span class="n">XLAT</span><span class="o">*</span><span class="n">MPC_RADIANS_PER_DEGREE_R8</span><span class="w"></span>
<span class="linenos">2977</span><span class="w">                </span><span class="n">XLON</span><span class="o">=</span><span class="n">XLON</span><span class="o">*</span><span class="n">MPC_RADIANS_PER_DEGREE_R8</span><span class="w"></span>
<span class="linenos">2978</span>
<span class="linenos">2979</span><span class="w">                </span><span class="k">call </span><span class="n">INCDATR</span><span class="p">(</span><span class="n">kstamp</span><span class="p">,</span><span class="w"> </span><span class="n">kstamp2</span><span class="p">,</span><span class="w"> </span><span class="n">XTIME</span><span class="o">/</span><span class="mi">6</span><span class="mf">0.d0</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="linenos">2980</span><span class="w">                </span><span class="n">IER</span><span class="o">=</span><span class="n">newdate</span><span class="p">(</span><span class="n">kstamp</span><span class="p">,</span><span class="n">date2</span><span class="p">,</span><span class="n">time_sonde</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2981</span><span class="w">                </span><span class="n">time2</span><span class="o">=</span><span class="n">time_sonde</span><span class="o">/</span><span class="mi">10000</span><span class="w"></span>
<span class="linenos">2982</span><span class="w">                </span><span class="n">YMD_DATE_SFC</span><span class="o">=</span><span class="n">date2</span><span class="w"></span>
<span class="linenos">2983</span><span class="w">                </span><span class="n">HM_SFC</span><span class="o">=</span><span class="n">time2</span><span class="w"></span>
<span class="linenos">2984</span><span class="w">              </span><span class="k">END IF</span><span class="w"></span>
<span class="linenos">2985</span>
<span class="linenos">2986</span><span class="w">              </span><span class="c">! dataQcFlagLev does not exist for surface data</span>
<span class="linenos">2987</span><span class="w">              </span><span class="n">dataQcFlagLev_sfc</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">2988</span><span class="w">              </span><span class="n">dataCloudFracLev_sfc</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">2989</span>
<span class="linenos">2990</span><span class="w">              </span><span class="n">NDATA_SF</span><span class="o">=</span><span class="w"> </span><span class="n">WRITE_BODY</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">UNI_FAMILYTYPE</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">vcoord_sfc</span><span class="p">,</span><span class="n">vcoord_type</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2991</span><span class="w">                                   </span><span class="n">OBSERV_SFC</span><span class="p">,</span><span class="n">qcflags_sfc</span><span class="p">,</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">LISTE_ELE_SFC</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">2992</span><span class="w">                                   </span><span class="n">dataQcFlagLEV_sfc</span><span class="p">,</span><span class="n">dataCloudFracLev_sfc</span><span class="p">,</span><span class="w"> </span><span class="n">ROLAT</span><span class="p">,</span><span class="n">ROLON</span><span class="p">,&amp;</span><span class="w"> </span>
<span class="linenos">2993</span><span class="w">                                   </span><span class="n">BiasCorrection_opt</span><span class="o">=</span><span class="n">BCOR_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2994</span>
<span class="linenos">2995</span><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">NDATA_SF</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">2996</span><span class="k">                call </span><span class="n">WRITE_HEADER</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">STNID</span><span class="p">,</span><span class="n">XLAT</span><span class="p">,</span><span class="n">XLON</span><span class="p">,</span><span class="n">YMD_DATE_SFC</span><span class="p">,</span><span class="n">HM_SFC</span><span class="p">,</span><span class="n">idtyp</span><span class="p">,</span><span class="n">STATUS</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">FILENUMB</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2997</span><span class="w">                </span><span class="n">OBSN</span><span class="o">=</span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2998</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">obs_prfl</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_PRFL</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">kk</span><span class="p">)</span><span class="w"></span>
<span class="linenos">2999</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">obs_hdd</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_HDD</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">date_h</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3000</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">obs_hdt</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_HDT</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">hhmm_h</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3001</span><span class="w">                </span><span class="k">call </span><span class="n">obs_setFamily</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">),</span><span class="w">  </span><span class="n">OBSN</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3002</span><span class="w">                </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_NLV</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">NDATA_SF</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3003</span><span class="w">                </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">OBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3004</span><span class="k">                  </span><span class="n">LN</span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_NLV</span><span class="p">,</span><span class="n">OBSN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3005</span><span class="w">                  </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">LN</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3006</span><span class="w">                </span><span class="k">ELSE</span>
<span class="linenos">3007</span><span class="k">                  call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3008</span><span class="w">                </span><span class="k">END IF</span><span class="w"></span>
<span class="linenos">3009</span>
<span class="linenos">3010</span><span class="w">                </span><span class="c">! write info block to header (same values for all headers associated with report)</span>
<span class="linenos">3011</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TRINFO</span><span class="p">))</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">3012</span><span class="k">                  call </span><span class="n">writeInfo</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">familytype</span><span class="p">,</span><span class="w"> </span><span class="n">TRINFO</span><span class="p">,</span><span class="n">LISTE_INFO</span><span class="p">,</span><span class="n">NELE_INFO</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3013</span><span class="w">                </span><span class="k">else</span>
<span class="linenos">3014</span><span class="k">                  call </span><span class="n">setInfoToMissing</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3015</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">3016</span>
<span class="linenos">3017</span><span class="k">              END IF</span>
<span class="linenos">3018</span>
<span class="linenos">3019</span><span class="k">            END IF</span>
<span class="linenos">3020</span>
<span class="linenos">3021</span><span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">obsvalue</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3022</span>
<span class="linenos">3023</span><span class="k">              if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataQcFlag2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3024</span><span class="k">                if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataQcFlagLEV</span><span class="p">))</span><span class="w"> </span><span class="k">allocate</span><span class="p">(</span><span class="n">dataQcFlagLEV</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3025</span><span class="w">                </span><span class="n">dataQcFlagLEV</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3026</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">3027</span>
<span class="linenos">3028</span><span class="k">              if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataCloudFrac</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3029</span><span class="k">                if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataCloudFracLEV</span><span class="p">))</span><span class="w"> </span><span class="k">allocate</span><span class="p">(</span><span class="n">dataCloudFracLEV</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3030</span><span class="w">                </span><span class="n">dataCloudFracLEV</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3031</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">3032</span>
<span class="linenos">3033</span><span class="k">              </span><span class="n">ier</span><span class="o">=</span><span class="w"> </span><span class="n">NEWDATE</span><span class="p">(</span><span class="n">kstamp2</span><span class="p">,</span><span class="n">YMD_DATE</span><span class="p">,</span><span class="n">HM</span><span class="o">*</span><span class="mi">10000</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3034</span><span class="w">              </span><span class="k">do  </span><span class="n">JJ</span><span class="w"> </span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nval</span><span class="w"></span>
<span class="linenos">3035</span><span class="w">                </span><span class="n">OBSERV</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obsvalue</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">,</span><span class="n">jj</span><span class="p">:</span><span class="n">jj</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3036</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">BCOR2</span><span class="p">))</span><span class="w">  </span><span class="n">BiasCorrection2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BCOR2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">,</span><span class="n">jj</span><span class="p">:</span><span class="n">jj</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3037</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">qcflag</span><span class="p">))</span><span class="w"> </span><span class="n">QCFLAGS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qcflag</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">,</span><span class="n">jj</span><span class="p">:</span><span class="n">jj</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3038</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataQcFlag2</span><span class="p">))</span><span class="w"> </span><span class="n">dataQcFlagLEV</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataQcFlag2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3039</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataCloudFrac</span><span class="p">))</span><span class="w"> </span><span class="n">dataCloudFracLEV</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataCloudFrac</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3040</span>
<span class="linenos">3041</span><span class="w">                </span><span class="n">XLAT</span><span class="o">=</span><span class="n">HLAT</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span><span class="n">k</span><span class="p">);</span><span class="n">XLON</span><span class="o">=</span><span class="n">HLON</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span><span class="n">k</span><span class="p">);</span><span class="n">XTIME</span><span class="o">=</span><span class="n">HTIME</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3042</span><span class="w">                </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">XLON</span><span class="w">  </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">XLON</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">36</span><span class="mf">0.</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">XLON</span><span class="w"></span>
<span class="linenos">3043</span>
<span class="linenos">3044</span><span class="w">                </span><span class="n">XLAT</span><span class="o">=</span><span class="n">XLAT</span><span class="o">*</span><span class="n">MPC_RADIANS_PER_DEGREE_R8</span><span class="w"></span>
<span class="linenos">3045</span><span class="w">                </span><span class="n">XLON</span><span class="o">=</span><span class="n">XLON</span><span class="o">*</span><span class="n">MPC_RADIANS_PER_DEGREE_R8</span><span class="w"></span>
<span class="linenos">3046</span>
<span class="linenos">3047</span><span class="w">                </span><span class="k">call </span><span class="n">INCDATR</span><span class="p">(</span><span class="n">kstamp</span><span class="p">,</span><span class="w"> </span><span class="n">kstamp2</span><span class="p">,</span><span class="w"> </span><span class="n">XTIME</span><span class="o">/</span><span class="mi">6</span><span class="mf">0.d0</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3048</span><span class="w">                </span><span class="n">IER</span><span class="o">=</span><span class="n">newdate</span><span class="p">(</span><span class="n">kstamp</span><span class="p">,</span><span class="n">date2</span><span class="p">,</span><span class="n">time_sonde</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3049</span>
<span class="linenos">3050</span><span class="w">                </span><span class="n">time2</span><span class="o">=</span><span class="n">time_sonde</span><span class="o">/</span><span class="mi">10000</span><span class="w"></span>
<span class="linenos">3051</span>
<span class="linenos">3052</span><span class="w">                </span><span class="n">VCORD</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">VCOORD</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3053</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">BCOR</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3054</span><span class="k">                  </span><span class="n">NDATA</span><span class="o">=</span><span class="w"> </span><span class="n">WRITE_BODY</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">familytype</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">VCORD</span><span class="p">,</span><span class="n">vcoord_type</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3055</span><span class="w">                                    </span><span class="n">OBSERV</span><span class="p">,</span><span class="n">qcflags</span><span class="p">,</span><span class="n">NELE</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">LISTE_ELE</span><span class="p">,</span><span class="n">dataQcFlagLEV</span><span class="p">,</span><span class="n">dataCloudFracLEV</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3056</span><span class="w">                                    </span><span class="n">ROLAT</span><span class="p">,</span><span class="n">ROLON</span><span class="p">,</span><span class="w"> </span><span class="n">SURF_EMIS_opt</span><span class="o">=</span><span class="n">SURF_EMIS</span><span class="p">,</span><span class="w"> </span><span class="n">BiasCorrection_opt</span><span class="o">=</span><span class="n">BiasCorrection</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3057</span><span class="w">                </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">BCOR2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3058</span><span class="k">                  </span><span class="n">NDATA</span><span class="o">=</span><span class="w"> </span><span class="n">WRITE_BODY</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">familytype</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">VCORD</span><span class="p">,</span><span class="n">vcoord_type</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3059</span><span class="w">                                    </span><span class="n">OBSERV</span><span class="p">,</span><span class="n">qcflags</span><span class="p">,</span><span class="n">NELE</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">LISTE_ELE</span><span class="p">,</span><span class="n">dataQcFlagLEV</span><span class="p">,</span><span class="n">dataCloudFracLEV</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3060</span><span class="w">                                    </span><span class="n">ROLAT</span><span class="p">,</span><span class="n">ROLON</span><span class="p">,</span><span class="w"> </span><span class="n">SURF_EMIS_opt</span><span class="o">=</span><span class="n">SURF_EMIS</span><span class="p">,</span><span class="w"> </span><span class="n">BiasCorrection_opt</span><span class="o">=</span><span class="n">BiasCorrection2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3061</span><span class="w">                </span><span class="k">else</span>
<span class="linenos">3062</span><span class="k">                  </span><span class="n">NDATA</span><span class="o">=</span><span class="w"> </span><span class="n">WRITE_BODY</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">familytype</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">VCORD</span><span class="p">,</span><span class="n">vcoord_type</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3063</span><span class="w">                                    </span><span class="n">OBSERV</span><span class="p">,</span><span class="n">qcflags</span><span class="p">,</span><span class="n">NELE</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">LISTE_ELE</span><span class="p">,</span><span class="n">dataQcFlagLEV</span><span class="p">,</span><span class="n">dataCloudFracLEV</span><span class="p">,</span><span class="w"> </span><span class="n">ROLAT</span><span class="p">,</span><span class="n">ROLON</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3064</span><span class="w">                                    </span><span class="n">SURF_EMIS_opt</span><span class="o">=</span><span class="n">SURF_EMIS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3065</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">3066</span>
<span class="linenos">3067</span><span class="k">                IF</span><span class="w"> </span><span class="p">(</span><span class="n">NDATA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3068</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">phasePresent</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3069</span><span class="k">                    call </span><span class="n">WRITE_HEADER</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">STNID</span><span class="p">,</span><span class="n">XLAT</span><span class="p">,</span><span class="n">XLON</span><span class="p">,</span><span class="n">date2</span><span class="p">,</span><span class="n">time2</span><span class="p">,</span><span class="n">idtyp</span><span class="p">,</span><span class="n">STATUS</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">FILENUMB</span><span class="p">,</span><span class="n">phase</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3070</span><span class="w">                  </span><span class="k">else</span>
<span class="linenos">3071</span><span class="k">                    call </span><span class="n">WRITE_HEADER</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">STNID</span><span class="p">,</span><span class="n">XLAT</span><span class="p">,</span><span class="n">XLON</span><span class="p">,</span><span class="n">date2</span><span class="p">,</span><span class="n">time2</span><span class="p">,</span><span class="n">idtyp</span><span class="p">,</span><span class="n">STATUS</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">FILENUMB</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3072</span><span class="w">                  </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">3073</span><span class="c">!==================================================================================</span>
<span class="linenos">3074</span><span class="c">!</span>
<span class="linenos">3075</span><span class="c">! Ajoute qivals dans les argument de WRITE_QI</span>
<span class="linenos">3076</span>
<span class="linenos">3077</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;SW&#39;</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">READ_QI_GA_MT_SW</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">WRITE_QI</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">QI1VAL</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">QI2VAL</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">MTVAL</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">LSVAL</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">HAVAL</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">GAVAL</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3078</span>
<span class="linenos">3079</span><span class="w">                  </span><span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familytype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;AL&#39;</span><span class="p">)</span><span class="k">call </span><span class="n">write_al</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="w"> </span><span class="n">azimuth</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3080</span>
<span class="linenos">3081</span><span class="w">                  </span><span class="n">OBSN</span><span class="o">=</span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3082</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">obs_prfl</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_PRFL</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">kk</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3083</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">obs_hdd</span><span class="p">))</span><span class="w">  </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_HDD</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">date_h</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3084</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">obs_hdt</span><span class="p">))</span><span class="w">  </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_HDT</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">hhmm_h</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3085</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">obs_tflg</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_TFLG</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">hiresTimeFlag</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3086</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">obs_lflg</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LFLG</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">hiresLatFlag</span><span class="p">(</span><span class="n">jj</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3087</span><span class="w">                  </span><span class="k">call </span><span class="n">obs_setFamily</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">),</span><span class="w"> </span><span class="n">OBSN</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3088</span><span class="w">                  </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_NLV</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">NDATA</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3089</span><span class="w">                  </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">OBSN</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3090</span><span class="k">                    </span><span class="n">LN</span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_NLV</span><span class="p">,</span><span class="n">OBSN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3091</span><span class="w">                    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">LN</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3092</span><span class="w">                  </span><span class="k">ELSE</span>
<span class="linenos">3093</span><span class="k">                    call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3094</span><span class="w">                  </span><span class="k">END IF</span><span class="w"></span>
<span class="linenos">3095</span>
<span class="linenos">3096</span><span class="w">                  </span><span class="c">! write info block to header (same values for all headers associated with report)</span>
<span class="linenos">3097</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TRINFO</span><span class="p">))</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">3098</span><span class="k">                    call </span><span class="n">writeInfo</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">familytype</span><span class="p">,</span><span class="w"> </span><span class="n">TRINFO</span><span class="p">,</span><span class="n">LISTE_INFO</span><span class="p">,</span><span class="n">NELE_INFO</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3099</span><span class="w">                  </span><span class="k">else</span>
<span class="linenos">3100</span><span class="k">                    call </span><span class="n">setInfoToMissing</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3101</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">3102</span>
<span class="linenos">3103</span><span class="k">                END IF</span>
<span class="linenos">3104</span>
<span class="linenos">3105</span><span class="k">              end do</span>
<span class="linenos">3106</span>
<span class="linenos">3107</span><span class="k">            END IF</span>
<span class="linenos">3108</span>
<span class="linenos">3109</span><span class="k">          ELSE</span><span class="w">  </span><span class="c">! not HIRES</span>
<span class="linenos">3110</span>
<span class="linenos">3111</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">EMIS</span><span class="p">))</span><span class="w"> </span><span class="n">SURF_EMIS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">)</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">EMIS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3112</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">BCOR</span><span class="p">))</span><span class="w"> </span><span class="n">BiasCorrection</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BCOR</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3113</span><span class="w">            </span><span class="n">NDATA</span><span class="w">   </span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3114</span><span class="w">            </span><span class="n">NDATA_SF</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3115</span><span class="w">            </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">obsvalue_sfc</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3116</span><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">HIRES_SFC</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3117</span><span class="k">                </span><span class="n">XLAT</span><span class="o">=</span><span class="n">HLAT_SFC</span><span class="p">(</span><span class="n">k</span><span class="p">);</span><span class="n">XLON</span><span class="o">=</span><span class="n">HLON_SFC</span><span class="p">(</span><span class="n">k</span><span class="p">);</span><span class="n">XTIME</span><span class="o">=</span><span class="n">HTIME_SFC</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3118</span><span class="w">                </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">XLON</span><span class="w">  </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">XLON</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">36</span><span class="mf">0.</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">XLON</span><span class="w"></span>
<span class="linenos">3119</span><span class="w">                </span><span class="n">ier</span><span class="o">=</span><span class="w"> </span><span class="n">NEWDATE</span><span class="p">(</span><span class="n">kstamp2</span><span class="p">,</span><span class="n">YMD_DATE</span><span class="p">,</span><span class="n">HM</span><span class="o">*</span><span class="mi">10000</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3120</span><span class="w">                </span><span class="n">XLAT</span><span class="o">=</span><span class="n">XLAT</span><span class="o">*</span><span class="n">MPC_RADIANS_PER_DEGREE_R8</span><span class="w"></span>
<span class="linenos">3121</span><span class="w">                </span><span class="n">XLON</span><span class="o">=</span><span class="n">XLON</span><span class="o">*</span><span class="n">MPC_RADIANS_PER_DEGREE_R8</span><span class="w"></span>
<span class="linenos">3122</span>
<span class="linenos">3123</span><span class="w">                </span><span class="k">call </span><span class="n">INCDATR</span><span class="p">(</span><span class="n">kstamp</span><span class="p">,</span><span class="w"> </span><span class="n">kstamp2</span><span class="p">,</span><span class="w"> </span><span class="n">XTIME</span><span class="o">/</span><span class="mi">6</span><span class="mf">0.d0</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3124</span><span class="w">                </span><span class="n">IER</span><span class="o">=</span><span class="n">newdate</span><span class="p">(</span><span class="n">kstamp</span><span class="p">,</span><span class="n">date2</span><span class="p">,</span><span class="n">time_sonde</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3125</span><span class="w">                </span><span class="n">time2</span><span class="o">=</span><span class="n">time_sonde</span><span class="o">/</span><span class="mi">10000</span><span class="w"></span>
<span class="linenos">3126</span><span class="w">                </span><span class="n">YMD_DATE</span><span class="o">=</span><span class="n">date2</span><span class="w"></span>
<span class="linenos">3127</span><span class="w">                </span><span class="n">HM</span><span class="o">=</span><span class="n">time2</span><span class="w"></span>
<span class="linenos">3128</span><span class="w">              </span><span class="k">END IF</span>
<span class="linenos">3129</span>
<span class="linenos">3130</span><span class="k">              </span><span class="n">OBSERV_SFC</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obsvalue_sfc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3131</span><span class="w">              </span><span class="n">QCFLAGS_sfc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qcflag_sfc</span><span class="w">  </span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3132</span><span class="w">              </span><span class="n">BCOR_SFC</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BiasCorrection_sfc</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3133</span>
<span class="linenos">3134</span><span class="w">              </span><span class="c">! dataQcFlagLev does not exist for surface data</span>
<span class="linenos">3135</span><span class="w">              </span><span class="n">dataQcFlagLev_sfc</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3136</span><span class="w">              </span><span class="n">dataCloudFracLev_sfc</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3137</span>
<span class="linenos">3138</span><span class="w">              </span><span class="n">NDATA_SF</span><span class="o">=</span><span class="w"> </span><span class="n">WRITE_BODY</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">UNI_FAMILYTYPE</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">vcoord_sfc</span><span class="p">,</span><span class="n">vcoord_type</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3139</span><span class="w">                                   </span><span class="n">OBSERV_sfc</span><span class="p">,</span><span class="n">qcflags_sfc</span><span class="p">,</span><span class="n">NELE_SFC</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">LISTE_ELE_SFC</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3140</span><span class="w">                                   </span><span class="n">dataQcFlagLEV_sfc</span><span class="p">,</span><span class="n">dataCloudFracLev_sfc</span><span class="p">,</span><span class="w"> </span><span class="n">ROLAT</span><span class="p">,</span><span class="n">ROLON</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3141</span><span class="w">                                   </span><span class="n">BiasCorrection_opt</span><span class="o">=</span><span class="n">BCOR_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3142</span>
<span class="linenos">3143</span><span class="w">              </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">NDATA_SF</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3144</span><span class="k">                call </span><span class="n">WRITE_HEADER</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">STNID</span><span class="p">,</span><span class="n">XLAT</span><span class="p">,</span><span class="n">XLON</span><span class="p">,</span><span class="n">YMD_DATE</span><span class="p">,</span><span class="n">HM</span><span class="p">,</span><span class="n">idtyp</span><span class="p">,</span><span class="n">STATUS</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">FILENUMB</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3145</span><span class="w">                </span><span class="n">OBSN</span><span class="o">=</span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">3146</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">obs_prfl</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_PRFL</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">kk</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3147</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">obs_hdd</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_HDD</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">date_h</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3148</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">obs_hdt</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_HDT</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">hhmm_h</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3149</span><span class="w">                </span><span class="k">call </span><span class="n">obs_setFamily</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">),</span><span class="w"> </span><span class="n">OBSN</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3150</span><span class="w">                </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_NLV</span><span class="w"> </span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">NDATA_SF</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3151</span><span class="w">                </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">OBSN</span><span class="w">  </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3152</span><span class="k">                  </span><span class="n">LN</span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_NLV</span><span class="p">,</span><span class="n">OBSN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3153</span><span class="w">                  </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">LN</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3154</span><span class="w">                </span><span class="k">ELSE</span>
<span class="linenos">3155</span><span class="k">                  call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3156</span><span class="w">                </span><span class="k">END IF</span>
<span class="linenos">3157</span><span class="k">              END IF</span>
<span class="linenos">3158</span><span class="k">            END IF</span>
<span class="linenos">3159</span><span class="k">          </span>
<span class="linenos">3160</span><span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">obsvalue</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3161</span><span class="k">              </span><span class="n">OBSERV</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obsvalue</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3162</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">BCOR2</span><span class="p">))</span><span class="w">  </span><span class="n">BiasCorrection2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BCOR2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3163</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">qcflag</span><span class="p">))</span><span class="w"> </span><span class="n">QCFLAGS</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qcflag</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NELE</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3164</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataQcFlag2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3165</span><span class="k">                </span><span class="n">dataQcFlagLEV</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataQcFlag2</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3166</span><span class="w">              </span><span class="k">else</span>
<span class="linenos">3167</span><span class="k">                if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataQcFlagLev</span><span class="p">))</span><span class="w"> </span><span class="k">allocate</span><span class="p">(</span><span class="n">dataQcFlagLEV</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3168</span><span class="w">                </span><span class="n">dataQcFlagLEV</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3169</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">3170</span><span class="k">              if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataCloudFrac</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3171</span><span class="k">                </span><span class="n">dataCloudFracLEV</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dataCloudFrac</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3172</span><span class="w">              </span><span class="k">else</span>
<span class="linenos">3173</span><span class="k">                if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataCloudFracLev</span><span class="p">))</span><span class="w"> </span><span class="k">allocate</span><span class="p">(</span><span class="n">dataCloudFracLEV</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3174</span><span class="w">                </span><span class="n">dataCloudFracLEV</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3175</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">3176</span>
<span class="linenos">3177</span><span class="k">              </span><span class="n">VCORD</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">VCOORD</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">NVAL</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3178</span>
<span class="linenos">3179</span><span class="w">              </span><span class="c">!CASES DEPENDING ON WETHER ON NOT WE HAVE MW DATA</span>
<span class="linenos">3180</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">BCOR</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3181</span><span class="k">                </span><span class="n">NDATA</span><span class="o">=</span><span class="w"> </span><span class="n">WRITE_BODY</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">familytype</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">VCORD</span><span class="p">,</span><span class="n">vcoord_type</span><span class="p">,</span><span class="n">OBSERV</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3182</span><span class="w">                                  </span><span class="n">qcflags</span><span class="p">,</span><span class="n">NELE</span><span class="p">,</span><span class="n">NVAL</span><span class="p">,</span><span class="n">LISTE_ELE</span><span class="p">,</span><span class="n">dataQcFlagLEV</span><span class="p">,</span><span class="n">dataCloudFracLEV</span><span class="p">,</span><span class="n">ROLAT</span><span class="p">,</span><span class="n">ROLON</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3183</span><span class="w">                                  </span><span class="n">SURF_EMIS_opt</span><span class="o">=</span><span class="n">SURF_EMIS</span><span class="p">,</span><span class="n">BiasCorrection_opt</span><span class="o">=</span><span class="n">BiasCorrection</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3184</span><span class="w">              </span><span class="n">elseif</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">BCOR2</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3185</span><span class="k">                </span><span class="n">NDATA</span><span class="o">=</span><span class="w"> </span><span class="n">WRITE_BODY</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">familytype</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">VCORD</span><span class="p">,</span><span class="n">vcoord_type</span><span class="p">,</span><span class="n">OBSERV</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3186</span><span class="w">                                  </span><span class="n">qcflags</span><span class="p">,</span><span class="n">NELE</span><span class="p">,</span><span class="n">NVAL</span><span class="p">,</span><span class="n">LISTE_ELE</span><span class="p">,</span><span class="n">dataQcFlagLEV</span><span class="p">,</span><span class="n">dataCloudFracLEV</span><span class="p">,</span><span class="w"> </span><span class="n">ROLAT</span><span class="p">,</span><span class="n">ROLON</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3187</span><span class="w">                                  </span><span class="n">SURF_EMIS_opt</span><span class="o">=</span><span class="n">SURF_EMIS</span><span class="p">,</span><span class="n">BiasCorrection_opt</span><span class="o">=</span><span class="n">BiasCorrection2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3188</span><span class="w">              </span><span class="k">else</span>
<span class="linenos">3189</span><span class="k">                </span><span class="n">NDATA</span><span class="o">=</span><span class="w"> </span><span class="n">WRITE_BODY</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">familytype</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">VCORD</span><span class="p">,</span><span class="n">vcoord_type</span><span class="p">,</span><span class="n">OBSERV</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3190</span><span class="w">                                  </span><span class="n">qcflags</span><span class="p">,</span><span class="n">NELE</span><span class="p">,</span><span class="n">NVAL</span><span class="p">,</span><span class="n">LISTE_ELE</span><span class="p">,</span><span class="n">dataQcFlagLEV</span><span class="p">,</span><span class="n">dataCloudFracLEV</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3191</span><span class="w">                                  </span><span class="n">ROLAT</span><span class="p">,</span><span class="n">ROLON</span><span class="p">,</span><span class="w"> </span><span class="n">SURF_EMIS_opt</span><span class="o">=</span><span class="n">SURF_EMIS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3192</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">3193</span><span class="k">              </span>
<span class="linenos">3194</span><span class="k">              IF</span><span class="w"> </span><span class="p">(</span><span class="n">NDATA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3195</span>
<span class="linenos">3196</span><span class="k">                IF</span><span class="w"> </span><span class="p">(</span><span class="n">NDATA_SF</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3197</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">phasePresent</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3198</span><span class="k">                    call </span><span class="n">WRITE_HEADER</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">STNID</span><span class="p">,</span><span class="n">XLAT</span><span class="p">,</span><span class="n">XLON</span><span class="p">,</span><span class="n">YMD_DATE</span><span class="p">,</span><span class="n">HM</span><span class="p">,</span><span class="n">idtyp</span><span class="p">,</span><span class="n">STATUS</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">FILENUMB</span><span class="p">,</span><span class="n">phase</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3199</span><span class="w">                  </span><span class="k">else</span>
<span class="linenos">3200</span><span class="k">                    call </span><span class="n">WRITE_HEADER</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">STNID</span><span class="p">,</span><span class="n">XLAT</span><span class="p">,</span><span class="n">XLON</span><span class="p">,</span><span class="n">YMD_DATE</span><span class="p">,</span><span class="n">HM</span><span class="p">,</span><span class="n">idtyp</span><span class="p">,</span><span class="n">STATUS</span><span class="p">,</span><span class="n">RELEV</span><span class="p">,</span><span class="n">FILENUMB</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3201</span><span class="w">                  </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">3202</span><span class="w">                 </span>
<span class="linenos">3203</span><span class="c">!==================================================================================</span>
<span class="linenos">3204</span><span class="c">!</span>
<span class="linenos">3205</span><span class="c">! Ajoute qivals dans les argument de WRITE_QI</span>
<span class="linenos">3206</span>
<span class="linenos">3207</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">TRIM</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;SW&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">WRITE_QI</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">QI1VAL</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">QI2VAL</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">MTVAL</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">LSVAL</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">HAVAL</span><span class="p">(</span><span class="n">k</span><span class="p">),</span><span class="n">GAVAL</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3208</span>
<span class="linenos">3209</span><span class="w">                  </span><span class="k">if</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familytype</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;AL&#39;</span><span class="p">)</span><span class="k">call </span><span class="n">write_al</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="w"> </span><span class="n">azimuth</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3210</span>
<span class="linenos">3211</span><span class="w">                  </span><span class="n">OBSN</span><span class="o">=</span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">3212</span><span class="w">                  </span><span class="k">call </span><span class="n">obs_setFamily</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMILYTYPE</span><span class="p">),</span><span class="w"> </span><span class="n">OBSN</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3213</span><span class="w">                </span><span class="k">END IF</span>
<span class="linenos">3214</span><span class="k">                </span><span class="n">OBSN</span><span class="o">=</span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">3215</span><span class="w">                </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_NLV</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">NDATA</span><span class="o">+</span><span class="n">NDATA_SF</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3216</span><span class="w">                </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">OBSN</span><span class="w">   </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3217</span><span class="k">                  </span><span class="n">LN</span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_NLV</span><span class="p">,</span><span class="n">OBSN</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3218</span><span class="w">                  </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">LN</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3219</span><span class="w">                </span><span class="k">ELSE</span>
<span class="linenos">3220</span><span class="k">                  call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3221</span><span class="w">                </span><span class="k">END IF</span>
<span class="linenos">3222</span>
<span class="linenos">3223</span><span class="k">              END IF</span>
<span class="linenos">3224</span>
<span class="linenos">3225</span><span class="k">            END IF</span><span class="w"></span>
<span class="linenos">3226</span>
<span class="linenos">3227</span><span class="w">            </span><span class="c">!============ IASI =====================================</span>
<span class="linenos">3228</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">RADMOY</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">NDATA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3229</span><span class="k">              </span><span class="n">OBSN</span><span class="o">=</span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3230</span>
<span class="linenos">3231</span><span class="w">              </span><span class="n">iclass</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3232</span><span class="w">              </span><span class="k">do </span><span class="n">iobs</span><span class="o">=</span><span class="n">OBS_CF1</span><span class="p">,</span><span class="n">OBS_CF7</span><span class="w"></span>
<span class="linenos">3233</span><span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">iobs</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3234</span><span class="k">                  call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">iobs</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">CFRAC</span><span class="p">(</span><span class="n">iclass</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3235</span><span class="w">                  </span><span class="n">iclass</span><span class="o">=</span><span class="n">iclass</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3236</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">3237</span><span class="k">              end do</span>
<span class="linenos">3238</span>
<span class="linenos">3239</span><span class="k">              </span><span class="n">iclass</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3240</span><span class="w">              </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3241</span><span class="w">              </span><span class="k">do </span><span class="n">iobs</span><span class="o">=</span><span class="n">OBS_M1C1</span><span class="p">,</span><span class="n">OBS_M7C6</span><span class="w"></span>
<span class="linenos">3242</span><span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">iobs</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3243</span><span class="k">                  call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">iobs</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">RADMOY</span><span class="p">(</span><span class="n">iclass</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3244</span><span class="w">                  </span><span class="n">ichan</span><span class="o">=</span><span class="n">ichan</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3245</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ichan</span><span class="o">&gt;</span><span class="n">obs_getNchanAvhrr</span><span class="p">())</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3246</span><span class="k">                    </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3247</span><span class="w">                    </span><span class="n">iclass</span><span class="o">=</span><span class="n">iclass</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3248</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">3249</span><span class="k">                end if</span>
<span class="linenos">3250</span><span class="k">              end do</span>
<span class="linenos">3251</span>
<span class="linenos">3252</span><span class="k">              </span><span class="n">iclass</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3253</span><span class="w">              </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3254</span><span class="w">              </span><span class="k">do </span><span class="n">iobs</span><span class="o">=</span><span class="n">OBS_S1C1</span><span class="p">,</span><span class="n">OBS_S7C6</span><span class="w"></span>
<span class="linenos">3255</span><span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">iobs</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3256</span><span class="k">                  call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">iobs</span><span class="p">,</span><span class="n">OBSN</span><span class="p">,</span><span class="n">radstd</span><span class="p">(</span><span class="n">iclass</span><span class="p">,</span><span class="n">ichan</span><span class="p">,</span><span class="n">k</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3257</span><span class="w">                  </span><span class="n">ichan</span><span class="o">=</span><span class="n">ichan</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3258</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ichan</span><span class="o">&gt;</span><span class="n">obs_getNchanAvhrr</span><span class="p">())</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3259</span><span class="k">                    </span><span class="n">ichan</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3260</span><span class="w">                    </span><span class="n">iclass</span><span class="o">=</span><span class="n">iclass</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3261</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">3262</span><span class="k">                end if</span>
<span class="linenos">3263</span><span class="k">              end do</span>
<span class="linenos">3264</span>
<span class="linenos">3265</span><span class="k">            end if</span><span class="w"></span>
<span class="linenos">3266</span><span class="w">            </span><span class="c">!============ IASI =====================================</span>
<span class="linenos">3267</span>
<span class="linenos">3268</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3269</span>
<span class="linenos">3270</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">TRINFO</span><span class="p">))</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">3271</span><span class="k">            IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">NDATA</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.</span><span class="nb">or</span><span class="p">.</span><span class="n">NDATA_SF</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3272</span><span class="k">              call </span><span class="n">writeInfo</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">familytype</span><span class="p">,</span><span class="w"> </span><span class="n">TRINFO</span><span class="p">,</span><span class="n">LISTE_INFO</span><span class="p">,</span><span class="n">NELE_INFO</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3273</span><span class="w">            </span><span class="k">END IF</span>
<span class="linenos">3274</span><span class="k">          end if</span>
<span class="linenos">3275</span>
<span class="linenos">3276</span><span class="k">        end do</span><span class="w"></span>
<span class="linenos">3277</span>
<span class="linenos">3278</span><span class="w">        </span><span class="c">!---------UPPER AIR---------------------------</span>
<span class="linenos">3279</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">obsvalue</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3280</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obsvalue</span><span class="p">,</span><span class="n">VCOORD</span><span class="p">,</span><span class="n">VCORD</span><span class="p">,</span><span class="n">observ</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3281</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3282</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">qcflag</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3283</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">qcflag</span><span class="p">,</span><span class="n">qcflags</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3284</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3285</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">hiresTimeFlag</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3286</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">hiresTimeFlag</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3287</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3288</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">hiresLatFlag</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3289</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">hiresLatFlag</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3290</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3291</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">qi1val</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3292</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">qi1val</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3293</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3294</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">qi2val</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3295</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">qi2val</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3296</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3297</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">mtval</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3298</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">mtval</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3299</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3300</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">lsval</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3301</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">lsval</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3302</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3303</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">haval</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3304</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">haval</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3305</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3306</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">gaval</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3307</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">gaval</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3308</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3309</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">EMIS</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3310</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">EMIS</span><span class="p">,</span><span class="n">SURF_EMIS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3311</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3312</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataQcFlag2</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3313</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">dataQcFlag2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3314</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3315</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataQcFlagLEV</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3316</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">dataQcFlagLEV</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3317</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3318</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataCloudFrac</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3319</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">dataCloudFrac</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3320</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3321</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">dataCloudFracLEV</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3322</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">dataCloudFracLEV</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3323</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3324</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">azimuth</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3325</span><span class="k">          deallocate</span><span class="p">(</span><span class="n">azimuth</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3326</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3327</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">BCOR</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3328</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">BCOR</span><span class="p">,</span><span class="n">BiasCorrection</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3329</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3330</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">BCOR2</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3331</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">BCOR2</span><span class="p">,</span><span class="n">BiasCorrection2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3332</span><span class="w">        </span><span class="k">end if</span><span class="w">        </span>
<span class="linenos">3333</span>
<span class="linenos">3334</span><span class="w">        </span><span class="c">!---------SURFACE-----------------------------</span>
<span class="linenos">3335</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">obsvalue_sfc</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3336</span><span class="k">          DEallocate</span><span class="p">(</span><span class="n">obsvalue_sfc</span><span class="p">,</span><span class="n">vcoord_sfc</span><span class="p">,</span><span class="n">OBSERV_SFC</span><span class="p">,</span><span class="n">BiasCorrection_sfc</span><span class="p">,</span><span class="n">BCOR_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3337</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3338</span>
<span class="linenos">3339</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">qcflag_sfc</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3340</span><span class="k">          DEallocate</span><span class="p">(</span><span class="w">  </span><span class="n">qcflag_sfc</span><span class="p">,</span><span class="w"> </span><span class="n">qcflags_SFC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3341</span><span class="w">        </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">3342</span><span class="w">        </span><span class="c">!--------SURFACE------------------------------</span>
<span class="linenos">3343</span><span class="w">        </span>
<span class="linenos">3344</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="nb">allocated</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3345</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">lat</span><span class="p">,</span><span class="n">lon</span><span class="p">,</span><span class="n">date</span><span class="p">,</span><span class="n">hhmm</span><span class="p">,</span><span class="n">glbflag</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3346</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3347</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="nb">allocated</span><span class="p">(</span><span class="n">hlat</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3348</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">hlat</span><span class="p">,</span><span class="n">hlon</span><span class="p">,</span><span class="n">htime</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3349</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3350</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="nb">allocated</span><span class="p">(</span><span class="n">hlat_sfc</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3351</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">hlat_sfc</span><span class="p">,</span><span class="n">hlon_sfc</span><span class="p">,</span><span class="n">htime_sfc</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3352</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3353</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">rinfo</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3354</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">rinfo</span><span class="p">,</span><span class="n">trinfo</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3355</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3356</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">RADMOY</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3357</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">RADMOY</span><span class="p">,</span><span class="n">CFRAC</span><span class="p">,</span><span class="n">radstd</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3358</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3359</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3360</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3361</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3362</span>
<span class="linenos">3363</span>
<span class="linenos">3364</span><span class="k">      end do </span><span class="n">REPORTS</span><span class="w"></span>
<span class="linenos">3365</span>
<span class="linenos">3366</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">3367</span>
<span class="linenos">3368</span><span class="k">    Deallocate</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3369</span>
<span class="linenos">3370</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag_passage1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3371</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3372</span><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39; descriptor block for grouped data present &#39;</span><span class="w"></span>
<span class="linenos">3373</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">3374</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag_passage2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3375</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3376</span><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;- info block Present &#39;</span><span class="w"></span>
<span class="linenos">3377</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">3378</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag_passage3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3379</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3380</span><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ERROR - observation block not seen ? Verify btyp&#39;</span><span class="w"></span>
<span class="linenos">3381</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">3382</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag_passage4</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3383</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3384</span><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ERROR - flag block not seen ? Verify btyp&#39;</span><span class="w"></span>
<span class="linenos">3385</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">3386</span>
<span class="linenos">3387</span><span class="k">    call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">3388</span>
<span class="linenos">3389</span><span class="w">    </span><span class="n">numHeader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3390</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39; file   Nobs SUM = &#39;</span><span class="p">,</span><span class="nb">trim</span><span class="p">(</span><span class="n">brp_file</span><span class="p">),</span><span class="n">numHeader</span><span class="p">,</span><span class="nb">SUM</span>
<span class="linenos">3391</span>
<span class="linenos">3392</span><span class="nb">  </span><span class="k">contains</span><span class="w"></span>
<span class="linenos">3393</span>
<span class="linenos">3394</span><span class="w">    </span><span class="c">!--------- cleanup -----</span>
<span class="linenos">3395</span><span class="w">    </span><span class="k">subroutine </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">3396</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">3397</span><span class="k">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errors</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3398</span>
<span class="linenos">3399</span><span class="w">      </span><span class="n">errors</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3400</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">address</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3401</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">File_in</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3402</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Rpt_in</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3403</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">Block_in</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3404</span><span class="w">      </span><span class="c">!Should we abort here ?</span>
<span class="linenos">3405</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">errors</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;brpr_readBurp: error while deallocating memory: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">3406</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">cleanup</span><span class="w"></span>
<span class="linenos">3407</span>
<span class="linenos">3408</span><span class="w">    </span><span class="c">!--------- handle_error -----</span>
<span class="linenos">3409</span><span class="w">    </span><span class="k">subroutine </span><span class="n">handle_error</span><span class="p">(</span><span class="n">icode</span><span class="p">,</span><span class="n">errormessage</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3410</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">3411</span><span class="k">      </span><span class="kt">character</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errormessage</span><span class="w"></span>
<span class="linenos">3412</span><span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">3413</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icode</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">burp_noerr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3414</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;error code&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">3415</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">BURP_STR_ERROR</span><span class="p">()</span><span class="w"></span>
<span class="linenos">3416</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;history&quot;</span><span class="w"></span>
<span class="linenos">3417</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_STR_ERROR_HISTORY</span><span class="p">()</span><span class="w"></span>
<span class="linenos">3418</span><span class="w">        </span><span class="k">call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">3419</span><span class="w">        </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">errormessage</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3420</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">3421</span><span class="k">    end subroutine </span><span class="n">handle_error</span><span class="w"></span>
<span class="linenos">3422</span>
<span class="linenos">3423</span><span class="w">  </span><span class="k">end subroutine </span><span class="n">brpr_readBurp</span><span class="w"></span>
<span class="linenos">3424</span>
<span class="linenos">3425</span>
<span class="linenos">3426</span><span class="w">  </span><span class="k">FUNCTION </span><span class="n">WRITE_BODY</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">FAMTYP</span><span class="p">,</span><span class="w"> </span><span class="n">ELEV</span><span class="p">,</span><span class="n">VERTCOORD</span><span class="p">,</span><span class="n">VCOORD_TYPE</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3427</span><span class="w">                      </span><span class="n">obsvalue</span><span class="p">,</span><span class="n">qcflag</span><span class="p">,</span><span class="n">NELE</span><span class="p">,</span><span class="n">NVAL</span><span class="p">,</span><span class="n">LISTE_ELE</span><span class="p">,</span><span class="n">dataQcFlagLEV</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3428</span><span class="w">                      </span><span class="n">dataCloudFracLEV</span><span class="p">,</span><span class="w"> </span><span class="n">ROLAT</span><span class="p">,</span><span class="n">ROLON</span><span class="p">,</span><span class="w"> </span><span class="n">SURF_EMIS_opt</span><span class="p">,</span><span class="n">BiasCorrection_opt</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3429</span>
<span class="linenos">3430</span><span class="w">    </span><span class="k">implicit none</span><span class="w"></span>
<span class="linenos">3431</span>
<span class="linenos">3432</span><span class="w">    </span><span class="c">! Arguments:</span>
<span class="linenos">3433</span><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="p">(</span><span class="n">struct_obs</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">obsdat</span><span class="w"></span>
<span class="linenos">3434</span><span class="w">    </span><span class="kt">INTEGER</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">WRITE_BODY</span><span class="p">,</span><span class="n">VCOORD_TYPE</span><span class="w"></span>
<span class="linenos">3435</span><span class="w">    </span><span class="kt">REAL</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">          </span><span class="kd">::</span><span class="w">  </span><span class="n">OBSVALUE</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">3436</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">          </span><span class="kd">::</span><span class="w">  </span><span class="n">QCFLAG</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">3437</span><span class="w">    </span><span class="kt">REAL</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">          </span><span class="kd">::</span><span class="w">  </span><span class="n">VERTCOORD</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">3438</span><span class="w">    </span><span class="kt">REAL</span><span class="w">                          </span><span class="kd">::</span><span class="w">  </span><span class="n">ROLAT</span><span class="p">(:),</span><span class="w"> </span><span class="n">ROLON</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">3439</span><span class="w">    </span><span class="kt">REAL</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">SURF_EMIS_opt</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">3440</span><span class="w">    </span><span class="kt">REAL</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w">  </span><span class="n">BiasCorrection_opt</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">3441</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">           </span><span class="kd">::</span><span class="w">  </span><span class="n">dataQcFlagLEV</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">3442</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">           </span><span class="kd">::</span><span class="w">  </span><span class="n">dataCloudFracLEV</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">3443</span>
<span class="linenos">3444</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">3445</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">FAMTYP</span><span class="w"></span>
<span class="linenos">3446</span><span class="w">    </span><span class="kt">REAL</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">ELEVFACT</span><span class="p">,</span><span class="n">VCOORD</span><span class="p">,</span><span class="n">ZEMFACT</span><span class="w"></span>
<span class="linenos">3447</span><span class="w">    </span><span class="kt">INTEGER</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">NELE</span><span class="p">,</span><span class="n">NVAL</span><span class="p">,</span><span class="n">VCO</span><span class="p">,</span><span class="n">NONELEV</span><span class="w"></span>
<span class="linenos">3448</span><span class="w">    </span><span class="kt">integer</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">LISTE_ELE</span><span class="p">(:),</span><span class="n">NOBS</span><span class="p">,</span><span class="n">VARNO</span><span class="p">,</span><span class="n">IL</span><span class="p">,</span><span class="n">J</span><span class="p">,</span><span class="nb">COUNT</span><span class="p">,</span><span class="n">NLV</span><span class="w"></span>
<span class="linenos">3449</span><span class="w">    </span><span class="kt">INTEGER</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">IFLAG</span><span class="p">,</span><span class="n">IFLAG2</span><span class="p">,</span><span class="n">cloudFrac</span><span class="w"></span>
<span class="linenos">3450</span><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">MISG</span><span class="p">,</span><span class="n">OBSV</span><span class="p">,</span><span class="n">ELEV</span><span class="p">,</span><span class="n">ELEV_R</span><span class="p">,</span><span class="n">REMIS</span><span class="p">,</span><span class="n">BCOR</span><span class="p">,</span><span class="n">rolat1</span><span class="p">,</span><span class="n">rolon1</span><span class="w"></span>
<span class="linenos">3451</span><span class="w">    </span><span class="kt">LOGICAL</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">L_EMISS</span><span class="p">,</span><span class="n">L_BCOR</span><span class="p">,</span><span class="n">L_dataQcFlag2</span><span class="p">,</span><span class="w"> </span><span class="n">L_dataCloudFrac</span><span class="w"></span>
<span class="linenos">3452</span><span class="w">    </span>
<span class="linenos">3453</span><span class="w">    </span><span class="n">L_EMISS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="w"> </span><span class="n">SURF_EMIS_opt</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3454</span><span class="w">    </span><span class="n">L_BCOR</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="w"> </span><span class="n">BiasCorrection_opt</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3455</span><span class="w">    </span><span class="n">L_dataQcFlag2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">any</span><span class="p">(</span><span class="n">dataQcFlagLEV</span><span class="p">(:)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3456</span><span class="w">    </span><span class="n">L_dataCloudFrac</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">any</span><span class="p">(</span><span class="n">dataCloudFracLEV</span><span class="p">(:)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3457</span>
<span class="linenos">3458</span><span class="w">    </span><span class="n">NONELEV</span><span class="w">  </span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3459</span><span class="w">    </span><span class="n">MISG</span><span class="o">=</span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">3460</span><span class="w">    </span><span class="n">ZEMFACT</span><span class="o">=</span><span class="mf">0.01</span><span class="w"></span>
<span class="linenos">3461</span>
<span class="linenos">3462</span><span class="w">    </span><span class="n">REMIS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MISG</span><span class="w"></span>
<span class="linenos">3463</span>
<span class="linenos">3464</span><span class="w">    </span><span class="n">NOBS</span><span class="w"> </span><span class="o">=</span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3465</span><span class="w">    </span><span class="nb">COUNT</span><span class="o">=</span><span class="n">obs_numBody</span><span class="w"> </span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3466</span>
<span class="linenos">3467</span><span class="w">    </span><span class="n">NLV</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3468</span>
<span class="linenos">3469</span><span class="c">! Special test for GB-GPS </span>
<span class="linenos">3470</span><span class="c">! Reports with missing ZTD cause problems with output of subsequent reports (missing OMP, OER, FLAG bits)</span>
<span class="linenos">3471</span><span class="c">! Since July 2019, reports with missing ZTD are removed in the GB-GPS dbase files.</span>
<span class="linenos">3472</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMTYP</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="s1">&#39;GP&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">3473</span><span class="k">      DO </span><span class="n">il</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"></span>
<span class="linenos">3474</span><span class="w">         </span><span class="n">varno</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LISTE_ELE</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3475</span><span class="w">         </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"></span>
<span class="linenos">3476</span><span class="w">            </span><span class="n">obsv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obsvalue</span><span class="p">(</span><span class="n">il</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3477</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">varno</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">15031</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">  </span><span class="n">obsv</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MISG</span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3478</span><span class="k">               print</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;write body: report rejected no ZTD&#39;</span><span class="w"></span>
<span class="linenos">3479</span><span class="w">               </span><span class="n">WRITE_BODY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NLV</span><span class="w"></span>
<span class="linenos">3480</span><span class="w">               </span><span class="k">return</span>
<span class="linenos">3481</span><span class="k">            endif</span>
<span class="linenos">3482</span><span class="k">         END DO</span>
<span class="linenos">3483</span><span class="k">      END DO</span>
<span class="linenos">3484</span><span class="k">    endif</span><span class="w"></span>
<span class="linenos">3485</span><span class="c">! Special test for GB-GPS</span>
<span class="linenos">3486</span>
<span class="linenos">3487</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMTYP</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="s1">&#39;PR&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMTYP</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="s1">&#39;SF&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMTYP</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="s1">&#39;GP&#39;</span><span class="p">)</span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3488</span><span class="k">      </span><span class="n">ELEVFACT</span><span class="o">=</span><span class="mf">1.</span><span class="w"></span>
<span class="linenos">3489</span><span class="w">    </span><span class="k">else</span>
<span class="linenos">3490</span><span class="k">      </span><span class="n">ELEVFACT</span><span class="o">=</span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">3491</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">3492</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMTYP</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="s1">&#39;TO&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">3493</span><span class="w">      </span><span class="c">!ELEV=0.</span>
<span class="linenos">3494</span><span class="w">    </span><span class="k">END IF</span>
<span class="linenos">3495</span>
<span class="linenos">3496</span><span class="k">    SELECT CASE</span><span class="p">(</span><span class="n">FAMTYP</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3497</span><span class="w">      </span><span class="k">CASE</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;UA&#39;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SW&#39;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;AI&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3498</span><span class="w">        </span><span class="n">VCO</span><span class="o">=</span><span class="mi">2</span><span class="w"> </span><span class="c">! PRESSURE COORD</span>
<span class="linenos">3499</span><span class="w">      </span><span class="k">CASE</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;SF&#39;</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;SC&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PR&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;RO&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;GP&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;AL&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3500</span><span class="w">        </span><span class="n">VCO</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="c">! HEIGHT COORD</span>
<span class="linenos">3501</span><span class="w">      </span><span class="k">CASE</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;TO&#39;</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3502</span><span class="w">        </span><span class="n">VCO</span><span class="o">=</span><span class="mi">3</span><span class="w"> </span><span class="c">! CHANNEL NUMBER</span>
<span class="linenos">3503</span><span class="w">      </span><span class="k">CASE</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="s1">&#39;CH&#39;</span><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="c">! CONSTITUENTS (consider different possibilities)</span>
<span class="linenos">3504</span><span class="w">        </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">VCOORD_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7006</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">VCOORD_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7007</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3505</span><span class="k">           </span><span class="n">VCO</span><span class="o">=</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3506</span><span class="w">           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">VCOORD_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7006</span><span class="p">)</span><span class="w"> </span><span class="n">ELEVFACT</span><span class="o">=</span><span class="mf">1.0</span><span class="w"></span>
<span class="linenos">3507</span><span class="w">        </span><span class="k">ELSE IF</span><span class="w"> </span><span class="p">(</span><span class="n">VCOORD_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7004</span><span class="w"> </span><span class="p">.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="n">VCOORD_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">7204</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3508</span><span class="k">           </span><span class="n">VCO</span><span class="o">=</span><span class="mi">2</span><span class="w"></span>
<span class="linenos">3509</span><span class="w">        </span><span class="k">ELSE IF</span><span class="w"> </span><span class="p">(</span><span class="n">VCOORD_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">2150</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3510</span><span class="k">           </span><span class="n">VCO</span><span class="o">=</span><span class="mi">3</span><span class="w"></span>
<span class="linenos">3511</span><span class="w">        </span><span class="k">ELSE</span><span class="w">            </span>
<span class="linenos">3512</span><span class="w">           </span><span class="c">! Vertical coordinate not provided or not recognized.</span>
<span class="linenos">3513</span><span class="w">           </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">NVAL</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3514</span><span class="k">              </span><span class="n">VCO</span><span class="o">=</span><span class="mi">5</span><span class="w"> </span><span class="c">! Initializes as surface point measurement</span>
<span class="linenos">3515</span><span class="w">              </span><span class="k">DO </span><span class="n">il</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"></span>
<span class="linenos">3516</span><span class="w">                 </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obsvalue</span><span class="p">(</span><span class="n">il</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3517</span><span class="k">                    if</span><span class="w"> </span><span class="p">(</span><span class="n">liste_ele</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1519</span><span class="mf">8.</span><span class="nb">OR</span><span class="p">.</span><span class="n">liste_ele</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1500</span><span class="mf">9.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3518</span><span class="w">                        </span><span class="n">liste_ele</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1502</span><span class="mf">0.</span><span class="nb">OR</span><span class="p">.</span><span class="n">liste_ele</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1502</span><span class="mf">1.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3519</span><span class="w">                        </span><span class="n">liste_ele</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1502</span><span class="mf">4.</span><span class="nb">OR</span><span class="p">.</span><span class="n">liste_ele</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1520</span><span class="mf">0.</span><span class="nb">OR</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3520</span><span class="w">                        </span><span class="n">liste_ele</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1500</span><span class="mf">1.</span><span class="nb">OR</span><span class="p">.</span><span class="n">liste_ele</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">15005</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3521</span><span class="k">                        </span>
<span class="linenos">3522</span><span class="k">                        </span><span class="n">VCO</span><span class="o">=</span><span class="mi">4</span><span class="w">  </span><span class="c">! Assumes this is a total column measurement</span>
<span class="linenos">3523</span><span class="w">                        </span><span class="k">exit</span>
<span class="linenos">3524</span><span class="k">                    end if</span>
<span class="linenos">3525</span><span class="k">                 end if</span>
<span class="linenos">3526</span><span class="k">              END DO</span>
<span class="linenos">3527</span><span class="k">           ELSE   </span>
<span class="linenos">3528</span><span class="k">              call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;write_body: Invalid BURP vertical coordinate type.&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3529</span><span class="w">           </span><span class="k">END IF</span>
<span class="linenos">3530</span><span class="k">        END IF</span>
<span class="linenos">3531</span><span class="k">    END SELECT</span><span class="w"></span>
<span class="linenos">3532</span>
<span class="linenos">3533</span><span class="w">    </span><span class="c">!-------------------SPECIAL CASES--------------</span>
<span class="linenos">3534</span><span class="w">    </span><span class="k">DO </span><span class="n">il</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NELE</span><span class="w"></span>
<span class="linenos">3535</span><span class="w">      </span><span class="n">varno</span><span class="o">=</span><span class="n">LISTE_ELE</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3536</span><span class="w">      </span><span class="k">DO </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">NVAL</span><span class="w"></span>
<span class="linenos">3537</span><span class="w">        </span><span class="n">VCOORD</span><span class="o">=</span><span class="n">VERTCOORD</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3538</span><span class="w">        </span><span class="n">OBSV</span><span class="w">  </span><span class="o">=</span><span class="w">   </span><span class="n">obsvalue</span><span class="p">(</span><span class="n">il</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3539</span><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="w"> </span><span class="n">L_EMISS</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">3540</span><span class="k">          if</span><span class="p">(</span><span class="w"> </span><span class="n">SURF_EMIS_opt</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MISG</span><span class="p">)</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">3541</span><span class="k">            </span><span class="n">REMIS</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">SURF_EMIS_opt</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">ZEMFACT</span><span class="w"></span>
<span class="linenos">3542</span><span class="w">          </span><span class="k">else</span>
<span class="linenos">3543</span><span class="k">            </span><span class="n">REMIS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MISG</span><span class="w"></span>
<span class="linenos">3544</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">3545</span><span class="k">        end if</span>
<span class="linenos">3546</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">L_BCOR</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">3547</span><span class="k">          </span><span class="n">BCOR</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="n">BiasCorrection_opt</span><span class="p">(</span><span class="n">il</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3548</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3549</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">L_dataQcFlag2</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">3550</span><span class="k">          </span><span class="n">IFLAG2</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="n">dataQcFlagLEV</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3551</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3552</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">L_dataCloudFrac</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">3553</span><span class="k">          </span><span class="n">cloudFrac</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="n">dataCloudFracLEV</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3554</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">3555</span><span class="k">        </span><span class="n">IFLAG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">INT</span><span class="p">(</span><span class="n">qCflag</span><span class="p">(</span><span class="n">il</span><span class="p">,</span><span class="n">j</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3556</span>
<span class="linenos">3557</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obsv</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">VCOORD</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w">   </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3558</span><span class="k">          </span><span class="nb">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3559</span><span class="w">          </span><span class="n">NLV</span><span class="o">=</span><span class="w"> </span><span class="n">NLV</span><span class="w"> </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3560</span><span class="w">          </span><span class="n">IFLAG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">IBCLR</span><span class="p">(</span><span class="n">IFLAG</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3561</span>
<span class="linenos">3562</span><span class="w">          </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VAR</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">OBSV</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3563</span><span class="w">          </span><span class="k">call </span><span class="n">obs_bodySet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VNM</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">VARNO</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3564</span><span class="w">          </span><span class="k">call </span><span class="n">obs_bodySet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VCO</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">VCO</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3565</span><span class="w">          </span><span class="n">ELEV_R</span><span class="o">=</span><span class="n">VCOORD</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ELEV</span><span class="o">*</span><span class="n">ELEVFACT</span><span class="w"></span>
<span class="linenos">3566</span><span class="w">          </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_PPP</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="w"> </span><span class="n">ELEV_R</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3567</span><span class="w">          </span><span class="k">call </span><span class="n">obs_bodySet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FLG</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">IFLAG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3568</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">FAMTYP</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;RO&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3569</span><span class="k">            </span><span class="n">rolat1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rolat</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">MPC_RADIANS_PER_DEGREE_R8</span><span class="w"></span>
<span class="linenos">3570</span><span class="w">            </span><span class="n">rolon1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rolon</span><span class="p">(</span><span class="n">j</span><span class="p">)</span><span class="o">*</span><span class="n">MPC_RADIANS_PER_DEGREE_R8</span><span class="w"></span>
<span class="linenos">3571</span><span class="w">            </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LATD</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">rolat1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3572</span><span class="w">            </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LOND</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">rolon1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3573</span><span class="w">          </span><span class="k">else</span>
<span class="linenos">3574</span><span class="k">            call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LATD</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">obs_missingValue_R</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3575</span><span class="w">            </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LOND</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">obs_missingValue_R</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3576</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">3577</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">L_BCOR</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">obs_columnActive_RB</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_BCOR</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3578</span><span class="k">            call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_BCOR</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">BCOR</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3579</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">3580</span>
<span class="linenos">3581</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">L_dataQcFlag2</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3582</span><span class="k">             call </span><span class="n">obs_bodySet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_QCF2</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">IFLAG2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3583</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">3584</span>
<span class="linenos">3585</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">L_dataCloudFrac</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3586</span><span class="k">             call </span><span class="n">obs_bodySet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLA</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">cloudFrac</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3587</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">3588</span>
<span class="linenos">3589</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">REMIS</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">FAMTYP</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;TO&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3590</span><span class="k">            call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SEM</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">REMIS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3591</span><span class="w">          </span><span class="k">else</span>
<span class="linenos">3592</span><span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">FAMTYP</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;TO&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3593</span><span class="k">                call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SEM</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">tvs_defaultEmissivity</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3594</span><span class="w">             </span><span class="k">else</span>
<span class="linenos">3595</span><span class="k">                call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SEM</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">MISG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3596</span><span class="w">             </span><span class="k">end if</span>
<span class="linenos">3597</span><span class="k">          end if</span>
<span class="linenos">3598</span>
<span class="linenos">3599</span><span class="k">          call </span><span class="n">obs_bodySet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VCO</span><span class="p">,</span><span class="nb">count</span><span class="p">,</span><span class="n">VCO</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3600</span>
<span class="linenos">3601</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">filt_bufrCodeAssimilated</span><span class="p">(</span><span class="n">varno</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3602</span><span class="w">              </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">ovt_bufrCodeSkipped</span><span class="p">(</span><span class="n">varno</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">3603</span><span class="w">            </span><span class="c">! Add a row for the destination transform variable</span>
<span class="linenos">3604</span><span class="w">            </span><span class="k">call </span><span class="n">obs_bodySet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VNM</span><span class="p">,</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ovt_getDestinationBufrCode</span><span class="p">(</span><span class="n">varno</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3605</span><span class="w">            </span><span class="k">call </span><span class="n">obs_bodySet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FLG</span><span class="p">,</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3606</span><span class="w">            </span><span class="n">ELEV_R</span><span class="o">=</span><span class="n">VCOORD</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ELEV</span><span class="o">*</span><span class="n">ELEVFACT</span><span class="w"></span>
<span class="linenos">3607</span><span class="w">            </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_PPP</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ELEV_R</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3608</span><span class="w">            </span><span class="k">call </span><span class="n">obs_bodySet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VCO</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">VCO</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3609</span><span class="w">            </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VAR</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">MISG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3610</span><span class="w">            </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LATD</span><span class="p">,</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">MISG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3611</span><span class="w">            </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LOND</span><span class="p">,</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">MISG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3612</span><span class="w">            </span><span class="nb">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3613</span><span class="w">            </span><span class="n">NLV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NLV</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3614</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ovt_isWindObs</span><span class="p">(</span><span class="n">varno</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">3615</span><span class="w">              </span><span class="c">! Add an extra row for the other wind component</span>
<span class="linenos">3616</span><span class="w">              </span><span class="k">call </span><span class="n">obs_bodySet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VNM</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ovt_getDestinationBufrCode</span><span class="p">(</span><span class="n">varno</span><span class="p">,</span><span class="n">extra_opt</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.))</span><span class="w"></span>
<span class="linenos">3617</span><span class="w">              </span><span class="k">call </span><span class="n">obs_bodySet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FLG</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3618</span><span class="w">              </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_PPP</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">ELEV_R</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3619</span><span class="w">              </span><span class="k">call </span><span class="n">obs_bodySet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VCO</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">VCO</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3620</span><span class="w">              </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_VAR</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">MISG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3621</span><span class="w">              </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LATD</span><span class="p">,</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">MISG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3622</span><span class="w">              </span><span class="k">call </span><span class="n">obs_bodySet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LOND</span><span class="p">,</span><span class="nb">count</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">MISG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3623</span><span class="w">              </span><span class="nb">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3624</span><span class="w">              </span><span class="n">NLV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NLV</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3625</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">3626</span><span class="k">          end if</span>
<span class="linenos">3627</span>
<span class="linenos">3628</span><span class="k">        end if</span>
<span class="linenos">3629</span>
<span class="linenos">3630</span><span class="k">      END DO</span>
<span class="linenos">3631</span>
<span class="linenos">3632</span><span class="k">    END DO</span>
<span class="linenos">3633</span>
<span class="linenos">3634</span><span class="k">    </span><span class="n">WRITE_BODY</span><span class="o">=</span><span class="n">NLV</span><span class="w"></span>
<span class="linenos">3635</span>
<span class="linenos">3636</span><span class="w">  </span><span class="k">END FUNCTION  </span><span class="n">WRITE_BODY</span><span class="w"></span>
<span class="linenos">3637</span>
<span class="linenos">3638</span>
<span class="linenos">3639</span><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">WRITE_HEADER</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="w"> </span><span class="n">STNID</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">LON</span><span class="p">,</span><span class="n">DATE</span><span class="p">,</span><span class="nb">TIME</span><span class="p">,</span><span class="n">CODTYP</span><span class="p">,</span><span class="n">STATUS</span><span class="p">,</span><span class="n">ELEV</span><span class="p">,</span><span class="n">FILENUMB</span><span class="p">,</span><span class="n">PHASE_Opt</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3640</span>
<span class="linenos">3641</span><span class="w">    </span><span class="k">implicit none</span>
<span class="linenos">3642</span><span class="k">    type</span><span class="w"> </span><span class="p">(</span><span class="n">struct_obs</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">obsdat</span><span class="w"></span>
<span class="linenos">3643</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="p">(</span><span class="nb">LEN</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">STNID</span><span class="w"></span>
<span class="linenos">3644</span>
<span class="linenos">3645</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">    </span><span class="n">DATE</span><span class="p">,</span><span class="nb">TIME</span><span class="p">,</span><span class="n">CODTYP</span><span class="p">,</span><span class="n">STATUS</span><span class="w"></span>
<span class="linenos">3646</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">    </span><span class="n">FILENUMB</span><span class="w"></span>
<span class="linenos">3647</span><span class="w">    </span><span class="kt">INTEGER</span><span class="p">,</span><span class="w"> </span><span class="k">optional</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">phase_opt</span><span class="w"></span>
<span class="linenos">3648</span>
<span class="linenos">3649</span><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ELEV</span><span class="p">,</span><span class="n">LAT</span><span class="p">,</span><span class="n">LON</span><span class="w"></span>
<span class="linenos">3650</span>
<span class="linenos">3651</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">   </span><span class="n">NOBS</span><span class="w"></span>
<span class="linenos">3652</span>
<span class="linenos">3653</span><span class="w">    </span><span class="n">NOBS</span><span class="o">=</span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w">  </span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3654</span>
<span class="linenos">3655</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ONM</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">nobs</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3656</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LAT</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">LAT</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3657</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LON</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">LON</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3658</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_DAT</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">DATE</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3659</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ETM</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="nb">TIME</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3660</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ITY</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">CODTYP</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3661</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ST1</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">STATUS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3662</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ALT</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">ELEV</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3663</span><span class="w">    </span><span class="c">!call obs_headSet_i(obsdat,OBS_IDF,nobs,FILENUMB)</span>
<span class="linenos">3664</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">FILENUMB</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3665</span><span class="w">    </span><span class="k">call </span><span class="n">obs_set_c</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="s1">&#39;STID&#39;</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">STNID</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3666</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">phase_opt</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">3667</span><span class="w">         </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_PHAS</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3668</span><span class="k">      call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_PHAS</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">phase_opt</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3669</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">3670</span>
<span class="linenos">3671</span><span class="k">  END SUBROUTINE  </span><span class="n">WRITE_HEADER</span><span class="w"></span>
<span class="linenos">3672</span>
<span class="linenos">3673</span><span class="c">!!------------------------------------------------------------------------------------</span>
<span class="linenos">3674</span><span class="c">!!------------------------------------------------------------------------------------</span>
<span class="linenos">3675</span>
<span class="linenos">3676</span><span class="w">  </span><span class="k">SUBROUTINE </span><span class="n">WRITE_QI</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="w"> </span><span class="n">QI1value</span><span class="p">,</span><span class="w"> </span><span class="n">QI2value</span><span class="p">,</span><span class="w"> </span><span class="n">MTvalue</span><span class="p">,</span><span class="w"> </span><span class="n">LSvalue</span><span class="p">,</span><span class="w"> </span><span class="n">HAvalue</span><span class="p">,</span><span class="w"> </span><span class="n">GAvalue</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3677</span>
<span class="linenos">3678</span><span class="w">    </span><span class="k">implicit none</span>
<span class="linenos">3679</span><span class="k">    type</span><span class="w"> </span><span class="p">(</span><span class="n">struct_obs</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">obsdat</span><span class="w"></span>
<span class="linenos">3680</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">  </span><span class="n">MTvalue</span><span class="p">,</span><span class="w"> </span><span class="n">HAvalue</span><span class="p">,</span><span class="w"> </span><span class="n">GAvalue</span><span class="p">,</span><span class="w"> </span><span class="n">QI1value</span><span class="p">,</span><span class="w"> </span><span class="n">QI2value</span><span class="p">,</span><span class="w"> </span><span class="n">LSvalue</span><span class="w"></span>
<span class="linenos">3681</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">  </span><span class="n">NOBS</span><span class="w"></span>
<span class="linenos">3682</span>
<span class="linenos">3683</span><span class="w">    </span><span class="n">NOBS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3684</span>
<span class="linenos">3685</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SWQ1</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">QI1value</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3686</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SWQ2</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">QI2value</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3687</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SWMT</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">MTvalue</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3688</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SWLS</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">LSvalue</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3689</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SWGA</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">GAvalue</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3690</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SWHA</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">HAvalue</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3691</span>
<span class="linenos">3692</span><span class="w">  </span><span class="k">END SUBROUTINE  </span><span class="n">WRITE_QI</span><span class="w"></span>
<span class="linenos">3693</span>
<span class="linenos">3694</span><span class="c">!!------------------------------------------------------------------------------------</span>
<span class="linenos">3695</span><span class="c">!!------------------------------------------------------------------------------------</span>
<span class="linenos">3696</span>
<span class="linenos">3697</span><span class="w">  </span><span class="k">subroutine </span><span class="n">write_al</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="w"> </span><span class="n">azimuth</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3698</span><span class="w">    </span><span class="k">implicit none</span>
<span class="linenos">3699</span><span class="k">    type</span><span class="w"> </span><span class="p">(</span><span class="n">struct_obs</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">obsdat</span><span class="w"></span>
<span class="linenos">3700</span><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">azimuth</span><span class="w"></span>
<span class="linenos">3701</span><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nobs</span><span class="w"></span>
<span class="linenos">3702</span>
<span class="linenos">3703</span><span class="w">    </span><span class="n">nobs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3704</span>
<span class="linenos">3705</span><span class="w">    </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_AZA</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">azimuth</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3706</span><span class="w">  </span><span class="k">end subroutine </span><span class="n">write_al</span><span class="w"></span>
<span class="linenos">3707</span>
<span class="linenos">3708</span><span class="w">  </span><span class="c">!--------------------------------------------------------------------------</span>
<span class="linenos">3709</span><span class="w">  </span><span class="c">! writeInfo</span>
<span class="linenos">3710</span><span class="w">  </span><span class="c">!--------------------------------------------------------------------------</span>
<span class="linenos">3711</span><span class="w">  </span><span class="k">subroutine </span><span class="n">writeInfo</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="w"> </span><span class="n">FAMTYP</span><span class="p">,</span><span class="w"> </span><span class="n">RINFO</span><span class="p">,</span><span class="w"> </span><span class="n">LISTE_INFO</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_INFO</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3712</span><span class="w">    </span><span class="c">!:Purpose: Write values in obsSpaceData related to the info block</span>
<span class="linenos">3713</span>
<span class="linenos">3714</span><span class="w">    </span><span class="k">implicit none</span><span class="w"></span>
<span class="linenos">3715</span>
<span class="linenos">3716</span><span class="w">    </span><span class="c">! Arguments:</span>
<span class="linenos">3717</span><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="p">(</span><span class="n">struct_obs</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">obsdat</span><span class="w"></span>
<span class="linenos">3718</span><span class="w">    </span><span class="kt">real</span><span class="w">        </span><span class="kd">::</span><span class="w">   </span><span class="n">RINFO</span><span class="p">(</span><span class="n">NELE_INFO</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3719</span><span class="w">    </span><span class="kt">CHARACTER</span><span class="o">*</span><span class="mi">2</span><span class="w"> </span><span class="kd">::</span><span class="w">   </span><span class="n">FAMTYP</span><span class="w"></span>
<span class="linenos">3720</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">   </span><span class="n">NELE_INFO</span><span class="w"></span>
<span class="linenos">3721</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">   </span><span class="n">LISTE_INFO</span><span class="p">(</span><span class="n">NELE_INFO</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3722</span>
<span class="linenos">3723</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">3724</span><span class="w">    </span><span class="kt">REAL</span><span class="o">*</span><span class="mi">4</span><span class="w">      </span><span class="kd">::</span><span class="w">   </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3725</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">   </span><span class="n">CODTYP</span><span class="w"></span>
<span class="linenos">3726</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">   </span><span class="n">IL</span><span class="p">,</span><span class="n">NOBS</span><span class="w"></span>
<span class="linenos">3727</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">   </span><span class="n">SENSOR</span><span class="p">,</span><span class="n">ORBIT</span><span class="p">,</span><span class="n">ID_SAT</span><span class="p">,</span><span class="n">INSTRUMENT</span><span class="p">,</span><span class="n">LAND_SEA</span><span class="p">,</span><span class="n">CONSTITUENT_TYPE</span><span class="w"></span>
<span class="linenos">3728</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">   </span><span class="n">TERRAIN_TYPE</span><span class="p">,</span><span class="n">QCFLAG1</span><span class="p">,</span><span class="n">QCFLAG2</span><span class="p">,</span><span class="n">QCFLAG3</span><span class="p">,</span><span class="n">RAINFLAG</span><span class="w"></span>
<span class="linenos">3729</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">   </span><span class="n">IGQISFLAGQUAL</span><span class="p">,</span><span class="n">IGQISQUALINDEXLOC</span><span class="p">,</span><span class="n">IRO_QCFLAG</span><span class="w"></span>
<span class="linenos">3730</span><span class="w">    </span><span class="kt">integer</span><span class="w">     </span><span class="kd">::</span><span class="w">   </span><span class="n">IFOV</span><span class="p">,</span><span class="n">ORIGIN_CENTRE</span><span class="p">,</span><span class="n">RAOBSTYPE</span><span class="p">,</span><span class="w"> </span><span class="n">LAUNCHTIME</span><span class="w"></span>
<span class="linenos">3731</span><span class="w">    </span><span class="kt">real</span><span class="w">        </span><span class="kd">::</span><span class="w">   </span><span class="n">RIGQISFLAGQUAL</span><span class="p">,</span><span class="n">RIGQISQUALINDEXLOC</span><span class="p">,</span><span class="n">RCONSTITUENT</span><span class="p">,</span><span class="n">RQCFLAG1</span><span class="p">,</span><span class="n">RQCFLAG2</span><span class="p">,</span><span class="n">RQCFLAG3</span><span class="p">,</span><span class="n">RRAINFLAG</span><span class="w"></span>
<span class="linenos">3732</span><span class="w">    </span><span class="kt">real</span><span class="w">        </span><span class="kd">::</span><span class="w">   </span><span class="n">RTERRAIN_TYPE</span><span class="p">,</span><span class="n">RLAND_SEA</span><span class="p">,</span><span class="n">RID_SAT</span><span class="p">,</span><span class="n">RSENSOR</span><span class="p">,</span><span class="n">RINSTRUMENT</span><span class="p">,</span><span class="n">RRO_QCFLAG</span><span class="p">,</span><span class="n">RORIGIN_CENTRE</span><span class="w"></span>
<span class="linenos">3733</span><span class="w">    </span><span class="kt">real</span><span class="w">        </span><span class="kd">::</span><span class="w">   </span><span class="n">RORBIT</span><span class="p">,</span><span class="w"> </span><span class="n">RIWV</span><span class="w"></span>
<span class="linenos">3734</span><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w">   </span><span class="n">RTANGENT_RADIUS</span><span class="p">,</span><span class="n">RGEOID</span><span class="p">,</span><span class="n">RSOLAR_AZIMUTH</span><span class="p">,</span><span class="n">RCLOUD_COVER</span><span class="p">,</span><span class="n">RSOLAR_ZENITH</span><span class="p">,</span><span class="n">RZENITH</span><span class="p">,</span><span class="n">RAZIMUTH</span><span class="w"></span>
<span class="linenos">3735</span><span class="w">    </span><span class="kt">real</span><span class="w">        </span><span class="kd">::</span><span class="w">   </span><span class="n">RFOV</span><span class="w"></span>
<span class="linenos">3736</span><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w">   </span><span class="n">cloudLiquidWaterObs</span><span class="p">,</span><span class="w"> </span><span class="n">cloudLiquidWaterFG</span><span class="w"></span>
<span class="linenos">3737</span><span class="w">    </span><span class="kt">REAL</span><span class="p">(</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w">   </span><span class="n">scatteringIndexObs</span><span class="p">,</span><span class="w"> </span><span class="n">scatteringIndexFG</span><span class="w"></span>
<span class="linenos">3738</span>
<span class="linenos">3739</span><span class="w">    </span><span class="n">NOBS</span><span class="o">=</span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3740</span><span class="w">    </span><span class="n">CODTYP</span><span class="o">=</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ITY</span><span class="p">,</span><span class="n">NOBS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3741</span><span class="w">    </span><span class="c">!write(*,*)&#39;  DEBUT WRITE_INFO NOBS CODTYP ----&gt; &#39;,NOBS,CODTYP,size(liste_info),size(RINFO),liste_info</span>
<span class="linenos">3742</span><span class="w">    </span><span class="n">LAND_SEA</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3743</span><span class="w">    </span><span class="n">INSTRUMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3744</span><span class="w">    </span><span class="n">ID_SAT</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3745</span><span class="w">    </span><span class="n">SENSOR</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3746</span><span class="w">    </span><span class="n">ORIGIN_CENTRE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3747</span><span class="w">    </span><span class="n">RAOBSTYPE</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3748</span><span class="w">    </span><span class="n">LAUNCHTIME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3749</span><span class="w">    </span><span class="n">ORBIT</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3750</span><span class="w">    </span><span class="n">QCFLAG1</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3751</span><span class="w">    </span><span class="n">QCFLAG2</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3752</span><span class="w">    </span><span class="n">QCFLAG3</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3753</span><span class="w">    </span><span class="n">RAINFLAG</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3754</span>
<span class="linenos">3755</span><span class="w">    </span><span class="n">IRO_QCFLAG</span><span class="o">=</span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3756</span><span class="w">    </span><span class="n">IGQISQUALINDEXLOC</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3757</span><span class="w">    </span><span class="n">IGQISFLAGQUAL</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3758</span>
<span class="linenos">3759</span><span class="w">    </span><span class="n">RTANGENT_RADIUS</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">MPC_missingValue_R8</span><span class="p">,</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3760</span><span class="w">    </span><span class="n">RGEOID</span><span class="o">=</span><span class="kt">real</span><span class="p">(</span><span class="n">MPC_missingValue_R8</span><span class="p">,</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3761</span><span class="w">    </span><span class="n">TERRAIN_TYPE</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3762</span><span class="w">    </span><span class="n">RIWV</span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">3763</span><span class="w">    </span><span class="n">RCLOUD_COVER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">3764</span><span class="w">    </span><span class="n">CONSTITUENT_TYPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3765</span><span class="w">    </span><span class="n">IFOV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3766</span><span class="w">    </span><span class="n">RIGQISQUALINDEXLOC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">3767</span><span class="w">    </span><span class="n">RIGQISFLAGQUAL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">3768</span><span class="w">    </span><span class="n">RRO_QCFLAG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"></span>
<span class="linenos">3769</span><span class="w">    </span><span class="n">RSOLAR_AZIMUTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">MPC_missingValue_R8</span><span class="p">,</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3770</span><span class="w">    </span><span class="n">RSOLAR_ZENITH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">MPC_missingValue_R8</span><span class="p">,</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3771</span><span class="w">    </span><span class="n">RZENITH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">3772</span><span class="w">    </span><span class="n">RAZIMUTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">3773</span><span class="w">    </span><span class="n">cloudLiquidWaterObs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">MPC_missingValue_R8</span><span class="p">,</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3774</span><span class="w">    </span><span class="n">cloudLiquidWaterFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">MPC_missingValue_R8</span><span class="p">,</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3775</span><span class="w">    </span><span class="n">scatteringIndexObs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">MPC_missingValue_R8</span><span class="p">,</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3776</span><span class="w">    </span><span class="n">scatteringIndexFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">MPC_missingValue_R8</span><span class="p">,</span><span class="n">pre_obsReal</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3777</span>
<span class="linenos">3778</span><span class="w">    </span><span class="k">do </span><span class="n">il</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">NELE_INFO</span><span class="w"></span>
<span class="linenos">3779</span><span class="w">      </span><span class="n">INFOV</span><span class="o">=</span><span class="n">rinfo</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3780</span><span class="w">      </span><span class="k">SELECT CASE</span><span class="p">(</span><span class="w"> </span><span class="n">liste_info</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3781</span><span class="w">        </span><span class="k">CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">1007</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3782</span><span class="w">          </span><span class="n">RID_SAT</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3783</span><span class="w">          </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">RID_SAT</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN </span>
<span class="linenos">3784</span><span class="k">            </span><span class="n">ID_SAT</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3785</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3786</span><span class="k">            </span><span class="n">ID_SAT</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">RID_SAT</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3787</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3788</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">1033</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3789</span><span class="w">          </span><span class="n">RORIGIN_CENTRE</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3790</span><span class="w">          </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">RORIGIN_CENTRE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN </span>
<span class="linenos">3791</span><span class="k">            </span><span class="n">ORIGIN_CENTRE</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3792</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3793</span><span class="k">            </span><span class="n">ORIGIN_CENTRE</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">RORIGIN_CENTRE</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3794</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3795</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">2048</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3796</span><span class="w">          </span><span class="n">RSENSOR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3797</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RSENSOR</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3798</span><span class="k">            </span><span class="n">SENSOR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3799</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3800</span><span class="k">            </span><span class="n">SENSOR</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="n">RSENSOR</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3801</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3802</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">5040</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3803</span><span class="w">          </span><span class="n">RORBIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3804</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RORBIT</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3805</span><span class="k">            </span><span class="n">ORBIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3806</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3807</span><span class="k">            </span><span class="n">ORBIT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="n">RORBIT</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3808</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3809</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">33078</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3810</span><span class="w">          </span><span class="n">RQCFLAG1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3811</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RQCFLAG1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3812</span><span class="k">            </span><span class="n">QCFLAG1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3813</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3814</span><span class="k">            </span><span class="n">QCFLAG1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="n">RQCFLAG1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3815</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3816</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">33079</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3817</span><span class="w">          </span><span class="n">RQCFLAG2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3818</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RQCFLAG2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3819</span><span class="k">            </span><span class="n">QCFLAG2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3820</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3821</span><span class="k">            </span><span class="n">QCFLAG2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="n">RQCFLAG2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3822</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3823</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">020029</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3824</span><span class="w">          </span><span class="n">RRAINFLAG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3825</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RRAINFLAG</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3826</span><span class="k">            </span><span class="n">RAINFLAG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3827</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3828</span><span class="k">            </span><span class="n">RAINFLAG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="n">RRAINFLAG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3829</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3830</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">33080</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3831</span><span class="w">          </span><span class="n">RQCFLAG3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3832</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RQCFLAG3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3833</span><span class="k">            </span><span class="n">QCFLAG3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3834</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3835</span><span class="k">            </span><span class="n">QCFLAG3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="n">RQCFLAG3</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3836</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3837</span>
<span class="linenos">3838</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">2019</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3839</span><span class="w">          </span><span class="n">RINSTRUMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3840</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RINSTRUMENT</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3841</span><span class="k">            </span><span class="n">INSTRUMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3842</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3843</span><span class="k">            </span><span class="n">INSTRUMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="n">RINSTRUMENT</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3844</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3845</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">5043</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3846</span><span class="w">          </span><span class="n">RFOV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3847</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RFOV</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3848</span><span class="k">            </span><span class="n">IFOV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3849</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3850</span><span class="k">            </span><span class="n">IFOV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="n">RFOV</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3851</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3852</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">7024</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3853</span><span class="w">          </span><span class="n">RZENITH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3854</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RZENITH</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3855</span><span class="k">            </span><span class="n">RZENITH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9</span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">3856</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3857</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">7025</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3858</span><span class="w">          </span><span class="n">RSOLAR_ZENITH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3859</span><span class="w">        </span><span class="k">CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">5021</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3860</span><span class="w">          </span><span class="n">RAZIMUTH</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3861</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RAZIMUTH</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3862</span><span class="k">            </span><span class="n">RAZIMUTH</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">3863</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3864</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">33060</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3865</span><span class="w">          </span><span class="n">RIGQISFLAGQUAL</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3866</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RIGQISFLAGQUAL</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">3867</span><span class="k">            </span><span class="n">IGQISFLAGQUAL</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3868</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3869</span><span class="k">            </span><span class="n">IGQISFLAGQUAL</span><span class="o">=</span><span class="nb">NINT</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">RIGQISFLAGQUAL</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3870</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3871</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">33062</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3872</span><span class="w">          </span><span class="n">RIGQISQUALINDEXLOC</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3873</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RIGQISQUALINDEXLOC</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w">  </span><span class="k">then</span>
<span class="linenos">3874</span><span class="k">            </span><span class="n">IGQISQUALINDEXLOC</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3875</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3876</span><span class="k">            </span><span class="n">IGQISQUALINDEXLOC</span><span class="o">=</span><span class="nb">NINT</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">RIGQISQUALINDEXLOC</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3877</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3878</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">5022</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3879</span><span class="w">          </span><span class="n">RSOLAR_AZIMUTH</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3880</span><span class="w">        </span><span class="k">CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">8012</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3881</span><span class="w">          </span><span class="n">RLAND_SEA</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3882</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RLAND_SEA</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3883</span><span class="k">            </span><span class="n">LAND_SEA</span><span class="o">=</span><span class="mi">99</span><span class="w"></span>
<span class="linenos">3884</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3885</span><span class="k">            </span><span class="n">LAND_SEA</span><span class="o">=</span><span class="nb">NINT</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">RLAND_SEA</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3886</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3887</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">13095</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3888</span><span class="w">          </span><span class="n">RIWV</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3889</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RIWV</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3890</span><span class="k">            </span><span class="n">RIWV</span><span class="o">=</span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">3891</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3892</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">13039</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3893</span><span class="w">          </span><span class="n">RTERRAIN_TYPE</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3894</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RTERRAIN_TYPE</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3895</span><span class="k">            </span><span class="n">TERRAIN_TYPE</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">3896</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3897</span><span class="k">            </span><span class="n">TERRAIN_TYPE</span><span class="o">=</span><span class="nb">NINT</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">RTERRAIN_TYPE</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3898</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3899</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">20010</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3900</span><span class="w">          </span><span class="n">RCLOUD_COVER</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3901</span><span class="w">        </span><span class="k">CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">10035</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3902</span><span class="w">          </span><span class="n">RTANGENT_RADIUS</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3903</span><span class="w">        </span><span class="k">CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">10036</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3904</span><span class="w">          </span><span class="n">RGEOID</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3905</span><span class="w">        </span><span class="k">CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">33039</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3906</span><span class="w">          </span><span class="n">RRO_QCFLAG</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3907</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">RRO_QCFLAG</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3908</span><span class="k">            </span><span class="n">IRO_QCFLAG</span><span class="o">=</span><span class="n">MPC_missingValue_INT</span><span class="w"></span>
<span class="linenos">3909</span><span class="w">          </span><span class="k">ELSE</span>
<span class="linenos">3910</span><span class="k">            </span><span class="n">IRO_QCFLAG</span><span class="o">=</span><span class="nb">NINT</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">RRO_QCFLAG</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3911</span><span class="w">          </span><span class="k">END IF</span>
<span class="linenos">3912</span><span class="k">        CASE</span><span class="p">(</span><span class="w"> </span><span class="mi">08046</span><span class="p">)</span><span class="w">          </span>
<span class="linenos">3913</span><span class="w">          </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMTYP</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;CH&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3914</span><span class="k">             </span><span class="n">RCONSTITUENT</span><span class="o">=</span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3915</span><span class="w">             </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="n">RCONSTITUENT</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">3916</span><span class="k">                call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;writeInfo: Missing 08046 element for the CH family.&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3917</span><span class="w">             </span><span class="k">ELSE</span>
<span class="linenos">3918</span><span class="k">                </span><span class="n">CONSTITUENT_TYPE</span><span class="o">=</span><span class="nb">NINT</span><span class="p">(</span><span class="n">RCONSTITUENT</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3919</span><span class="w">             </span><span class="k">END IF</span>
<span class="linenos">3920</span><span class="k">          END IF</span>
<span class="linenos">3921</span><span class="k">        CASE</span><span class="p">(</span><span class="mi">13208</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3922</span><span class="w">          </span><span class="n">scatteringIndexObs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3923</span><span class="w">        </span><span class="k">CASE</span><span class="p">(</span><span class="mi">13209</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3924</span><span class="w">          </span><span class="n">cloudLiquidWaterObs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3925</span><span class="w">        </span><span class="k">CASE</span><span class="p">(</span><span class="mi">2011</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3926</span><span class="w">          </span><span class="n">raobsType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">(</span><span class="n">infov</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3927</span><span class="w">        </span><span class="k">CASE</span><span class="p">(</span><span class="mi">4197</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3928</span><span class="w">          </span><span class="n">launchTime</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">nint</span><span class="p">(</span><span class="n">infov</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3929</span><span class="w">      </span><span class="k">END SELECT</span>
<span class="linenos">3930</span><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">liste_info</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">clwFgElementId</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">cloudLiquidWaterFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3931</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">liste_info</span><span class="p">(</span><span class="n">il</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">siFgElementId</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">scatteringIndexFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">INFOV</span><span class="w"></span>
<span class="linenos">3932</span><span class="w">    </span><span class="k">end do</span><span class="w"></span>
<span class="linenos">3933</span>
<span class="linenos">3934</span><span class="w">    </span><span class="c">!-------------------SPECIAL CASES--------------</span>
<span class="linenos">3935</span>
<span class="linenos">3936</span><span class="w">    </span><span class="c">! INSTRUMENT</span>
<span class="linenos">3937</span><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">SENSOR</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3938</span><span class="k">      IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">INSTRUMENT</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">MPC_missingValue_INT</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3939</span><span class="k">        </span><span class="n">INSTRUMENT</span><span class="o">=</span><span class="mi">0</span><span class="w"></span>
<span class="linenos">3940</span><span class="w">      </span><span class="k">END IF</span>
<span class="linenos">3941</span><span class="k">    ELSE</span>
<span class="linenos">3942</span><span class="k">      </span><span class="n">INSTRUMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obsu_cvt_obs_instrum</span><span class="p">(</span><span class="n">sensor</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3943</span><span class="w">    </span><span class="k">END IF</span><span class="w"></span>
<span class="linenos">3944</span>
<span class="linenos">3945</span><span class="w">    </span><span class="c">! AIRS</span>
<span class="linenos">3946</span><span class="w">    </span><span class="k">IF</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">INSTRUMENT</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">420</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">ID_SAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">784</span><span class="w"></span>
<span class="linenos">3947</span>
<span class="linenos">3948</span><span class="w">    </span><span class="c">! CrIS FSR</span>
<span class="linenos">3949</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">codtyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">202</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">INSTRUMENT</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">620</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3950</span><span class="k">      </span><span class="n">INSTRUMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2046</span><span class="w"> </span>
<span class="linenos">3951</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">3952</span>
<span class="linenos">3953</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="w">  </span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMTYP</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="s1">&#39;GO&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3954</span><span class="k">      call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;writeInfo: unknown familyType : &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMTYP</span><span class="p">))</span><span class="w"></span>
<span class="linenos">3955</span><span class="w">    </span><span class="k">END IF</span><span class="w"></span>
<span class="linenos">3956</span><span class="w">   </span>
<span class="linenos">3957</span>
<span class="linenos">3958</span><span class="w">    </span><span class="c">!-------------------SPECIAL CASES--------------</span>
<span class="linenos">3959</span>
<span class="linenos">3960</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_TTYP</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_TTYP</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">TERRAIN_TYPE</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3961</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_STYP</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_STYP</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">LAND_SEA</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3962</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ORBI</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ORBI</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">ORBIT</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3963</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_AQF1</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_AQF1</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">QCFLAG1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3964</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_AQF2</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_AQF2</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">QCFLAG2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3965</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_AQF3</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_AQF3</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">QCFLAG3</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3966</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RAIN</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RAIN</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">RAINFLAG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3967</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_INS</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_INS</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">INSTRUMENT</span><span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3968</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FOV</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FOV</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">IFOV</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3969</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SAT</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SAT</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">ID_SAT</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3970</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ORI</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ORI</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">ORIGIN_CENTRE</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3971</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_TEC</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_TEC</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3972</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_GQF</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_GQF</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">IGQISFLAGQUAL</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3973</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_GQL</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_GQL</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">IGQISQUALINDEXLOC</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3974</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ROQF</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ROQF</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">IRO_QCFLAG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3975</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RTP</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RTP</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">raobsType</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3976</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LCH</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LCH</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">launchTime</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3977</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLF</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLF</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">RCLOUD_COVER</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3978</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SUN</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SUN</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">RSOLAR_ZENITH</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3979</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SAZ</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SAZ</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">RSOLAR_AZIMUTH</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3980</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SZA</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SZA</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">RZENITH</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3981</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_AZA</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_AZA</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">RAZIMUTH</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">3982</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_TRAD</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_TRAD</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">RTANGENT_RADIUS</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3983</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_IWV</span><span class="p">))</span><span class="w">  </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_IWV</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">RIWV</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3984</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_GEOI</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_GEOI</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">RGEOID</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3985</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">FAMTYP</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="s1">&#39;CH&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">3986</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CHM</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CHM</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">CONSTITUENT_TYPE</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3987</span><span class="w">    </span><span class="k">else</span>
<span class="linenos">3988</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CHM</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CHM</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3989</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">3990</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLWO</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLWO</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">cloudLiquidWaterObs</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3991</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLWB</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLWB</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">cloudLiquidWaterFG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3992</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SIO</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SIO</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">scatteringIndexObs</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3993</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SIB</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SIB</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">scatteringIndexFG</span><span class="p">)</span><span class="w"></span>
<span class="linenos">3994</span>
<span class="linenos">3995</span><span class="w">  </span><span class="k">END SUBROUTINE  </span><span class="n">writeInfo</span><span class="w"></span>
<span class="linenos">3996</span>
<span class="linenos">3997</span><span class="w">  </span><span class="c">!--------------------------------------------------------------------------</span>
<span class="linenos">3998</span><span class="w">  </span><span class="c">! setInfoToMissing</span>
<span class="linenos">3999</span><span class="w">  </span><span class="c">!--------------------------------------------------------------------------</span>
<span class="linenos">4000</span><span class="w">  </span><span class="k">subroutine </span><span class="n">setInfoToMissing</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4001</span><span class="w">    </span><span class="c">!:Purpose: Set the obsSpaceData column related to the info block with</span>
<span class="linenos">4002</span><span class="w">    </span><span class="c">!           missing values</span>
<span class="linenos">4003</span>
<span class="linenos">4004</span><span class="w">    </span><span class="k">implicit none</span><span class="w"></span>
<span class="linenos">4005</span>
<span class="linenos">4006</span><span class="w">    </span><span class="c">! Arguments:</span>
<span class="linenos">4007</span><span class="w">    </span><span class="k">type</span><span class="w"> </span><span class="p">(</span><span class="n">struct_obs</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">obsdat</span><span class="w"></span>
<span class="linenos">4008</span>
<span class="linenos">4009</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">4010</span><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">nobs</span><span class="w"></span>
<span class="linenos">4011</span>
<span class="linenos">4012</span><span class="w">    </span><span class="n">nobs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_numHeader</span><span class="p">(</span><span class="n">obsdat</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4013</span>
<span class="linenos">4014</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_STYP</span><span class="p">))</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_STYP</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">mpc_missingValue_int</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4015</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_INS</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_INS</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">mpc_missingValue_int</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4016</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FOV</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_FOV</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">mpc_missingValue_int</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4017</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SAT</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SAT</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">mpc_missingValue_int</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4018</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ORI</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ORI</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">mpc_missingValue_int</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4019</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_TEC</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_TEC</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">mpc_missingValue_int</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4020</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_GQF</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_GQF</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">mpc_missingValue_int</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4021</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_GQL</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_GQL</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">mpc_missingValue_int</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4022</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ROQF</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_ROQF</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">mpc_missingValue_int</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4023</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RTP</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_RTP</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">mpc_missingValue_int</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4024</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_IH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LCH</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_i</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_LCH</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">mpc_missingValue_int</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4025</span>
<span class="linenos">4026</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLF</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLF</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">obs_missingValue_r</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4027</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SUN</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SUN</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">obs_missingValue_r</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4028</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SAZ</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SAZ</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">obs_missingValue_r</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4029</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SZA</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SZA</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">obs_missingValue_r</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4030</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_AZA</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_AZA</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">obs_missingValue_r</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4031</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_TRAD</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_TRAD</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">obs_missingValue_r</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4032</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_GEOI</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_GEOI</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">obs_missingValue_r</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4033</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLWO</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLWO</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">obs_missingValue_r</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4034</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLWB</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_CLWB</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">obs_missingValue_r</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4035</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SIO</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SIO</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">obs_missingValue_r</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4036</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_columnActive_RH</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SIB</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">obs_headSet_r</span><span class="p">(</span><span class="n">obsdat</span><span class="p">,</span><span class="n">OBS_SIB</span><span class="p">,</span><span class="n">nobs</span><span class="p">,</span><span class="n">obs_missingValue_r</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4037</span>
<span class="linenos">4038</span><span class="w">  </span><span class="k">end subroutine  </span><span class="n">setInfoToMissing</span><span class="w"></span>
<span class="linenos">4039</span>
<span class="linenos">4040</span><span class="w">  </span><span class="c">!--------------------------------------------------------------------------</span>
<span class="linenos">4041</span><span class="w">  </span><span class="c">! find_index</span>
<span class="linenos">4042</span><span class="w">  </span><span class="c">!--------------------------------------------------------------------------</span>
<span class="linenos">4043</span><span class="w">  </span><span class="kt">integer  </span><span class="k">FUNCTION </span><span class="n">FIND_INDEX</span><span class="p">(</span><span class="n">LIST</span><span class="p">,</span><span class="n">ELEMENT</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4044</span><span class="w">    </span><span class="k">implicit none</span>
<span class="linenos">4045</span><span class="k">    </span><span class="kt">integer </span><span class="n">LIST</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">4046</span><span class="w">    </span><span class="kt">integer </span><span class="n">I</span><span class="p">,</span><span class="n">ELEMENT</span><span class="w"></span>
<span class="linenos">4047</span><span class="w">    </span><span class="n">FIND_INDEX</span><span class="o">=-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4048</span><span class="w">    </span><span class="k">do </span><span class="n">I</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">size</span><span class="w"> </span><span class="p">(</span><span class="n">LIST</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4049</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">element</span><span class="p">)</span><span class="w"> </span><span class="k">THEN</span>
<span class="linenos">4050</span><span class="k">        </span><span class="n">FIND_INDEX</span><span class="o">=</span><span class="n">i</span><span class="w"></span>
<span class="linenos">4051</span><span class="w">        </span><span class="k">exit</span>
<span class="linenos">4052</span><span class="k">      end if</span>
<span class="linenos">4053</span><span class="k">    end do</span>
<span class="linenos">4054</span><span class="k">    return</span>
<span class="linenos">4055</span><span class="k">  END FUNCTION </span><span class="n">FIND_INDEX</span><span class="w"></span>
<span class="linenos">4056</span>
<span class="linenos">4057</span><span class="w">  </span><span class="c">!--------------------------------------------------------------------------</span>
<span class="linenos">4058</span><span class="w">  </span><span class="c">! brpr_addCloudParametersandEmissivity</span>
<span class="linenos">4059</span><span class="w">  </span><span class="c">!--------------------------------------------------------------------------</span>
<span class="linenos">4060</span><span class="w">  </span><span class="k">subroutine </span><span class="n">brpr_addCloudParametersandEmissivity</span><span class="p">(</span><span class="w"> </span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">fileIndex</span><span class="p">,</span><span class="w"> </span><span class="n">burpFile</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">4061</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">4062</span><span class="w">    </span><span class="c">!:Purpose: Add to the input BURP file number fileIndex cloud parameters and emissivity.</span>
<span class="linenos">4063</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">4064</span><span class="w">    </span><span class="k">implicit none</span><span class="w"></span>
<span class="linenos">4065</span>
<span class="linenos">4066</span><span class="w">    </span><span class="c">! Arguments:</span>
<span class="linenos">4067</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">struct_obs</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">obsSpaceData</span><span class="w"> </span><span class="c">! obsSpacedata structure</span>
<span class="linenos">4068</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">fileIndex</span><span class="w">    </span><span class="c">! number of the burp file to update</span>
<span class="linenos">4069</span><span class="w">    </span><span class="kt">character</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">burpFile</span><span class="w"></span>
<span class="linenos">4070</span><span class="w">    </span>
<span class="linenos">4071</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">4072</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">BURP_FILE</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">inputFile</span><span class="w"></span>
<span class="linenos">4073</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">BURP_RPT</span><span class="p">)</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="n">copyReport</span><span class="w"></span>
<span class="linenos">4074</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">BURP_BLOCK</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">inputBlock</span><span class="w"></span>
<span class="linenos">4075</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">opt_missing</span><span class="w"></span>
<span class="linenos">4076</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">btyp10</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w"> </span><span class="n">bfam</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"></span>
<span class="linenos">4077</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">btyp10des</span><span class="p">,</span><span class="w"> </span><span class="n">btyp10inf</span><span class="p">,</span><span class="w"> </span><span class="n">btyp10obs</span><span class="p">,</span><span class="w"> </span><span class="n">btyp10flg</span><span class="p">,</span><span class="w"> </span><span class="n">btyp10omp</span><span class="w"></span>
<span class="linenos">4078</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">nb_rpts</span><span class="p">,</span><span class="w"> </span><span class="n">ref_rpt</span><span class="p">,</span><span class="w"> </span><span class="n">ref_blk</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span>
<span class="linenos">4079</span><span class="nb">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">address</span><span class="p">(:),</span><span class="w"> </span><span class="n">goodprof</span><span class="p">(:),</span><span class="w"> </span><span class="n">reportsToUpdate</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">4080</span><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">btobs</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">4081</span><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">emisfc</span><span class="w"></span>
<span class="linenos">4082</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">4083</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">glbflag</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">4084</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">headerIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">reportIndex</span><span class="p">,</span><span class="w"> </span><span class="n">bodyIndex</span><span class="p">,</span><span class="w"> </span><span class="n">headElem_i</span><span class="w"></span>
<span class="linenos">4085</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">ind008012</span><span class="p">,</span><span class="n">ind012163</span><span class="p">,</span><span class="n">ind055200</span><span class="p">,</span><span class="n">indEmis</span><span class="p">,</span><span class="n">indchan</span><span class="p">,</span><span class="n">ichn</span><span class="p">,</span><span class="n">ichnb</span><span class="w"></span>
<span class="linenos">4086</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">ind5021</span><span class="p">,</span><span class="w"> </span><span class="n">ind7024</span><span class="p">,</span><span class="w"> </span><span class="n">ind13039</span><span class="w"></span>
<span class="linenos">4087</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">ind14213</span><span class="p">,</span><span class="w"> </span><span class="n">ind14214</span><span class="p">,</span><span class="w"> </span><span class="n">ind14215</span><span class="p">,</span><span class="w"> </span><span class="n">ind14216</span><span class="p">,</span><span class="w"> </span><span class="n">ind14217</span><span class="p">,</span><span class="w"> </span><span class="n">ind14218</span><span class="w"></span>
<span class="linenos">4088</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">ind14219</span><span class="p">,</span><span class="w"> </span><span class="n">ind14220</span><span class="p">,</span><span class="w"> </span><span class="n">ind14221</span><span class="p">,</span><span class="w"> </span><span class="n">ind13214</span><span class="p">,</span><span class="w"> </span><span class="n">ind59182</span><span class="p">,</span><span class="w"> </span><span class="n">indSiFG</span><span class="w"></span>
<span class="linenos">4089</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">ind13209</span><span class="p">,</span><span class="w"> </span><span class="n">indClwFG</span><span class="p">,</span><span class="w"> </span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="n">ind13095</span><span class="p">,</span><span class="w"> </span><span class="n">ind25174</span><span class="p">,</span><span class="w"> </span><span class="n">indtmp</span><span class="w"></span>
<span class="linenos">4090</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">idata2</span><span class="p">,</span><span class="n">idata3</span><span class="p">,</span><span class="n">idata</span><span class="p">,</span><span class="n">idatend</span><span class="w"></span>
<span class="linenos">4091</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">flag_passage1</span><span class="p">,</span><span class="n">flag_passage2</span><span class="p">,</span><span class="n">flag_passage3</span><span class="w"></span>
<span class="linenos">4092</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">flag_passage4</span><span class="p">,</span><span class="n">flag_passage5</span><span class="w"></span>
<span class="linenos">4093</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">idatyp</span><span class="p">,</span><span class="w"> </span><span class="n">val</span><span class="w"></span>
<span class="linenos">4094</span><span class="w">    </span><span class="kt">real</span><span class="w">                   </span><span class="kd">::</span><span class="w"> </span><span class="n">valBurpMissing_r4</span><span class="p">,</span><span class="w"> </span><span class="n">val_r4</span><span class="w"></span>
<span class="linenos">4095</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">station_id</span><span class="w"></span>
<span class="linenos">4096</span><span class="w">    </span>
<span class="linenos">4097</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;----------------------------------------------------------&#39;</span><span class="w"></span>
<span class="linenos">4098</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;------- Begin brpr_addCloudParametersandEmissivity -------&#39;</span><span class="w"></span>
<span class="linenos">4099</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;----------------------------------------------------------&#39;</span><span class="w"></span>
<span class="linenos">4100</span>
<span class="linenos">4101</span><span class="w">    </span><span class="c">! Initialisation</span>
<span class="linenos">4102</span>
<span class="linenos">4103</span><span class="w">    </span><span class="n">flag_passage1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">4104</span><span class="w">    </span><span class="n">flag_passage2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">4105</span><span class="w">    </span><span class="n">flag_passage3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">4106</span><span class="w">    </span><span class="n">flag_passage4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">4107</span><span class="w">    </span><span class="n">flag_passage5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">4108</span><span class="w">    </span>
<span class="linenos">4109</span><span class="w">    </span><span class="n">opt_missing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;MISSING&#39;</span><span class="w"></span>
<span class="linenos">4110</span><span class="w">    </span><span class="n">valBurpMissing_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">777</span><span class="mf">7.77</span><span class="w"></span>
<span class="linenos">4111</span>
<span class="linenos">4112</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Set_Options</span><span class="p">(</span><span class="w">                       </span><span class="p">&amp;</span><span class="w">                </span>
<span class="linenos">4113</span><span class="w">         </span><span class="n">REAL_OPTNAME</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">opt_missing</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4114</span><span class="w">         </span><span class="n">REAL_OPTNAME_VALUE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valBurpMissing_r4</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4115</span><span class="w">         </span><span class="n">iostat</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">4116</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Options&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4117</span>
<span class="linenos">4118</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4119</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_init inputFile&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4120</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="n">copyReport</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4121</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Init</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4122</span>
<span class="linenos">4123</span><span class="w">    </span><span class="c">! Opening file</span>
<span class="linenos">4124</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;OPENED FILE = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">burpFile</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4125</span>
<span class="linenos">4126</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4127</span><span class="w">         </span><span class="n">FILENAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burpFile</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4128</span><span class="w">         </span><span class="n">MODE</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">FILE_ACC_APPEND</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4129</span><span class="w">         </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">4130</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: problem opening input file&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4131</span><span class="w">    </span><span class="c">! Obtain input burp file number of reports</span>
<span class="linenos">4132</span>
<span class="linenos">4133</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">NRPTS</span><span class="o">=</span><span class="n">nb_rpts</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4134</span>
<span class="linenos">4135</span><span class="w">    </span><span class="c">! Scan input burp file to get all reports address</span>
<span class="linenos">4136</span>
<span class="linenos">4137</span><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">address</span><span class="p">(</span><span class="n">nb_rpts</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4138</span><span class="w">    </span><span class="n">address</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">4139</span><span class="w">    </span><span class="nb">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">4140</span><span class="w">    </span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">4141</span>
<span class="linenos">4142</span><span class="w">    </span><span class="k">do</span>
<span class="linenos">4143</span><span class="k">      </span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4144</span><span class="w">           </span><span class="n">report</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4145</span><span class="w">           </span><span class="n">SEARCH_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_rpt</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4146</span><span class="w">           </span><span class="n">iostat</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4147</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Find_Report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4148</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">Exit</span>
<span class="linenos">4149</span>
<span class="linenos">4150</span><span class="k">      call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">STNID</span><span class="o">=</span><span class="n">station_id</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4151</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">station_id</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">4152</span>
<span class="linenos">4153</span><span class="k">      </span><span class="nb">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4154</span><span class="w">      </span><span class="n">address</span><span class="p">(</span><span class="nb">count</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_rpt</span><span class="w"></span>
<span class="linenos">4155</span><span class="w">    </span><span class="k">end do</span>
<span class="linenos">4156</span>
<span class="linenos">4157</span><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">4158</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;NUMBER OF REPORTS WITH OBSERVATIONS = &#39;</span><span class="p">,</span><span class="nb">count</span>
<span class="linenos">4159</span><span class="nb">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">4160</span><span class="w">    </span>
<span class="linenos">4161</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">4162</span>
<span class="linenos">4163</span><span class="w">      </span><span class="c">! Create a new report</span>
<span class="linenos">4164</span><span class="w">      </span>
<span class="linenos">4165</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">ALLOC_SPACE</span><span class="o">=</span><span class="mi">20000000</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4166</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: problem allocating copyReport&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4167</span>
<span class="linenos">4168</span><span class="w">      </span><span class="c">! first identify reports that have observations in obsSpaceData</span>
<span class="linenos">4169</span><span class="w">      </span><span class="k">allocate</span><span class="p">(</span><span class="n">reportsToUpdate</span><span class="p">(</span><span class="nb">count</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4170</span><span class="w">      </span><span class="n">reportsToUpdate</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">4171</span><span class="w">      </span><span class="n">idata2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4172</span><span class="w">      </span><span class="n">REPORTS0</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">reportIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span>
<span class="linenos">4173</span><span class="nb">        </span><span class="k">call </span><span class="n">BURP_Get_Report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4174</span><span class="w">             </span><span class="n">report</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4175</span><span class="w">             </span><span class="n">REF</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">(</span><span class="n">reportIndex</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4176</span><span class="w">             </span><span class="n">iostat</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4177</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Get_Report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4178</span><span class="w">        </span>
<span class="linenos">4179</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">IDTYP</span><span class="o">=</span><span class="n">idatyp</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4180</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Get_Property REPORTS0&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4181</span>
<span class="linenos">4182</span><span class="w">        </span><span class="k">call </span><span class="n">obs_set_current_header_list</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;TO&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4183</span><span class="w">        </span><span class="n">HEADER0</span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="linenos">4184</span><span class="k">          </span><span class="n">headerIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_getHeaderIndex</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4185</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">headerIndex</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">HEADER0</span><span class="w"></span>
<span class="linenos">4186</span>
<span class="linenos">4187</span><span class="w">          </span><span class="k">if</span><span class="w">  </span><span class="p">(</span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_ITY</span><span class="p">,</span><span class="n">headerIndex</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">idatyp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4188</span><span class="w">               </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">headerIndex</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fileIndex</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4189</span><span class="k">            </span><span class="n">reportsToUpdate</span><span class="p">(</span><span class="n">reportIndex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">4190</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idata2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">idata2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">headerIndex</span><span class="w"></span>
<span class="linenos">4191</span><span class="w">            </span><span class="k">cycle </span><span class="n">REPORTS0</span><span class="w"></span>
<span class="linenos">4192</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">4193</span><span class="k">        end do </span><span class="n">HEADER0</span><span class="w"></span>
<span class="linenos">4194</span><span class="w">      </span><span class="k">end do </span><span class="n">REPORTS0</span><span class="w"></span>
<span class="linenos">4195</span>
<span class="linenos">4196</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">idata2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4197</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_addCloudParametersandEmissivity: for datyp=&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">idatyp</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4198</span><span class="w">                    </span><span class="s1">&#39; there is no report found in input file for update! Exiting ...&#39;</span><span class="w"></span>
<span class="linenos">4199</span><span class="w">        </span><span class="k">call  </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">4200</span><span class="w">        </span><span class="k">return</span>
<span class="linenos">4201</span><span class="k">      end if</span>
<span class="linenos">4202</span><span class="k">      </span><span class="n">idata3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idata2</span><span class="w"></span>
<span class="linenos">4203</span>
<span class="linenos">4204</span><span class="w">      </span><span class="c">! Loop on reports</span>
<span class="linenos">4205</span>
<span class="linenos">4206</span><span class="w">      </span><span class="n">REPORTS</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">reportIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span>
<span class="linenos">4207</span>
<span class="linenos">4208</span><span class="nb">        </span><span class="k">call </span><span class="n">BURP_Get_Report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4209</span><span class="w">             </span><span class="n">report</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4210</span><span class="w">             </span><span class="n">REF</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">(</span><span class="n">reportIndex</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4211</span><span class="w">             </span><span class="n">iostat</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4212</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Get_Report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4213</span><span class="w">        </span>
<span class="linenos">4214</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">reportsToUpdate</span><span class="p">(</span><span class="n">reportIndex</span><span class="p">))</span><span class="w"> </span><span class="k">cycle </span><span class="n">REPORTS</span><span class="w"></span>
<span class="linenos">4215</span>
<span class="linenos">4216</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">IDTYP</span><span class="o">=</span><span class="n">idatyp</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4217</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Get_Property REPORTS&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4218</span>
<span class="linenos">4219</span><span class="w">        </span><span class="c">! First loop on blocks</span>
<span class="linenos">4220</span>
<span class="linenos">4221</span><span class="w">        </span><span class="c">! Find bad profiles not in CMA. This occurs if :</span>
<span class="linenos">4222</span><span class="w">        </span><span class="c">!  - all observations are -1 and/or have a quality flag not zero</span>
<span class="linenos">4223</span>
<span class="linenos">4224</span><span class="w">        </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">4225</span>
<span class="linenos">4226</span><span class="w">        </span><span class="n">BLOCKS1</span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="linenos">4227</span>
<span class="linenos">4228</span><span class="k">          </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Block</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4229</span><span class="w">               </span><span class="k">BLOCK</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4230</span><span class="w">               </span><span class="n">SEARCH_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_blk</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4231</span><span class="w">               </span><span class="n">iostat</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4232</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Find_Block #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4233</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_blk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">EXIT </span><span class="n">BLOCKS1</span><span class="w"></span>
<span class="linenos">4234</span>
<span class="linenos">4235</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4236</span><span class="w">               </span><span class="n">NELE</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4237</span><span class="w">               </span><span class="n">NVAL</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nvale</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4238</span><span class="w">               </span><span class="n">NT</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">nte</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4239</span><span class="w">               </span><span class="n">BFAM</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">bfam</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4240</span><span class="w">               </span><span class="n">BTYP</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4241</span><span class="w">               </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4242</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Get_Property #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4243</span>
<span class="linenos">4244</span><span class="w">          </span><span class="c">! observation block (btyp = 0100 100011X XXXX)</span>
<span class="linenos">4245</span><span class="w">          </span><span class="c">! 0100 1000110 0000 = 9312</span>
<span class="linenos">4246</span><span class="w">          </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4247</span><span class="w">          </span><span class="n">btyp10obs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">291</span><span class="w"></span>
<span class="linenos">4248</span><span class="w">           </span>
<span class="linenos">4249</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4250</span><span class="k">            allocate</span><span class="p">(</span><span class="n">goodprof</span><span class="p">(</span><span class="n">nte</span><span class="p">),</span><span class="w"> </span><span class="n">btobs</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4251</span>
<span class="linenos">4252</span><span class="w">            </span><span class="n">goodprof</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">4253</span><span class="w">            </span><span class="n">btobs</span><span class="p">(:,:)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mf">0.</span><span class="w"></span>
<span class="linenos">4254</span>
<span class="linenos">4255</span><span class="w">            </span><span class="n">ind012163</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">012163</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4256</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind012163</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind012163</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: cannot find element 12163 in inputBlock&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4257</span>
<span class="linenos">4258</span><span class="w">            </span><span class="k">do </span><span class="n">tIndex</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">4259</span><span class="w">              </span><span class="k">do </span><span class="n">valIndex</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">4260</span><span class="w">                </span><span class="n">btobs</span><span class="p">(</span><span class="n">valIndex</span><span class="p">,</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Rval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4261</span><span class="w">                     </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind012163</span><span class="p">,</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4262</span><span class="w">                     </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4263</span><span class="w">                     </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tIndex</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">4264</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btobs</span><span class="p">(</span><span class="n">valIndex</span><span class="p">,</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0.</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">goodprof</span><span class="p">(</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4265</span><span class="w">              </span><span class="k">end do</span>
<span class="linenos">4266</span><span class="k">            end do</span>
<span class="linenos">4267</span><span class="k">            </span>
<span class="linenos">4268</span><span class="k">          end if</span>
<span class="linenos">4269</span>
<span class="linenos">4270</span><span class="k">        end do </span><span class="n">BLOCKS1</span><span class="w"></span>
<span class="linenos">4271</span>
<span class="linenos">4272</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_copy_Header</span><span class="p">(</span><span class="n">TO</span><span class="o">=</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">FROM</span><span class="o">=</span><span class="n">inputReport</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4273</span>
<span class="linenos">4274</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_Init_Report_Write</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4275</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Init_Report_Write&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4276</span>
<span class="linenos">4277</span><span class="w">        </span><span class="c">! Second loop on blocks</span>
<span class="linenos">4278</span>
<span class="linenos">4279</span><span class="w">        </span><span class="c">! add new informations</span>
<span class="linenos">4280</span><span class="w">        </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">4281</span><span class="w">        </span>
<span class="linenos">4282</span><span class="w">        </span><span class="n">BLOCKS2</span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="linenos">4283</span>
<span class="linenos">4284</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">goodprof</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4285</span><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4286</span><span class="w">            </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Resume report is position # &#39;</span><span class="p">,</span><span class="n">reportIndex</span><span class="w"></span>
<span class="linenos">4287</span><span class="w">            </span><span class="k">EXIT </span><span class="n">BLOCKS2</span><span class="w"></span>
<span class="linenos">4288</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">4289</span>
<span class="linenos">4290</span><span class="k">          </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Block</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4291</span><span class="w">               </span><span class="k">BLOCK</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4292</span><span class="w">               </span><span class="n">SEARCH_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_blk</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4293</span><span class="w">               </span><span class="n">iostat</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4294</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Find_Block #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4295</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_blk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">EXIT </span><span class="n">BLOCKS2</span><span class="w"></span>
<span class="linenos">4296</span>
<span class="linenos">4297</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4298</span><span class="w">               </span><span class="n">NELE</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4299</span><span class="w">               </span><span class="n">NVAL</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nvale</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4300</span><span class="w">               </span><span class="n">NT</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">nte</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4301</span><span class="w">               </span><span class="n">BFAM</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">bfam</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4302</span><span class="w">               </span><span class="n">BTYP</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4303</span><span class="w">               </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4304</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Get_Property #3&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4305</span><span class="w">          </span>
<span class="linenos">4306</span><span class="w">          </span><span class="c">! descriptor block (btyp = 0010 100000X XXXX) </span>
<span class="linenos">4307</span><span class="w">          </span><span class="c">! 0010 1000000 0000==5120 )</span>
<span class="linenos">4308</span><span class="w">          </span><span class="c">!    if profile contains rejected observations (apart from blacklisted channels),</span>
<span class="linenos">4309</span><span class="w">          </span><span class="c">!     set bit 6 in global flags.</span>
<span class="linenos">4310</span>
<span class="linenos">4311</span><span class="w">          </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4312</span><span class="w">          </span><span class="n">btyp10des</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">160</span><span class="w"></span>
<span class="linenos">4313</span>
<span class="linenos">4314</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10des</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4315</span><span class="k">            </span><span class="n">flag_passage1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4316</span>
<span class="linenos">4317</span><span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">glbflag</span><span class="p">(</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4318</span>
<span class="linenos">4319</span><span class="w">            </span><span class="n">ind055200</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">055200</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4320</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind055200</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind055200</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: cannot find element 55200 in inputBlock&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4321</span><span class="w">            </span><span class="k">do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">4322</span><span class="w">              </span><span class="n">glbflag</span><span class="p">(</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4323</span><span class="w">                   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind055200</span><span class="p">,</span><span class="w">                     </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4324</span><span class="w">                   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">                             </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4325</span><span class="w">                   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tIndex</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">4326</span><span class="w">            </span><span class="k">end do</span>
<span class="linenos">4327</span>
<span class="linenos">4328</span><span class="k">            do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">4329</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">goodprof</span><span class="p">(</span><span class="n">tIndex</span><span class="p">)</span><span class="o">/=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="n">glbflag</span><span class="p">(</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ibset</span><span class="p">(</span><span class="n">glbflag</span><span class="p">(</span><span class="n">tIndex</span><span class="p">),</span><span class="mi">6</span><span class="p">)</span><span class="w">            </span>
<span class="linenos">4330</span><span class="w">            </span><span class="k">end do</span>
<span class="linenos">4331</span>
<span class="linenos">4332</span><span class="k">            do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">4333</span><span class="w">              </span><span class="k">call </span><span class="n">BURP_Set_Tblval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4334</span><span class="w">                   </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind055200</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4335</span><span class="w">                   </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4336</span><span class="w">                   </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4337</span><span class="w">                   </span><span class="n">TBLVAL</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">glbflag</span><span class="p">(</span><span class="n">tIndex</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4338</span><span class="w">                   </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4339</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Tblval 55200&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4340</span><span class="w">            </span><span class="k">end do</span>
<span class="linenos">4341</span><span class="k">              </span>
<span class="linenos">4342</span><span class="k">            deallocate</span><span class="p">(</span><span class="n">glbflag</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4343</span>
<span class="linenos">4344</span><span class="w">          </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4345</span><span class="w">          </span><span class="c">! For Hyperspectral data</span>
<span class="linenos">4346</span><span class="w">          </span><span class="c">!</span>
<span class="linenos">4347</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">tvs_isIdBurpHyperSpectral</span><span class="p">(</span><span class="n">idatyp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4348</span>
<span class="linenos">4349</span><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_addCloudParametersandEmissivity for IR data&#39;</span><span class="w"></span>
<span class="linenos">4350</span><span class="w">            </span><span class="c">! info block (btyp = 0001 100000X XXXX) </span>
<span class="linenos">4351</span><span class="w">            </span><span class="c">! 0001 100000X XXXX = 3072</span>
<span class="linenos">4352</span><span class="w">            </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4353</span><span class="w">            </span><span class="n">btyp10inf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">96</span><span class="w"></span>
<span class="linenos">4354</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10inf</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4355</span><span class="k">              </span><span class="n">flag_passage2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4356</span><span class="w">              </span><span class="n">ind14213</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014213</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4357</span><span class="w">              </span><span class="n">ind14214</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014214</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4358</span><span class="w">              </span><span class="n">ind14215</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014215</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4359</span><span class="w">              </span><span class="n">ind14216</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014216</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4360</span><span class="w">              </span><span class="n">ind14217</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014217</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4361</span><span class="w">              </span><span class="n">ind14218</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014218</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4362</span><span class="w">              </span><span class="n">ind14219</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014219</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4363</span><span class="w">              </span><span class="n">ind14220</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014220</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4364</span><span class="w">              </span><span class="n">ind14221</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014221</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4365</span><span class="w">              </span><span class="n">ind13214</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013214</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4366</span><span class="w">              </span><span class="n">ind59182</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">59182</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4367</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind14213</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4368</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4369</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4370</span><span class="w">                </span><span class="n">ind14213</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4371</span><span class="w">                </span><span class="n">ind14214</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="linenos">4372</span><span class="w">                </span><span class="n">ind14215</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="w"></span>
<span class="linenos">4373</span><span class="w">                </span><span class="n">ind14216</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="w"> </span><span class="mi">4</span><span class="w"></span>
<span class="linenos">4374</span><span class="w">                </span><span class="n">ind14217</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="linenos">4375</span><span class="w">                </span><span class="n">ind14218</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="w"> </span><span class="mi">6</span><span class="w"></span>
<span class="linenos">4376</span><span class="w">                </span><span class="n">ind14219</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="w"> </span><span class="mi">7</span><span class="w"></span>
<span class="linenos">4377</span><span class="w">                </span><span class="n">ind14220</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="w"> </span><span class="mi">8</span><span class="w"></span>
<span class="linenos">4378</span><span class="w">                </span><span class="n">ind14221</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="w"> </span><span class="mi">9</span><span class="w"></span>
<span class="linenos">4379</span><span class="w">                </span><span class="n">ind13214</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="w"> </span><span class="mi">10</span><span class="w"></span>
<span class="linenos">4380</span><span class="w">                </span><span class="n">ind59182</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="o">+</span><span class="w"> </span><span class="mi">11</span><span class="w"></span>
<span class="linenos">4381</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind14213</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014213</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4382</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 14213&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4383</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind14214</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014214</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4384</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 14214&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4385</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind14215</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014215</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4386</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 14215&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4387</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind14216</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014216</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4388</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 14216&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4389</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind14217</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014217</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4390</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 14217&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4391</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind14218</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014218</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4392</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 14218&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4393</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind14219</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014219</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4394</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 14219&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4395</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind14220</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014220</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4396</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 14220&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4397</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind14221</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">014221</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4398</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 14221&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4399</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind13214</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013214</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4400</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 13214&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4401</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind59182</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">059182</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4402</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 59182&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4403</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">4404</span>
<span class="linenos">4405</span><span class="k">              </span><span class="n">ind008012</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">008012</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4406</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind008012</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: cannot find element 8012 in inputBlock #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4407</span>
<span class="linenos">4408</span><span class="w">              </span><span class="k">do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">4409</span>
<span class="linenos">4410</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">goodprof</span><span class="p">(</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4411</span>
<span class="linenos">4412</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">idata2</span><span class="p">)</span><span class="w">  </span><span class="o">/=</span><span class="w"> </span><span class="n">fileIndex</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4413</span><span class="k">                    </span><span class="n">headElem_i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4414</span><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;File Inconsistency &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">headElem_i</span><span class="p">,</span><span class="w"> </span><span class="n">fileIndex</span><span class="w"></span>
<span class="linenos">4415</span><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Should not happen...&quot;</span><span class="w"></span>
<span class="linenos">4416</span><span class="w">                    </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_addCloudParametersandEmissivity&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4417</span><span class="w">                    </span><span class="k">end if</span>
<span class="linenos">4418</span>
<span class="linenos">4419</span><span class="k">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_ETOP</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4420</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14213</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4421</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_VTOP</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4422</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14214</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4423</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_ECF</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4424</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14215</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4425</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_VCF</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4426</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14216</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4427</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_HE</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4428</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14217</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4429</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_ZTSR</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4430</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14218</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4431</span><span class="w">                  </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_NCO2</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4432</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">ind14219</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4433</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_ZTM</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4434</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14220</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4435</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_ZTGM</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4436</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14221</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4437</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_ZLQM</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4438</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13214</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4439</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_ZPS</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4440</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind59182</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4441</span><span class="w">                  </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tvs_ChangedStypValue</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4442</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4443</span><span class="w">                  </span><span class="n">idata2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idata2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4444</span>
<span class="linenos">4445</span><span class="w">                </span><span class="k">else</span>
<span class="linenos">4446</span>
<span class="linenos">4447</span><span class="k">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0</span><span class="w"></span>
<span class="linenos">4448</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14213</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4449</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14214</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4450</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14215</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4451</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14216</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4452</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14217</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4453</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14218</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4454</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ind14219</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4455</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14220</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4456</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind14221</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4457</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13214</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4458</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind59182</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4459</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4460</span>
<span class="linenos">4461</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">4462</span>
<span class="linenos">4463</span>
<span class="linenos">4464</span><span class="k">              end do</span>
<span class="linenos">4465</span><span class="k"> </span>
<span class="linenos">4466</span><span class="k">            end if</span><span class="w"></span>
<span class="linenos">4467</span>
<span class="linenos">4468</span><span class="w">            </span><span class="c">! observation block (btyp = 0100 100011X XXXX)</span>
<span class="linenos">4469</span><span class="w">            </span><span class="c">! 0100 1000110 0000 = 9312</span>
<span class="linenos">4470</span><span class="w">            </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4471</span><span class="w">            </span><span class="n">btyp10obs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">291</span><span class="w"></span>
<span class="linenos">4472</span>
<span class="linenos">4473</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4474</span><span class="k">              </span><span class="n">flag_passage3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4475</span>
<span class="linenos">4476</span><span class="w">              </span><span class="n">indEmis</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">055043</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4477</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indEmis</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4478</span><span class="k">                </span><span class="n">indEmis</span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4479</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4480</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block data&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4481</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">indEmis</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">055043</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4482</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 55043 #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4483</span><span class="w">                </span><span class="n">indEmis</span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4484</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">4485</span><span class="k">              </span><span class="n">indchan</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">005042</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4486</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indchan</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">indchan</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: cannot find element 5042 in inputBlock&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4487</span><span class="w">              </span><span class="k">do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">4488</span><span class="w">                </span><span class="k">do </span><span class="n">valIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">4489</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">indEmis</span><span class="p">,</span><span class="n">valIndex</span><span class="p">,</span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4490</span><span class="w">                </span><span class="k">end do</span>
<span class="linenos">4491</span>
<span class="linenos">4492</span><span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">goodprof</span><span class="p">(</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4493</span>
<span class="linenos">4494</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">idata3</span><span class="p">)</span><span class="w">  </span><span class="o">/=</span><span class="w"> </span><span class="n">fileIndex</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4495</span><span class="k">                    </span><span class="n">headElem_i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">idata3</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4496</span><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;File Inconsistency emissivity block&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4497</span><span class="w">                         </span><span class="n">headElem_i</span><span class="p">,</span><span class="w"> </span><span class="n">fileIndex</span><span class="p">,</span><span class="w"> </span><span class="n">idata3</span><span class="w"></span>
<span class="linenos">4498</span><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Should not happen...&quot;</span><span class="w"></span>
<span class="linenos">4499</span><span class="w">                    </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_addCloudParametersandEmissivity&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4500</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">4501</span><span class="k">                  </span><span class="n">idata</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_RLN</span><span class="p">,</span><span class="n">idata3</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4502</span><span class="w">                  </span><span class="n">idatend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_NLV</span><span class="p">,</span><span class="n">idata3</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">idata</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4503</span><span class="w">                  </span><span class="k">do </span><span class="n">bodyIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idata</span><span class="p">,</span><span class="w"> </span><span class="n">idatend</span><span class="w"></span>
<span class="linenos">4504</span><span class="w">                    </span><span class="n">emisfc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="mf">0.d0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsspacedata</span><span class="p">,</span><span class="n">OBS_SEM</span><span class="p">,</span><span class="n">bodyIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4505</span><span class="w">                    </span><span class="n">ichn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">NINT</span><span class="p">(</span><span class="n">obs_bodyElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_PPP</span><span class="p">,</span><span class="n">bodyIndex</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4506</span><span class="w">                    </span><span class="n">ichn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">MAX</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">MIN</span><span class="p">(</span><span class="n">ichn</span><span class="p">,</span><span class="n">tvs_maxChannelNumber</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4507</span><span class="w">                    </span><span class="n">bl</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">valIndex</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">4508</span><span class="w">                      </span><span class="n">ichnb</span><span class="o">=</span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4509</span><span class="w">                           </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indchan</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4510</span><span class="w">                           </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4511</span><span class="w">                           </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4512</span><span class="w">                      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ichn</span><span class="o">==</span><span class="n">ichnb</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4513</span><span class="k">                        </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">emisfc</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4514</span><span class="w">                        </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indEmis</span><span class="p">,</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4515</span><span class="w">                                                 </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4516</span><span class="w">                        </span><span class="k">exit </span><span class="n">bl</span><span class="w"></span>
<span class="linenos">4517</span><span class="w">                      </span><span class="k">end if</span>
<span class="linenos">4518</span><span class="k">                    end do </span><span class="n">bl</span><span class="w"></span>
<span class="linenos">4519</span>
<span class="linenos">4520</span><span class="w">                  </span><span class="k">end do</span>
<span class="linenos">4521</span>
<span class="linenos">4522</span><span class="k">                  </span><span class="n">idata3</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idata3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4523</span>
<span class="linenos">4524</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">4525</span>
<span class="linenos">4526</span><span class="k">              end do</span>
<span class="linenos">4527</span>
<span class="linenos">4528</span><span class="k">            end if</span><span class="w"></span>
<span class="linenos">4529</span>
<span class="linenos">4530</span><span class="w">            </span><span class="c">! flag block (btyp = 0111 100011X XXXX)</span>
<span class="linenos">4531</span><span class="w">            </span><span class="c">! 0111 1000110 0000 = 15456</span>
<span class="linenos">4532</span><span class="w">            </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4533</span><span class="w">            </span><span class="n">btyp10flg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">483</span><span class="w"></span>
<span class="linenos">4534</span>
<span class="linenos">4535</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10flg</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4536</span><span class="k">              </span><span class="n">flag_passage4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4537</span>
<span class="linenos">4538</span><span class="w">              </span><span class="n">indEmis</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">255043</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4539</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indEmis</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4540</span><span class="k">                </span><span class="n">indEmis</span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4541</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4542</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block marqueur&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4543</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">indEmis</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">255043</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4544</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 255043&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4545</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">4546</span>
<span class="linenos">4547</span><span class="k">              do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">4548</span><span class="w">                </span><span class="k">do </span><span class="n">valIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">4549</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Tblval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4550</span><span class="w">                       </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indEmis</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4551</span><span class="w">                       </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4552</span><span class="w">                       </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4553</span><span class="w">                       </span><span class="n">TBLVAL</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4554</span><span class="w">                       </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4555</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Tblval 255043&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4556</span><span class="w">                </span><span class="k">end do</span>
<span class="linenos">4557</span><span class="k">              end do</span>
<span class="linenos">4558</span><span class="k">            end if</span><span class="w"></span>
<span class="linenos">4559</span>
<span class="linenos">4560</span><span class="w">            </span><span class="c">! O-P block (btyp = 0100 100011X XXXX)</span>
<span class="linenos">4561</span><span class="w">            </span><span class="c">! 0100 1000110 0000 = 9312</span>
<span class="linenos">4562</span><span class="w">            </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4563</span><span class="w">            </span><span class="n">btyp10omp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">291</span><span class="w"></span>
<span class="linenos">4564</span>
<span class="linenos">4565</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10omp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">14</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4566</span><span class="k">              </span><span class="n">flag_passage5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4567</span>
<span class="linenos">4568</span><span class="w">              </span><span class="n">indEmis</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">055043</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4569</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indEmis</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4570</span><span class="k">                </span><span class="n">indEmis</span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4571</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4572</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block O-P&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4573</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">nbele</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">055043</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4574</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 55043 #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4575</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">4576</span>
<span class="linenos">4577</span><span class="k">              do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">4578</span><span class="w">                </span><span class="k">do </span><span class="n">valIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">4579</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">indEmis</span><span class="p">,</span><span class="n">valIndex</span><span class="p">,</span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4580</span><span class="w">                </span><span class="k">end do</span>
<span class="linenos">4581</span><span class="k">              end do</span>
<span class="linenos">4582</span>
<span class="linenos">4583</span><span class="k">            end if</span>
<span class="linenos">4584</span>
<span class="linenos">4585</span><span class="k">          end if</span><span class="w"> </span><span class="c">! hyper Spectral</span>
<span class="linenos">4586</span>
<span class="linenos">4587</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isIdBurpInst</span><span class="p">(</span><span class="n">idatyp</span><span class="p">,</span><span class="s1">&#39;atms&#39;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">tvs_isIdBurpInst</span><span class="p">(</span><span class="n">idatyp</span><span class="p">,</span><span class="s1">&#39;amsua&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>
<span class="linenos">4588</span><span class="w">            </span><span class="c">! info block (btyp = 0001 100000X XXXX) </span>
<span class="linenos">4589</span><span class="w">            </span><span class="c">! 0001 100000X XXXX = 3072</span>
<span class="linenos">4590</span><span class="w">            </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4591</span><span class="w">            </span><span class="n">btyp10inf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">96</span><span class="w"></span>
<span class="linenos">4592</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10inf</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4593</span><span class="k">              </span><span class="n">flag_passage2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4594</span><span class="w">              </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="w"></span>
<span class="linenos">4595</span><span class="w">              </span><span class="c">! CLW</span>
<span class="linenos">4596</span><span class="w">              </span><span class="n">ind13209</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013209</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4597</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind13209</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4598</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4599</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4600</span><span class="w">                </span><span class="n">ind13209</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4601</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind13209</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013209</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4602</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 13209 #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4603</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4604</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4605</span>
<span class="linenos">4606</span><span class="w">              </span><span class="c">! clwFG</span>
<span class="linenos">4607</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyTtAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4608</span><span class="k">                </span><span class="n">indClwFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">clwFgElementId</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4609</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indClwFG</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4610</span><span class="k">                  call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4611</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #3&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4612</span><span class="w">                  </span><span class="n">indClwFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4613</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">indClwFG</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">clwFgElementId</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4614</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element clwFG #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4615</span><span class="w">                  </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4616</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">4617</span><span class="k">              end if</span><span class="w"></span>
<span class="linenos">4618</span>
<span class="linenos">4619</span><span class="w">              </span><span class="c">! SCATTERING INDEX</span>
<span class="linenos">4620</span><span class="w">              </span><span class="n">ind13208</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013208</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4621</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind13208</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4622</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4623</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #4&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4624</span><span class="w">                </span><span class="n">ind13208</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4625</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013208</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4626</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 013208&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4627</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4628</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4629</span>
<span class="linenos">4630</span><span class="w">              </span><span class="c">! siFG</span>
<span class="linenos">4631</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4632</span><span class="k">                </span><span class="n">indSiFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">siFgElementId</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4633</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indSiFG</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4634</span><span class="k">                  call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4635</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #5&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4636</span><span class="w">                  </span><span class="n">indSiFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4637</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">indSiFG</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">siFgElementId</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4638</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element siFG #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4639</span><span class="w">                  </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4640</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">4641</span><span class="k">              end if</span>
<span class="linenos">4642</span>
<span class="linenos">4643</span><span class="k">              </span><span class="n">ind008012</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">008012</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4644</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind008012</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: cannot find element 8012 in inputBlock #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4645</span>
<span class="linenos">4646</span><span class="w">              </span><span class="k">do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">4647</span>
<span class="linenos">4648</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">goodprof</span><span class="p">(</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4649</span>
<span class="linenos">4650</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">idata2</span><span class="p">)</span><span class="w">  </span><span class="o">/=</span><span class="w"> </span><span class="n">fileIndex</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4651</span><span class="k">                    </span><span class="n">headElem_i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4652</span><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;File Inconsistency &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">headElem_i</span><span class="p">,</span><span class="w"> </span><span class="n">fileIndex</span><span class="w"></span>
<span class="linenos">4653</span><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Should not happen...&quot;</span><span class="w"></span>
<span class="linenos">4654</span><span class="w">                    </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_addCloudParametersandEmissivity&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4655</span><span class="w">                  </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4656</span>
<span class="linenos">4657</span><span class="w">                  </span><span class="c">! clwObs</span>
<span class="linenos">4658</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_CLWO</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4659</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13209</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4660</span><span class="w">                  </span><span class="c">! clwFG</span>
<span class="linenos">4661</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyTtAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4662</span><span class="k">                    </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_CLWB</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4663</span><span class="w">                    </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indClwFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4664</span><span class="w">                  </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4665</span>
<span class="linenos">4666</span><span class="w">                  </span><span class="c">! siObs</span>
<span class="linenos">4667</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_SIO</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4668</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4669</span><span class="w">                                           </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">==</span><span class="n">mpc_missingValue_r4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4670</span><span class="w">                  </span><span class="c">! siFG</span>
<span class="linenos">4671</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4672</span><span class="k">                    </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_SIB</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4673</span><span class="w">                    </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indSiFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4674</span><span class="w">                                             </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">==</span><span class="n">mpc_missingValue_r4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4675</span><span class="w">                  </span><span class="k">end if               </span>
<span class="linenos">4676</span>
<span class="linenos">4677</span><span class="k">                  </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_STYP</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4678</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4679</span><span class="w">                  </span><span class="n">idata2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idata2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4680</span>
<span class="linenos">4681</span><span class="w">                </span><span class="k">else</span>
<span class="linenos">4682</span><span class="k">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0</span><span class="w"></span>
<span class="linenos">4683</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13209</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4684</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyTtAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4685</span><span class="k">                    call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indClwFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4686</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">4687</span>
<span class="linenos">4688</span><span class="k">                  call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4689</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4690</span><span class="k">                    call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indSiFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4691</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">4692</span><span class="k">                  </span>
<span class="linenos">4693</span><span class="k">                  call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4694</span>
<span class="linenos">4695</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">4696</span>
<span class="linenos">4697</span><span class="k">              end do</span>
<span class="linenos">4698</span><span class="k"> </span>
<span class="linenos">4699</span><span class="k">            end if</span>
<span class="linenos">4700</span><span class="k">          end if</span><span class="w"> </span><span class="c">! tvs_isIdBurpInst(idatyp,&#39;atms&#39;)) .or. (tvs_isIdBurpInst(idatyp,&#39;amsua&#39;)</span>
<span class="linenos">4701</span>
<span class="linenos">4702</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isIdBurpInst</span><span class="p">(</span><span class="n">idatyp</span><span class="p">,</span><span class="s1">&#39;amsub&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">tvs_isIdBurpInst</span><span class="p">(</span><span class="n">idatyp</span><span class="p">,</span><span class="s1">&#39;mhs&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"> </span>
<span class="linenos">4703</span><span class="w">            </span><span class="c">! info block (btyp = 0001 100000X XXXX) </span>
<span class="linenos">4704</span><span class="w">            </span><span class="c">! 0001 100000X XXXX = 3072</span>
<span class="linenos">4705</span><span class="w">            </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4706</span><span class="w">            </span><span class="n">btyp10inf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">96</span><span class="w"></span>
<span class="linenos">4707</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10inf</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4708</span><span class="k">              </span><span class="n">flag_passage2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4709</span><span class="w">              </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="w"></span>
<span class="linenos">4710</span>
<span class="linenos">4711</span><span class="w">              </span><span class="c">! SCATTERING INDEX</span>
<span class="linenos">4712</span><span class="w">              </span><span class="n">ind13208</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013208</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4713</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind13208</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4714</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4715</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #4&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4716</span><span class="w">                </span><span class="n">ind13208</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4717</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013208</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4718</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 013208&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4719</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4720</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4721</span>
<span class="linenos">4722</span><span class="w">              </span><span class="c">! siFG</span>
<span class="linenos">4723</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4724</span><span class="k">                </span><span class="n">indSiFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">siFgElementId</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4725</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indSiFG</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4726</span><span class="k">                  call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4727</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #5&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4728</span><span class="w">                  </span><span class="n">indSiFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4729</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">indSiFG</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">siFgElementId</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4730</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element siFG #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4731</span><span class="w">                  </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4732</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">4733</span><span class="k">              end if</span>
<span class="linenos">4734</span>
<span class="linenos">4735</span><span class="k">              </span><span class="n">ind008012</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">008012</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4736</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind008012</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: cannot find element 8012 in inputBlock #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4737</span>
<span class="linenos">4738</span><span class="w">              </span><span class="k">do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">4739</span>
<span class="linenos">4740</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">goodprof</span><span class="p">(</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4741</span>
<span class="linenos">4742</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">idata2</span><span class="p">)</span><span class="w">  </span><span class="o">/=</span><span class="w"> </span><span class="n">fileIndex</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4743</span><span class="k">                    </span><span class="n">headElem_i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4744</span><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;File Inconsistency &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">headElem_i</span><span class="p">,</span><span class="w"> </span><span class="n">fileIndex</span><span class="w"></span>
<span class="linenos">4745</span><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Should not happen...&quot;</span><span class="w"></span>
<span class="linenos">4746</span><span class="w">                    </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_addCloudParametersandEmissivity&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4747</span><span class="w">                  </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4748</span>
<span class="linenos">4749</span><span class="w">                  </span><span class="c">! siObs</span>
<span class="linenos">4750</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_SIO</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4751</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4752</span><span class="w">                                           </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">==</span><span class="n">mpc_missingValue_r4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4753</span><span class="w">                  </span><span class="c">! siFG</span>
<span class="linenos">4754</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4755</span><span class="k">                    </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_SIB</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4756</span><span class="w">                    </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indSiFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4757</span><span class="w">                                             </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">==</span><span class="n">mpc_missingValue_r4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4758</span><span class="w">                  </span><span class="k">end if               </span>
<span class="linenos">4759</span>
<span class="linenos">4760</span><span class="k">                  </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_STYP</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4761</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4762</span><span class="w">                  </span><span class="n">idata2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idata2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4763</span>
<span class="linenos">4764</span><span class="w">                </span><span class="k">else</span>
<span class="linenos">4765</span><span class="k">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mpc_missingValue_r4</span><span class="w"></span>
<span class="linenos">4766</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4767</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4768</span><span class="k">                    call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indSiFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4769</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">4770</span><span class="k">                  </span>
<span class="linenos">4771</span><span class="k">                  call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4772</span>
<span class="linenos">4773</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">4774</span>
<span class="linenos">4775</span><span class="k">              end do</span>
<span class="linenos">4776</span>
<span class="linenos">4777</span><span class="k">            end if</span>
<span class="linenos">4778</span><span class="k">          end if</span><span class="w"> </span><span class="c">! tvs_isIdBurpInst(idatyp,&#39;amsub&#39;) .or. tvs_isIdBurpInst(idatyp,&#39;mhs&#39;)</span>
<span class="linenos">4779</span>
<span class="linenos">4780</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isIdBurpInst</span><span class="p">(</span><span class="n">idatyp</span><span class="p">,</span><span class="s1">&#39;ssmis&#39;</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">4781</span><span class="w">            </span><span class="c">! info block (btyp = 0001 100000X XXXX) </span>
<span class="linenos">4782</span><span class="w">            </span><span class="c">! 0001 100000X XXXX = 3072</span>
<span class="linenos">4783</span><span class="w">            </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4784</span><span class="w">            </span><span class="n">btyp10inf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">96</span><span class="w"></span>
<span class="linenos">4785</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10inf</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4786</span><span class="k">              </span><span class="n">flag_passage2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4787</span><span class="w">              </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="w"></span>
<span class="linenos">4788</span>
<span class="linenos">4789</span><span class="w">              </span><span class="c">! LAND SEA QUALIFIER ELE 8012</span>
<span class="linenos">4790</span><span class="w">              </span><span class="n">ind008012</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">008012</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4791</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind008012</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4792</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4793</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #6&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4794</span><span class="w">                </span><span class="n">ind008012</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4795</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">008012</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4796</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 8012 ssmis&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4797</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4798</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4799</span>
<span class="linenos">4800</span><span class="w">              </span><span class="c">! TERRAIN TYPE ELE 13039</span>
<span class="linenos">4801</span><span class="w">              </span><span class="n">ind13039</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">13039</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4802</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind13039</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4803</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4804</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #7&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4805</span><span class="w">                </span><span class="n">ind13039</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4806</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind13039</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">13039</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4807</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 13039&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4808</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4809</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4810</span><span class="w">              </span>
<span class="linenos">4811</span><span class="w">              </span><span class="c">! SAT ZENITH ANGLE ELE 7024</span>
<span class="linenos">4812</span><span class="w">              </span><span class="n">ind7024</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">7024</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4813</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind7024</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4814</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4815</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #8&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4816</span><span class="w">                </span><span class="n">ind7024</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4817</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind7024</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">7024</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4818</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 7024&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4819</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4820</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4821</span><span class="w">              </span>
<span class="linenos">4822</span><span class="w">              </span><span class="c">! SAT AZIMUTH ANGLE ELE 5021</span>
<span class="linenos">4823</span><span class="w">              </span><span class="n">ind5021</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">5021</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4824</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind5021</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4825</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4826</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #9&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4827</span><span class="w">                </span><span class="n">ind5021</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4828</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind5021</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">5021</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4829</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 5021&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4830</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4831</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4832</span>
<span class="linenos">4833</span><span class="w">              </span><span class="c">! CLW</span>
<span class="linenos">4834</span><span class="w">              </span><span class="n">ind13209</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013209</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4835</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind13209</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4836</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4837</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #10&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4838</span><span class="w">                </span><span class="n">ind13209</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4839</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind13209</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013209</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4840</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 13209 #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4841</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4842</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4843</span>
<span class="linenos">4844</span><span class="w">              </span><span class="c">! clwFG</span>
<span class="linenos">4845</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyTtAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4846</span><span class="k">                </span><span class="n">indClwFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">clwFgElementId</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4847</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indClwFG</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4848</span><span class="k">                  call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4849</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #11&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4850</span><span class="w">                  </span><span class="n">indClwFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4851</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">indClwFG</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">clwFgElementId</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4852</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element clwFG #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4853</span><span class="w">                  </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4854</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">4855</span><span class="k">              end if</span><span class="w"></span>
<span class="linenos">4856</span>
<span class="linenos">4857</span><span class="w">              </span><span class="c">! SSMIS INTEGRATED WATER VAPOR </span>
<span class="linenos">4858</span><span class="w">              </span><span class="n">ind13095</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013095</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4859</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind13095</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4860</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4861</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #12&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4862</span><span class="w">                </span><span class="n">ind13095</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4863</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind13095</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013095</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4864</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 13095&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4865</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4866</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4867</span>
<span class="linenos">4868</span><span class="w">              </span><span class="c">! SCATERING INDEX</span>
<span class="linenos">4869</span><span class="w">              </span><span class="n">ind13208</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013208</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4870</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind13208</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4871</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4872</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #13&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4873</span><span class="w">                </span><span class="n">ind13208</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4874</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013208</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4875</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 13208&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4876</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4877</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4878</span>
<span class="linenos">4879</span><span class="w">              </span><span class="c">! siFG</span>
<span class="linenos">4880</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4881</span><span class="k">                </span><span class="n">indSiFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">siFgElementId</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4882</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indSiFG</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4883</span><span class="k">                  call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4884</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #14&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4885</span><span class="w">                  </span><span class="n">indSiFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4886</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">indSiFG</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">siFgElementId</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4887</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element siFG #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4888</span><span class="w">                  </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4889</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">4890</span><span class="k">              end if              </span>
<span class="linenos">4891</span>
<span class="linenos">4892</span><span class="k">              do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">4893</span>
<span class="linenos">4894</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">goodprof</span><span class="p">(</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4895</span>
<span class="linenos">4896</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">idata2</span><span class="p">)</span><span class="w">  </span><span class="o">/=</span><span class="w"> </span><span class="n">fileIndex</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4897</span><span class="k">                    </span><span class="n">headElem_i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4898</span><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;File Inconsistency &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">headElem_i</span><span class="p">,</span><span class="w"> </span><span class="n">fileIndex</span><span class="w"></span>
<span class="linenos">4899</span><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Should not happen...&quot;</span><span class="w"></span>
<span class="linenos">4900</span><span class="w">                    </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_addCloudParametersandEmissivity&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4901</span><span class="w">                  </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4902</span>
<span class="linenos">4903</span><span class="w">                  </span><span class="c">! clwObs</span>
<span class="linenos">4904</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_CLWO</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4905</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13209</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4906</span><span class="w">                  </span><span class="c">! clwFG</span>
<span class="linenos">4907</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyTtAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4908</span><span class="k">                    </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_CLWB</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4909</span><span class="w">                    </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indClwFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4910</span><span class="w">                  </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4911</span>
<span class="linenos">4912</span><span class="w">                  </span><span class="c">! siObs</span>
<span class="linenos">4913</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_SIO</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4914</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4915</span><span class="w">                                           </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">==</span><span class="n">mpc_missingValue_r4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4916</span><span class="w">                  </span><span class="c">! siFG</span>
<span class="linenos">4917</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4918</span><span class="k">                    </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_SIB</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4919</span><span class="w">                    </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indSiFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">4920</span><span class="w">                                             </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">==</span><span class="n">mpc_missingValue_r4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4921</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">4922</span><span class="k">                  </span>
<span class="linenos">4923</span><span class="k">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_IWV</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4924</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13095</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4925</span><span class="w">                  </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_STYP</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4926</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4927</span><span class="w">                  </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_TTYP</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4928</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">ind13039</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4929</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_SZA</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4930</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind7024</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4931</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_AZA</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4932</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind5021</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">4933</span><span class="w">                  </span><span class="n">idata2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idata2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4934</span><span class="w">                </span><span class="k">else</span>
<span class="linenos">4935</span><span class="k">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0</span><span class="w"></span>
<span class="linenos">4936</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13209</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4937</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyTtAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4938</span><span class="k">                    call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indClwFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4939</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">4940</span>
<span class="linenos">4941</span><span class="k">                  call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4942</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4943</span><span class="k">                    call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indSiFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4944</span><span class="w">                  </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4945</span>
<span class="linenos">4946</span><span class="w">                  </span><span class="c">!call Insert_into_burp_r4(-1.0,ind13095,1,tIndex)</span>
<span class="linenos">4947</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4948</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ind13039</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4949</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind7024</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4950</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind5021</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">4951</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">4952</span><span class="k">              end do</span>
<span class="linenos">4953</span><span class="k"> </span>
<span class="linenos">4954</span><span class="k">            end if</span>
<span class="linenos">4955</span><span class="k">          end if</span><span class="w"> </span><span class="c">! tvs_isIdBurpInst(idatyp,&#39;ssmis&#39;)</span>
<span class="linenos">4956</span>
<span class="linenos">4957</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isIdBurpInst</span><span class="p">(</span><span class="n">idatyp</span><span class="p">,</span><span class="s1">&#39;mwhs2&#39;</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">4958</span><span class="w">            </span><span class="c">! info block (btyp = 0001 100000X XXXX)</span>
<span class="linenos">4959</span><span class="w">            </span><span class="c">! 0001 100000X XXXX = 3072</span>
<span class="linenos">4960</span><span class="w">            </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4961</span><span class="w">            </span><span class="n">btyp10inf</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">96</span><span class="w"></span>
<span class="linenos">4962</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10inf</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4963</span><span class="k">              </span><span class="n">flag_passage2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4964</span><span class="w">              </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="w"></span>
<span class="linenos">4965</span>
<span class="linenos">4966</span><span class="w">              </span><span class="c">! LAND SEA QUALIFIER ELE 8012</span>
<span class="linenos">4967</span><span class="w">              </span><span class="n">ind008012</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">008012</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4968</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind008012</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4969</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4970</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #15&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4971</span><span class="w">                </span><span class="n">ind008012</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4972</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">008012</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4973</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 8012 ssmis&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4974</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4975</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4976</span>
<span class="linenos">4977</span><span class="w">              </span><span class="c">! TERRAIN TYPE ELE 13039</span>
<span class="linenos">4978</span><span class="w">              </span><span class="n">ind13039</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">13039</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4979</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind13039</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4980</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4981</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #16&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4982</span><span class="w">                </span><span class="n">ind13039</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4983</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind13039</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">13039</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4984</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 13039&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4985</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4986</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4987</span>
<span class="linenos">4988</span><span class="w">              </span><span class="c">! SPECIAL QC FLAG INTEGER</span>
<span class="linenos">4989</span><span class="w">              </span><span class="n">ind25174</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">025174</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4990</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind25174</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">4991</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4992</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #17&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4993</span><span class="w">                </span><span class="n">ind25174</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4994</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind25174</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">025174</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4995</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 25174&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">4996</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">4997</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">4998</span>
<span class="linenos">4999</span><span class="w">              </span><span class="c">! CLW</span>
<span class="linenos">5000</span><span class="w">              </span><span class="n">ind13209</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013209</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5001</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind13209</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5002</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5003</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #18&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5004</span><span class="w">                </span><span class="n">ind13209</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5005</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind13209</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013209</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5006</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 13209 #3&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5007</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5008</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">5009</span>
<span class="linenos">5010</span><span class="w">              </span><span class="c">! clwFG</span>
<span class="linenos">5011</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyTtAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5012</span><span class="k">                </span><span class="n">indClwFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">clwFgElementId</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5013</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indClwFG</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5014</span><span class="k">                  call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5015</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #19&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5016</span><span class="w">                  </span><span class="n">indClwFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5017</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">indClwFG</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">clwFgElementId</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5018</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element clwFG #3&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5019</span><span class="w">                  </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5020</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">5021</span><span class="k">              end if</span><span class="w"></span>
<span class="linenos">5022</span>
<span class="linenos">5023</span><span class="w">              </span><span class="c">! SCATERING INDEX</span>
<span class="linenos">5024</span><span class="w">              </span><span class="n">ind13208</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013208</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5025</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind13208</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5026</span><span class="k">                call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5027</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #20&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5028</span><span class="w">                </span><span class="n">ind13208</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5029</span><span class="w">                </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">013208</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5030</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element 13208&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5031</span><span class="w">                </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5032</span><span class="w">              </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">5033</span>
<span class="linenos">5034</span><span class="w">              </span><span class="c">! siFG</span>
<span class="linenos">5035</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5036</span><span class="k">                </span><span class="n">indSiFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">siFgElementId</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5037</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indSiFG</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5038</span><span class="k">                  call </span><span class="n">BURP_Resize_Block</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5039</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Resize_Block info #21&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5040</span><span class="w">                  </span><span class="n">indSiFG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5041</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="o">=</span><span class="n">indSiFG</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="n">siFgElementId</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5042</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Set_Element siFG #3&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5043</span><span class="w">                  </span><span class="n">indtmp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indtmp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5044</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">5045</span><span class="k">              end if</span>
<span class="linenos">5046</span>
<span class="linenos">5047</span><span class="k">              do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">5048</span>
<span class="linenos">5049</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">goodprof</span><span class="p">(</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5050</span>
<span class="linenos">5051</span><span class="k">                  if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">idata2</span><span class="p">)</span><span class="w">  </span><span class="o">/=</span><span class="w"> </span><span class="n">fileIndex</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5052</span><span class="k">                    </span><span class="n">headElem_i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="n">OBS_OTP</span><span class="p">,</span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5053</span><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;File Inconsistency &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">headElem_i</span><span class="p">,</span><span class="w"> </span><span class="n">fileIndex</span><span class="w"></span>
<span class="linenos">5054</span><span class="w">                    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Should not happen...&quot;</span><span class="w"></span>
<span class="linenos">5055</span><span class="w">                    </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_addCloudParametersandEmissivity&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5056</span><span class="w">                  </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">5057</span>
<span class="linenos">5058</span><span class="w">                  </span><span class="c">! clwObs</span>
<span class="linenos">5059</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_CLWO</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5060</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13209</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5061</span><span class="w">                  </span><span class="c">! clwFG</span>
<span class="linenos">5062</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyTtAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5063</span><span class="k">                    </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_CLWB</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5064</span><span class="w">                    </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indClwFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">&lt;</span><span class="mf">0.0</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5065</span><span class="w">                  </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">5066</span>
<span class="linenos">5067</span><span class="w">                  </span><span class="c">! siObs</span>
<span class="linenos">5068</span><span class="w">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_SIO</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5069</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5070</span><span class="w">                                           </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">==</span><span class="n">mpc_missingValue_r4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5071</span><span class="w">                  </span><span class="c">! siFG</span>
<span class="linenos">5072</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5073</span><span class="k">                    </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">sngl</span><span class="p">(</span><span class="n">obs_headElem_r</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_SIB</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5074</span><span class="w">                    </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indSiFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5075</span><span class="w">                                             </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">(</span><span class="n">val_r4</span><span class="o">==</span><span class="n">mpc_missingValue_r4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5076</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">5077</span>
<span class="linenos">5078</span><span class="k">                  </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_STYP</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5079</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5080</span><span class="w">                  </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_TTYP</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5081</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">ind13039</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5082</span><span class="w">                  </span><span class="n">val</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obs_headElem_i</span><span class="p">(</span><span class="n">obsSpaceData</span><span class="p">,</span><span class="w"> </span><span class="n">OBS_INFG</span><span class="p">,</span><span class="w"> </span><span class="n">idata2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5083</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="w"> </span><span class="n">ind25174</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5084</span><span class="w">                  </span><span class="n">idata2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idata2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5085</span><span class="w">                </span><span class="k">else</span>
<span class="linenos">5086</span><span class="k">                  </span><span class="n">val_r4</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mf">1.0</span><span class="w"></span>
<span class="linenos">5087</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13209</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">5088</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyTtAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5089</span><span class="k">                    call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indClwFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">5090</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">5091</span>
<span class="linenos">5092</span><span class="k">                  call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">ind13208</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">5093</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5094</span><span class="k">                    call </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">val_r4</span><span class="p">,</span><span class="w"> </span><span class="n">indSiFG</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">5095</span><span class="w">                  </span><span class="k">end if</span>
<span class="linenos">5096</span>
<span class="linenos">5097</span><span class="k">                  call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ind008012</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5098</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ind13039</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5099</span><span class="w">                  </span><span class="k">call </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ind25174</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5100</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">5101</span><span class="k">              end do</span>
<span class="linenos">5102</span>
<span class="linenos">5103</span><span class="k">            end if</span>
<span class="linenos">5104</span><span class="k">          end if</span><span class="w"> </span><span class="c">! tvs_isIdBurpInst(idatyp,&#39;mwhs2&#39;)</span>
<span class="linenos">5105</span>
<span class="linenos">5106</span><span class="w">          </span><span class="c">! Add block into new report</span>
<span class="linenos">5107</span>
<span class="linenos">5108</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">5120</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5109</span><span class="k">            call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5110</span><span class="w">                 </span><span class="n">ENCODE_BLOCK</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5111</span><span class="w">                 </span><span class="n">iostat</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5112</span><span class="w">          </span><span class="k">else</span>
<span class="linenos">5113</span><span class="k">            call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5114</span><span class="w">                 </span><span class="n">ENCODE_BLOCK</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5115</span><span class="w">                 </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5116</span><span class="w">                 </span><span class="n">iostat</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5117</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">5118</span><span class="k">          call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Write_Block&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5119</span><span class="w">        </span><span class="k">end do </span><span class="n">BLOCKS2</span><span class="w"></span>
<span class="linenos">5120</span>
<span class="linenos">5121</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">goodprof</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5122</span><span class="k">          deallocate</span><span class="w"> </span><span class="p">(</span><span class="n">goodprof</span><span class="p">,</span><span class="n">btobs</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5123</span><span class="w">        </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">5124</span><span class="w">        </span><span class="c">! Write new report into file        </span>
<span class="linenos">5125</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_Delete_Report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5126</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Delete_Report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5127</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_Write_Report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5128</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: BURP_Write_Report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5129</span><span class="w">      </span><span class="k">end do </span><span class="n">REPORTS</span><span class="w"></span>
<span class="linenos">5130</span><span class="w">      </span>
<span class="linenos">5131</span><span class="w">      </span><span class="k">deallocate</span><span class="p">(</span><span class="n">reportsToUpdate</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5132</span>
<span class="linenos">5133</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">tvs_isIdBurpHyperSpectral</span><span class="p">(</span><span class="n">idatyp</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5134</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag_passage1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5135</span><span class="k">          write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5136</span><span class="w">          </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ERROR - descriptor block not seen ? Verify btyp&#39;</span><span class="w"></span>
<span class="linenos">5137</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">5138</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag_passage2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5139</span><span class="k">          write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5140</span><span class="w">          </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ERROR - info block not seen ? Verify btyp&#39;</span><span class="w"></span>
<span class="linenos">5141</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">5142</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag_passage3</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5143</span><span class="k">          write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5144</span><span class="w">          </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ERROR - observation block not seen ? Verify btyp&#39;</span><span class="w"></span>
<span class="linenos">5145</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">5146</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag_passage4</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5147</span><span class="k">          write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5148</span><span class="w">          </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ERROR - flag block not seen ? Verify btyp&#39;</span><span class="w"></span>
<span class="linenos">5149</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">5150</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag_passage5</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5151</span><span class="k">          write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5152</span><span class="w">          </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ERROR - O-P block not seen ? Verify btyp&#39;</span><span class="w"></span>
<span class="linenos">5153</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">5154</span><span class="k">      else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isIdBurpInst</span><span class="p">(</span><span class="n">idatyp</span><span class="p">,</span><span class="s1">&#39;atms&#39;</span><span class="w"> </span><span class="p">))</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5155</span><span class="w">                </span><span class="p">(</span><span class="n">tvs_isIdBurpInst</span><span class="p">(</span><span class="n">idatyp</span><span class="p">,</span><span class="s1">&#39;amsua&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>
<span class="linenos">5156</span><span class="w">                </span><span class="p">(</span><span class="n">tvs_isIdBurpInst</span><span class="p">(</span><span class="n">idatyp</span><span class="p">,</span><span class="s1">&#39;ssmis&#39;</span><span class="p">))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then </span>
<span class="linenos">5157</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag_passage1</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5158</span><span class="k">          write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5159</span><span class="w">          </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ERROR - descriptor block not seen ? Verify btyp&#39;</span><span class="w"></span>
<span class="linenos">5160</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">5161</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">flag_passage2</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5162</span><span class="k">          write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5163</span><span class="w">          </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ERROR - info block not seen ? Verify btyp&#39;</span><span class="w"></span>
<span class="linenos">5164</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">5165</span><span class="k">      end if</span>
<span class="linenos">5166</span>
<span class="linenos">5167</span><span class="k">    end if</span><span class="w"> </span><span class="c">!! End of &#39;if ( count &gt; 0 )&#39;</span>
<span class="linenos">5168</span>
<span class="linenos">5169</span><span class="w">    </span><span class="k">call  </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5170</span>
<span class="linenos">5171</span><span class="w">  </span><span class="k">contains</span><span class="w"></span>
<span class="linenos">5172</span>
<span class="linenos">5173</span><span class="w">    </span><span class="c">!--------- cleanup -----</span>
<span class="linenos">5174</span><span class="w">    </span><span class="k">subroutine </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5175</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">5176</span><span class="k">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errors</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5177</span>
<span class="linenos">5178</span><span class="w">      </span><span class="n">errors</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5179</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">address</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5180</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">InputFile</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5181</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">InputReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5182</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">InputReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5183</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">InputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5184</span><span class="w">      </span><span class="c">!Should we abort here ?</span>
<span class="linenos">5185</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">errors</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: error while deallocating memory: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">5186</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">cleanup</span><span class="w"></span>
<span class="linenos">5187</span>
<span class="linenos">5188</span><span class="w">    </span><span class="c">!--------- handle_error -----</span>
<span class="linenos">5189</span><span class="w">    </span><span class="k">subroutine </span><span class="n">handle_error</span><span class="p">(</span><span class="n">icode</span><span class="p">,</span><span class="n">errormessage</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5190</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">5191</span><span class="k">      </span><span class="kt">character</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errormessage</span><span class="w"></span>
<span class="linenos">5192</span><span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">5193</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icode</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">burp_noerr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5194</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;error code&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">5195</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">BURP_STR_ERROR</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5196</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;history&quot;</span><span class="w"></span>
<span class="linenos">5197</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_STR_ERROR_HISTORY</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5198</span><span class="w">        </span><span class="k">call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5199</span><span class="w">        </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">errormessage</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5200</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">5201</span><span class="k">    end subroutine </span><span class="n">handle_error</span><span class="w"></span>
<span class="linenos">5202</span>
<span class="linenos">5203</span><span class="w">    </span><span class="c">!--------- insert_into_burp_r4 -----</span>
<span class="linenos">5204</span><span class="w">    </span><span class="k">subroutine </span><span class="n">Insert_into_burp_r4</span><span class="p">(</span><span class="n">r4val</span><span class="p">,</span><span class="w"> </span><span class="n">pele</span><span class="p">,</span><span class="w"> </span><span class="n">pval</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5205</span>
<span class="linenos">5206</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">5207</span>
<span class="linenos">5208</span><span class="k">      </span><span class="kt">real</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">r4val</span><span class="w"></span>
<span class="linenos">5209</span><span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pele</span><span class="w"></span>
<span class="linenos">5210</span><span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pval</span><span class="w"></span>
<span class="linenos">5211</span><span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pt</span><span class="w"></span>
<span class="linenos">5212</span><span class="w">      </span><span class="kt">logical</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="w"></span>
<span class="linenos">5213</span>
<span class="linenos">5214</span><span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">error</span><span class="w"></span>
<span class="linenos">5215</span><span class="w">      </span>
<span class="linenos">5216</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">valueIsMissing</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5217</span><span class="k">        call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5218</span><span class="w">             </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pele</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5219</span><span class="w">             </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pval</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5220</span><span class="w">             </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5221</span><span class="w">             </span><span class="n">RVAL</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">valBurpMissing_r4</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5222</span><span class="w">             </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5223</span><span class="w">      </span><span class="k">else</span>
<span class="linenos">5224</span><span class="k">        call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5225</span><span class="w">             </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pele</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5226</span><span class="w">             </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pval</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5227</span><span class="w">             </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5228</span><span class="w">             </span><span class="n">RVAL</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">r4val</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5229</span><span class="w">             </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5230</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">5231</span><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="n">burp_noerr</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5232</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Insert_into_burp_r4: r4val,pele,pval,pt,valueIsMissing&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">r4val</span><span class="p">,</span><span class="w"> </span><span class="n">pele</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5233</span><span class="w">                   </span><span class="n">pval</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="n">valueIsMissing</span><span class="w"></span>
<span class="linenos">5234</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: Insert_into_burp_r4&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5235</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">5236</span>
<span class="linenos">5237</span><span class="k">    end subroutine </span><span class="n">Insert_into_burp_r4</span><span class="w"></span>
<span class="linenos">5238</span>
<span class="linenos">5239</span><span class="w">    </span><span class="c">!--------- insert_into_burp_i -----</span>
<span class="linenos">5240</span><span class="w">    </span><span class="k">subroutine </span><span class="n">Insert_into_burp_i</span><span class="p">(</span><span class="w"> </span><span class="n">ival</span><span class="p">,</span><span class="w"> </span><span class="n">pele</span><span class="p">,</span><span class="w"> </span><span class="n">pval</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">5241</span><span class="w">      </span><span class="c">!</span>
<span class="linenos">5242</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">5243</span>
<span class="linenos">5244</span><span class="k">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ival</span><span class="w"></span>
<span class="linenos">5245</span><span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pele</span><span class="w"></span>
<span class="linenos">5246</span><span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pval</span><span class="w"></span>
<span class="linenos">5247</span><span class="w">      </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">pt</span><span class="w"></span>
<span class="linenos">5248</span>
<span class="linenos">5249</span><span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">error</span><span class="w"></span>
<span class="linenos">5250</span>
<span class="linenos">5251</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ival</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5252</span><span class="k">        call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5253</span><span class="w">             </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pele</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5254</span><span class="w">             </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pval</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5255</span><span class="w">             </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5256</span><span class="w">             </span><span class="n">RVAL</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">ival</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5257</span><span class="w">             </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5258</span><span class="w">      </span><span class="k">else</span>
<span class="linenos">5259</span><span class="k">        call </span><span class="n">BURP_Set_Rval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5260</span><span class="w">             </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pele</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5261</span><span class="w">             </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pval</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5262</span><span class="w">             </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">pt</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5263</span><span class="w">             </span><span class="n">RVAL</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">valBurpMissing_r4</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5264</span><span class="w">             </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5265</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">5266</span><span class="k">      </span>
<span class="linenos">5267</span><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="n">burp_noerr</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5268</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;Insert_into_burp_i: ival,pele,pval,pt&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ival</span><span class="p">,</span><span class="w"> </span><span class="n">pele</span><span class="p">,</span><span class="w"> </span><span class="n">pval</span><span class="p">,</span><span class="w"> </span><span class="n">pt</span><span class="w"></span>
<span class="linenos">5269</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addCloudParametersandEmissivity: Insert_into_burp_i&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5270</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">5271</span><span class="k">    end subroutine </span><span class="n">Insert_into_burp_i</span><span class="w"></span>
<span class="linenos">5272</span>
<span class="linenos">5273</span><span class="w">  </span><span class="k">end subroutine </span><span class="n">brpr_addCloudParametersandEmissivity</span><span class="w"></span>
<span class="linenos">5274</span>
<span class="linenos">5275</span><span class="w">  </span><span class="c">!--------------------------------------------------------------------------</span>
<span class="linenos">5276</span><span class="w">  </span><span class="c">! brpr_updateMissingObsFlags</span>
<span class="linenos">5277</span><span class="w">  </span><span class="c">!--------------------------------------------------------------------------</span>
<span class="linenos">5278</span><span class="w">  </span><span class="k">subroutine </span><span class="n">brpr_updateMissingObsFlags</span><span class="p">(</span><span class="w"> </span><span class="n">burpFile</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">5279</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">5280</span><span class="w">    </span><span class="c">!:Purpose: Open burp file and set missing data flags to 2048.</span>
<span class="linenos">5281</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">5282</span><span class="w">    </span><span class="k">implicit none</span><span class="w"></span>
<span class="linenos">5283</span>
<span class="linenos">5284</span><span class="w">    </span><span class="c">! Arguments:</span>
<span class="linenos">5285</span><span class="w">    </span><span class="kt">character</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">    </span><span class="kd">::</span><span class="w"> </span><span class="n">burpFile</span><span class="w"></span>
<span class="linenos">5286</span>
<span class="linenos">5287</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">5288</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">BURP_FILE</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">inputFile</span><span class="w"></span>
<span class="linenos">5289</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">BURP_RPT</span><span class="p">)</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="n">copyReport</span><span class="w"></span>
<span class="linenos">5290</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">BURP_BLOCK</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">inputBlock</span><span class="w"></span>
<span class="linenos">5291</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">btyp10</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w"> </span><span class="n">bfam</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"></span>
<span class="linenos">5292</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">btyp10obs</span><span class="p">,</span><span class="w"> </span><span class="n">btyp10flg</span><span class="w"></span>
<span class="linenos">5293</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">nb_rpts</span><span class="p">,</span><span class="w"> </span><span class="n">ref_rpt</span><span class="p">,</span><span class="w"> </span><span class="n">ref_blk</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span>
<span class="linenos">5294</span><span class="nb">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">address</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">5295</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">btobs</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">5296</span><span class="w">    </span><span class="kt">logical</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">goodTB</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">5297</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">5298</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">reportIndex</span><span class="w"></span>
<span class="linenos">5299</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">ind012163</span><span class="p">,</span><span class="n">ind212163</span><span class="w"></span>
<span class="linenos">5300</span><span class="w">    </span><span class="kt">integer</span><span class="w">                </span><span class="kd">::</span><span class="w"> </span><span class="n">flag_passage</span><span class="p">,</span><span class="w"> </span><span class="n">flagval</span><span class="w"></span>
<span class="linenos">5301</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span><span class="w">       </span><span class="kd">::</span><span class="w"> </span><span class="n">station_id</span><span class="w"></span>
<span class="linenos">5302</span>
<span class="linenos">5303</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;----------------------------------------------------------&#39;</span><span class="w"></span>
<span class="linenos">5304</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;-- Begin subroutine brpr_updateMissingObsFlags----&#39;</span><span class="w"></span>
<span class="linenos">5305</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;----------------------------------------------------------&#39;</span><span class="w"></span>
<span class="linenos">5306</span>
<span class="linenos">5307</span><span class="w">    </span><span class="c">! Initialisation</span>
<span class="linenos">5308</span><span class="w">    </span><span class="c">! Opening file</span>
<span class="linenos">5309</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;OPENED FILE = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">burpFile</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5310</span>
<span class="linenos">5311</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5312</span><span class="w">         </span><span class="n">FILENAME</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burpFile</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5313</span><span class="w">         </span><span class="n">MODE</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">FILE_ACC_APPEND</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5314</span><span class="w">         </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">5315</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_New inputFile&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5316</span><span class="w">    </span><span class="c">! Obtain input burp file number of reports</span>
<span class="linenos">5317</span>
<span class="linenos">5318</span><span class="w">    </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">NRPTS</span><span class="o">=</span><span class="n">nb_rpts</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5319</span>
<span class="linenos">5320</span><span class="w">    </span><span class="c">! Scan input burp file to get all reports address</span>
<span class="linenos">5321</span>
<span class="linenos">5322</span><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">address</span><span class="p">(</span><span class="n">nb_rpts</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5323</span><span class="w">    </span><span class="n">address</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5324</span><span class="w">    </span><span class="nb">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5325</span><span class="w">    </span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5326</span>
<span class="linenos">5327</span><span class="w">    </span><span class="k">do</span>
<span class="linenos">5328</span><span class="k">      </span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5329</span><span class="w">           </span><span class="n">report</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5330</span><span class="w">           </span><span class="n">SEARCH_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_rpt</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5331</span><span class="w">           </span><span class="n">iostat</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5332</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_Find_Report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5333</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">Exit</span>
<span class="linenos">5334</span>
<span class="linenos">5335</span><span class="k">      call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">STNID</span><span class="o">=</span><span class="n">station_id</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5336</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">station_id</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="o">==</span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">5337</span>
<span class="linenos">5338</span><span class="k">      </span><span class="nb">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5339</span><span class="w">      </span><span class="n">address</span><span class="p">(</span><span class="nb">count</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_rpt</span><span class="w"></span>
<span class="linenos">5340</span><span class="w">    </span><span class="k">end do</span>
<span class="linenos">5341</span>
<span class="linenos">5342</span><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5343</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;NUMBER OF REPORTS WITH OBSERVATIONS = &#39;</span><span class="p">,</span><span class="nb">count</span>
<span class="linenos">5344</span><span class="nb">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5345</span>
<span class="linenos">5346</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">5347</span>
<span class="linenos">5348</span><span class="w">      </span><span class="c">! Create a new report</span>
<span class="linenos">5349</span>
<span class="linenos">5350</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_New</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">ALLOC_SPACE</span><span class="o">=</span><span class="mi">20000000</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5351</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: Error creating new directory&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5352</span>
<span class="linenos">5353</span><span class="w">      </span><span class="c">! Loop on reports</span>
<span class="linenos">5354</span>
<span class="linenos">5355</span><span class="w">      </span><span class="n">REPORTS</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">reportIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span>
<span class="linenos">5356</span>
<span class="linenos">5357</span><span class="nb">        </span><span class="k">call </span><span class="n">BURP_Get_Report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5358</span><span class="w">             </span><span class="n">report</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5359</span><span class="w">             </span><span class="n">REF</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">(</span><span class="n">reportIndex</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5360</span><span class="w">             </span><span class="n">iostat</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5361</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_Get_Report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5362</span><span class="w">        </span><span class="c">! Find bad/missing TB. </span>
<span class="linenos">5363</span>
<span class="linenos">5364</span><span class="w">        </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5365</span>
<span class="linenos">5366</span><span class="w">        </span><span class="n">BLOCKS1</span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="linenos">5367</span>
<span class="linenos">5368</span><span class="k">          </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Block</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5369</span><span class="w">               </span><span class="k">BLOCK</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5370</span><span class="w">               </span><span class="n">SEARCH_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_blk</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5371</span><span class="w">               </span><span class="n">convert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5372</span><span class="w">               </span><span class="n">iostat</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5373</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_Find_Block #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5374</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_blk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">BLOCKS1</span><span class="w"></span>
<span class="linenos">5375</span>
<span class="linenos">5376</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5377</span><span class="w">               </span><span class="n">NELE</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5378</span><span class="w">               </span><span class="n">NVAL</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nvale</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5379</span><span class="w">               </span><span class="n">NT</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">nte</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5380</span><span class="w">               </span><span class="n">BFAM</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">bfam</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5381</span><span class="w">               </span><span class="n">BTYP</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5382</span><span class="w">               </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5383</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_Get_Property #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5384</span>
<span class="linenos">5385</span><span class="w">          </span><span class="c">! observation block (btyp = 0100 100011X XXXX)</span>
<span class="linenos">5386</span><span class="w">          </span><span class="c">! 0100 1000110 0000 = 9312</span>
<span class="linenos">5387</span><span class="w">          </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5388</span><span class="w">          </span><span class="n">btyp10obs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">291</span><span class="w"></span>
<span class="linenos">5389</span>
<span class="linenos">5390</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5391</span>
<span class="linenos">5392</span><span class="k">           </span><span class="n">ind012163</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">012163</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5393</span><span class="w">           </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ind012163</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">BLOCKS1</span><span class="w"></span>
<span class="linenos">5394</span><span class="w">           </span><span class="k">allocate</span><span class="p">(</span><span class="n">btobs</span><span class="p">(</span><span class="w"> </span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5395</span><span class="w">           </span><span class="k">allocate</span><span class="p">(</span><span class="n">goodTB</span><span class="p">(</span><span class="n">nvale</span><span class="p">,</span><span class="n">nte</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5396</span><span class="w">            </span><span class="n">goodTB</span><span class="p">(:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">5397</span><span class="w">            </span><span class="n">btobs</span><span class="p">(:,:)</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5398</span><span class="w">            </span><span class="k">do </span><span class="n">tIndex</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">5399</span><span class="w">              </span><span class="k">do </span><span class="n">valIndex</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">5400</span><span class="w">                </span><span class="n">btobs</span><span class="p">(</span><span class="n">valIndex</span><span class="p">,</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5401</span><span class="w">                     </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind012163</span><span class="p">,</span><span class="w">                         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5402</span><span class="w">                     </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w">                          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5403</span><span class="w">                     </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tIndex</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">5404</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btobs</span><span class="p">(</span><span class="n">valIndex</span><span class="p">,</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="n">goodTB</span><span class="p">(</span><span class="n">valIndex</span><span class="p">,</span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">5405</span><span class="w">              </span><span class="k">end do</span>
<span class="linenos">5406</span><span class="k">            end do</span>
<span class="linenos">5407</span>
<span class="linenos">5408</span><span class="k">          end if</span>
<span class="linenos">5409</span>
<span class="linenos">5410</span><span class="k">        end do </span><span class="n">BLOCKS1</span><span class="w"></span>
<span class="linenos">5411</span>
<span class="linenos">5412</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_copy_Header</span><span class="p">(</span><span class="n">TO</span><span class="o">=</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">FROM</span><span class="o">=</span><span class="n">inputReport</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5413</span>
<span class="linenos">5414</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_Init_Report_Write</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5415</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_Init_Report_Write&quot;</span><span class="p">)</span><span class="w">        </span>
<span class="linenos">5416</span>
<span class="linenos">5417</span><span class="w">        </span><span class="c">! Second loop on blocks</span>
<span class="linenos">5418</span>
<span class="linenos">5419</span><span class="w">        </span><span class="c">! to set missingFlag when not goodTB</span>
<span class="linenos">5420</span>
<span class="linenos">5421</span><span class="w">        </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5422</span>
<span class="linenos">5423</span><span class="w">        </span><span class="n">BLOCKS2</span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="linenos">5424</span>
<span class="linenos">5425</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">allocated</span><span class="p">(</span><span class="n">goodTB</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5426</span><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5427</span><span class="w">            </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Resume report is position # &#39;</span><span class="p">,</span><span class="n">reportIndex</span><span class="w"> </span>
<span class="linenos">5428</span><span class="w">            </span><span class="k">exit </span><span class="n">BLOCKS2</span><span class="w"></span>
<span class="linenos">5429</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">5430</span><span class="k">          </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Block</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5431</span><span class="w">               </span><span class="k">BLOCK</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5432</span><span class="w">               </span><span class="n">SEARCH_FROM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_blk</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5433</span><span class="w">               </span><span class="n">convert</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5434</span><span class="w">               </span><span class="n">iostat</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5435</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_Find_Block #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5436</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_blk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">BLOCKS2</span><span class="w"></span>
<span class="linenos">5437</span>
<span class="linenos">5438</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Get_Property</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5439</span><span class="w">               </span><span class="n">NELE</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5440</span><span class="w">               </span><span class="n">NVAL</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nvale</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5441</span><span class="w">               </span><span class="n">NT</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">nte</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5442</span><span class="w">               </span><span class="n">BFAM</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">bfam</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5443</span><span class="w">               </span><span class="n">BTYP</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5444</span><span class="w">               </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5445</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_Get_Property #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5446</span>
<span class="linenos">5447</span><span class="w">          </span><span class="c">! flag block (btyp = 0111 100011X XXXX)</span>
<span class="linenos">5448</span><span class="w">          </span><span class="c">! 0111 1000110 0000 = 15456</span>
<span class="linenos">5449</span><span class="w">          </span><span class="n">btyp10</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5450</span><span class="w">          </span><span class="n">btyp10flg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">483</span><span class="w"></span>
<span class="linenos">5451</span>
<span class="linenos">5452</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10flg</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5453</span><span class="k">            </span><span class="n">flag_passage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5454</span>
<span class="linenos">5455</span><span class="w">            </span><span class="n">ind212163</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Find_Element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="o">=</span><span class="mi">212163</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5456</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ind212163</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">ind212163</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: cannot find element 212163 in inputBlock&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5457</span>
<span class="linenos">5458</span><span class="w">            </span><span class="k">do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">5459</span><span class="w">              </span><span class="k">do </span><span class="n">valIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">5460</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">goodTB</span><span class="p">(</span><span class="n">valIndex</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5461</span><span class="k">                  </span><span class="n">flagval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">BURP_Get_Tblval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5462</span><span class="w">                          </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind212163</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5463</span><span class="w">                          </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5464</span><span class="w">                          </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5465</span><span class="w">                          </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5466</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_Get_Tblval pour ind212163&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5467</span><span class="w">                  </span><span class="n">flagval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ibset</span><span class="p">(</span><span class="n">flagval</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5468</span><span class="w">                  </span><span class="n">flagval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ibset</span><span class="p">(</span><span class="n">flagval</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5469</span><span class="w">                  </span><span class="n">flagval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ibset</span><span class="p">(</span><span class="n">flagval</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5470</span><span class="w">                  </span><span class="k">call </span><span class="n">BURP_Set_Tblval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5471</span><span class="w">                       </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ind212163</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5472</span><span class="w">                       </span><span class="n">NVAL_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5473</span><span class="w">                       </span><span class="n">NT_IND</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5474</span><span class="w">                       </span><span class="n">TBLVAL</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">flagval</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5475</span><span class="w">                       </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5476</span><span class="w">                  </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_Set_Tblval pour ind212163&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5477</span><span class="w">                </span><span class="k">end if</span>
<span class="linenos">5478</span><span class="k">              end do</span>
<span class="linenos">5479</span><span class="k">            end do</span>
<span class="linenos">5480</span><span class="k">          end if</span><span class="w"></span>
<span class="linenos">5481</span><span class="w">          </span><span class="c">! Add block into new report</span>
<span class="linenos">5482</span><span class="w">          </span><span class="k">call </span><span class="n">BURP_Write_Block</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5483</span><span class="w">               </span><span class="n">ENCODE_BLOCK</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5484</span><span class="w">               </span><span class="n">CONVERT_BLOCK</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5485</span><span class="w">               </span><span class="n">iostat</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5486</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="o">/=</span><span class="n">burp_noerr</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5487</span><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s2">&quot;Btyp= &quot;</span><span class="p">,</span><span class="n">btyp</span><span class="w"></span>
<span class="linenos">5488</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_Write_Block&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5489</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">5490</span><span class="k">        end do </span><span class="n">BLOCKS2</span><span class="w"></span>
<span class="linenos">5491</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">goodTB</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5492</span><span class="k">          deallocate</span><span class="p">(</span><span class="n">goodTB</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5493</span><span class="w">          </span><span class="k">deallocate</span><span class="p">(</span><span class="n">btobs</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5494</span><span class="w">        </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">5495</span><span class="w">        </span><span class="c">! Write new report into file        </span>
<span class="linenos">5496</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_Delete_Report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5497</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_Delete_Report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5498</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_Write_Report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5499</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: BURP_Write_Report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5500</span><span class="w">      </span><span class="k">end do </span><span class="n">REPORTS</span><span class="w"></span>
<span class="linenos">5501</span><span class="w">    </span><span class="k">end if</span><span class="w"> </span><span class="c">!! End of &#39;if ( count &gt; 0 )&#39;</span>
<span class="linenos">5502</span>
<span class="linenos">5503</span><span class="w">    </span><span class="k">call  </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5504</span>
<span class="linenos">5505</span><span class="w">  </span><span class="k">contains</span><span class="w"></span>
<span class="linenos">5506</span>
<span class="linenos">5507</span><span class="w">    </span><span class="c">!--------- cleanup -----</span>
<span class="linenos">5508</span><span class="w">    </span><span class="k">subroutine </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5509</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">5510</span><span class="k">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errors</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5511</span>
<span class="linenos">5512</span><span class="w">      </span><span class="n">errors</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5513</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">address</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5514</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">InputFile</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5515</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">InputReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5516</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">CopyReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5517</span><span class="w">      </span><span class="k">call </span><span class="n">BURP_Free</span><span class="p">(</span><span class="n">InputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5518</span><span class="w">      </span><span class="c">!Should we abort here ?</span>
<span class="linenos">5519</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">errors</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;brpr_updateMissingObsFlags: error while deallocating memory: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">5520</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">cleanup</span><span class="w"></span>
<span class="linenos">5521</span>
<span class="linenos">5522</span><span class="w">    </span><span class="c">!--------- handle_error -----</span>
<span class="linenos">5523</span><span class="w">    </span><span class="k">subroutine </span><span class="n">handle_error</span><span class="p">(</span><span class="n">icode</span><span class="p">,</span><span class="n">errormessage</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5524</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">5525</span><span class="k">      </span><span class="kt">character</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errormessage</span><span class="w"></span>
<span class="linenos">5526</span><span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">5527</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icode</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">burp_noerr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5528</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;error code&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">5529</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">BURP_STR_ERROR</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5530</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;history&quot;</span><span class="w"></span>
<span class="linenos">5531</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_STR_ERROR_HISTORY</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5532</span><span class="w">        </span><span class="k">call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5533</span><span class="w">        </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">errormessage</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5534</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">5535</span><span class="k">    end subroutine </span><span class="n">handle_error</span><span class="w"></span>
<span class="linenos">5536</span><span class="w">    </span>
<span class="linenos">5537</span><span class="w">  </span><span class="k">end subroutine </span><span class="n">brpr_updateMissingObsFlags</span><span class="w"></span>
<span class="linenos">5538</span>
<span class="linenos">5539</span>
<span class="linenos">5540</span><span class="w">  </span><span class="c">!-----------------------------------------------------------------------</span>
<span class="linenos">5541</span><span class="w">  </span><span class="c">! brpr_addElementsToBurp</span>
<span class="linenos">5542</span><span class="w">  </span><span class="c">!-----------------------------------------------------------------------</span>
<span class="linenos">5543</span><span class="w">  </span><span class="k">subroutine </span><span class="n">brpr_addElementsToBurp</span><span class="p">(</span><span class="n">inputFileName</span><span class="p">,</span><span class="w"> </span><span class="n">familyType</span><span class="p">,</span><span class="w"> </span><span class="n">beSilent_opt</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5544</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">5545</span><span class="w">    </span><span class="c">!:Purpose: to add element(s) for bias correction to data block of DERIALT BURP file</span>
<span class="linenos">5546</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">5547</span><span class="w">    </span><span class="k">implicit none</span><span class="w"></span>
<span class="linenos">5548</span><span class="w">    </span><span class="c">!Arguments:</span>
<span class="linenos">5549</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">inputFileName</span><span class="w"></span>
<span class="linenos">5550</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">familyType</span><span class="w"></span>
<span class="linenos">5551</span><span class="w">    </span><span class="kt">logical</span><span class="p">,</span><span class="w"> </span><span class="k">optional</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">beSilent_opt</span><span class="w"></span>
<span class="linenos">5552</span><span class="w">    </span><span class="c">!Locals:</span>
<span class="linenos">5553</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">burp_file</span><span class="p">)</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">inputFile</span><span class="w"></span>
<span class="linenos">5554</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">burp_rpt</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">copyReport</span><span class="w"></span>
<span class="linenos">5555</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">burp_block</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">inputBlock</span><span class="w"></span>
<span class="linenos">5556</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">nb_rpts</span><span class="p">,</span><span class="w"> </span><span class="n">ref_rpt</span><span class="p">,</span><span class="w"> </span><span class="n">ref_blk</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span>
<span class="linenos">5557</span><span class="nb">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">address</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">5558</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w"> </span><span class="n">nvale</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">5559</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w"> </span><span class="n">reportIndex</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w"> </span><span class="n">idatyp</span><span class="p">,</span><span class="w"> </span><span class="n">bfam</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"></span>
<span class="linenos">5560</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">ind</span><span class="p">,</span><span class="w"> </span><span class="n">indele</span><span class="p">,</span><span class="w"> </span><span class="n">nsize</span><span class="p">,</span><span class="w"> </span><span class="n">iun_burpin</span><span class="w"></span>
<span class="linenos">5561</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">nulnam</span><span class="w"></span>
<span class="linenos">5562</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">station_id</span><span class="w"></span>
<span class="linenos">5563</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">opt_missing</span><span class="o">=</span><span class="s1">&#39;MISSING&#39;</span><span class="w"></span>
<span class="linenos">5564</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="n">codtyp_name_length</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">instrumName</span><span class="w"></span>
<span class="linenos">5565</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">instrumID</span><span class="p">,</span><span class="w"> </span><span class="n">previousInstrumID</span><span class="w"></span>
<span class="linenos">5566</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">icodele</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5567</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">icodeleMrq</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">5568</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">btClearMrqElementID</span><span class="w"></span>
<span class="linenos">5569</span><span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">val_option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">999</span><span class="mf">9.0</span><span class="w"></span>
<span class="linenos">5570</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">external</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">mrfmxl</span><span class="w"></span>
<span class="linenos">5571</span><span class="w">    </span><span class="kt">logical</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">isDerialt</span><span class="w"></span>
<span class="linenos">5572</span><span class="w">    </span><span class="kt">logical</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">isInstrumUsingCLW</span><span class="p">,</span><span class="w"> </span><span class="n">isInstrumUsingHydrometeors</span><span class="w"> </span>
<span class="linenos">5573</span><span class="w">    </span><span class="kt">logical</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">beSilent</span><span class="w"></span>
<span class="linenos">5574</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">nElem</span><span class="p">,</span><span class="w"> </span><span class="n">elemIndex</span><span class="p">,</span><span class="w"> </span><span class="n">burpIndex</span><span class="w"></span>
<span class="linenos">5575</span>
<span class="linenos">5576</span><span class="w">    </span><span class="k">namelist</span><span class="w"> </span><span class="o">/</span><span class="n">NAMADDTOBURP</span><span class="o">/</span><span class="w"> </span><span class="n">addBtClearToBurp</span><span class="p">,</span><span class="w"> </span><span class="n">clwFgElementId</span><span class="p">,</span><span class="w"> </span><span class="n">siFgElementId</span><span class="p">,</span><span class="w"> </span><span class="n">btClearElementId</span><span class="w"></span>
<span class="linenos">5577</span>
<span class="linenos">5578</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;-----------------------------------------------&#39;</span><span class="w"></span>
<span class="linenos">5579</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;- begin brpr_addElementsToBurp -&#39;</span><span class="w"></span>
<span class="linenos">5580</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;-----------------------------------------------&#39;</span><span class="w"></span>
<span class="linenos">5581</span><span class="w"> </span>
<span class="linenos">5582</span><span class="w">    </span><span class="n">icodele</span><span class="p">(:)</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5583</span><span class="w">    </span><span class="n">icodeleMrq</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5584</span><span class="w">    </span>
<span class="linenos">5585</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">present</span><span class="p">(</span><span class="n">beSilent_opt</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5586</span><span class="k">      </span><span class="n">beSilent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beSilent_opt</span><span class="w"></span>
<span class="linenos">5587</span><span class="w">    </span><span class="k">else</span>
<span class="linenos">5588</span><span class="k">      </span><span class="n">beSilent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">5589</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">5590</span>
<span class="linenos">5591</span><span class="k">    select case</span><span class="p">(</span><span class="n">familyType</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5592</span><span class="w">    </span><span class="k">case</span><span class="p">(</span><span class="s2">&quot;TO&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5593</span><span class="w">      </span><span class="n">nElem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5594</span><span class="w">      </span><span class="n">icodele</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">12233</span><span class="w"></span>
<span class="linenos">5595</span><span class="w">    </span><span class="k">case</span><span class="p">(</span><span class="s2">&quot;GP&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5596</span><span class="w">      </span><span class="n">nElem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5597</span><span class="w">      </span><span class="n">icodele</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">15234</span><span class="w"></span>
<span class="linenos">5598</span><span class="w">    </span><span class="k">case</span><span class="p">(</span><span class="s2">&quot;UA&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5599</span><span class="w">      </span><span class="n">nElem</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"></span>
<span class="linenos">5600</span><span class="w">      </span><span class="n">icodele</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="mi">12204</span><span class="p">,</span><span class="mi">12243</span><span class="o">/</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5601</span><span class="w">    </span><span class="k">case </span><span class="n">default</span><span class="w"></span>
<span class="linenos">5602</span><span class="w">      </span><span class="k">return</span>
<span class="linenos">5603</span><span class="k">    end select</span>
<span class="linenos">5604</span>
<span class="linenos">5605</span><span class="k">    </span><span class="n">icodeleMrq</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="mi">200000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">icodele</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nElem</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5606</span>
<span class="linenos">5607</span><span class="w">    </span><span class="c">! Read the NAMADDTOBURP namelist (if it exists)</span>
<span class="linenos">5608</span><span class="w">    </span>
<span class="linenos">5609</span><span class="w">    </span><span class="n">addBtClearToBurp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">5610</span><span class="w">    </span><span class="n">clwFgElementId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span>
<span class="linenos">5611</span><span class="w">    </span><span class="n">siFgElementId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"> </span>
<span class="linenos">5612</span><span class="w">    </span><span class="n">btClearElementId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5613</span><span class="w">    </span><span class="n">btClearMrqElementID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">200001</span><span class="w"></span>
<span class="linenos">5614</span><span class="w">    </span>
<span class="linenos">5615</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">familyType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;TO&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5616</span><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="n">utl_isNamelistPresent</span><span class="p">(</span><span class="s1">&#39;NAMADDTOBURP&#39;</span><span class="p">,</span><span class="s1">&#39;./flnml&#39;</span><span class="p">))</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">5617</span><span class="w">        </span><span class="c">! read the namelist</span>
<span class="linenos">5618</span><span class="w">        </span><span class="n">nulnam</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5619</span><span class="w">        </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fnom</span><span class="p">(</span><span class="n">nulnam</span><span class="p">,</span><span class="s1">&#39;./flnml&#39;</span><span class="p">,</span><span class="s1">&#39;FTN+SEQ+R/O&#39;</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5620</span><span class="w">        </span><span class="k">read</span><span class="p">(</span><span class="n">nulnam</span><span class="p">,</span><span class="w"> </span><span class="n">nml</span><span class="o">=</span><span class="n">NAMADDTOBURP</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5621</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_addElementsToBurp: Error reading namelist&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5622</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">nml</span><span class="o">=</span><span class="n">NAMADDTOBURP</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5623</span><span class="w">        </span><span class="n">error</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fclos</span><span class="p">(</span><span class="n">nulnam</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5624</span><span class="w">      </span><span class="k">else</span>
<span class="linenos">5625</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5626</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_addElementsToBurp: Namelist block NAMADDTOBURP is missing in the namelist.&#39;</span><span class="w"></span>
<span class="linenos">5627</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;                               The default value will be taken.&#39;</span><span class="w"></span>
<span class="linenos">5628</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="n">nml</span><span class="o">=</span><span class="n">NAMADDTOBURP</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5629</span><span class="w">      </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">5630</span>
<span class="linenos">5631</span><span class="w">      </span><span class="c">! check clear-sky radiance element is in the namelist</span>
<span class="linenos">5632</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">addBtClearToBurp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">btClearElementId</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5633</span><span class="k">        call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_addElementsToBurp: btClearElementId missing in the namelist&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5634</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">5635</span>
<span class="linenos">5636</span><span class="k">      </span><span class="n">btClearMrqElementID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">200000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">btClearElementId</span><span class="w"></span>
<span class="linenos">5637</span><span class="w">    </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">5638</span>
<span class="linenos">5639</span><span class="w">    </span><span class="c">! initialisation</span>
<span class="linenos">5640</span><span class="w">    </span><span class="c">! --------------</span>
<span class="linenos">5641</span><span class="w">    </span><span class="k">call </span><span class="n">burp_set_options</span><span class="p">(</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5642</span><span class="w">         </span><span class="n">real_optname</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">opt_missing</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5643</span><span class="w">         </span><span class="n">real_optname_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">val_option</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5644</span><span class="w">         </span><span class="n">iostat</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">5645</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_set_options&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5646</span>
<span class="linenos">5647</span><span class="w">    </span><span class="k">call </span><span class="n">burp_init</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5648</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_init inputFile&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5649</span><span class="w">    </span><span class="k">call </span><span class="n">burp_init</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="n">copyReport</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5650</span><span class="w">    </span><span class="k">call </span><span class="n">burp_init</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5651</span>
<span class="linenos">5652</span><span class="w">    </span><span class="c">! opening file</span>
<span class="linenos">5653</span><span class="w">    </span><span class="c">! ------------</span>
<span class="linenos">5654</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;opened file = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="w"> </span><span class="n">inputFileName</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">5655</span>
<span class="linenos">5656</span><span class="w">    </span><span class="k">call </span><span class="n">burp_new</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5657</span><span class="w">         </span><span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inputFileName</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5658</span><span class="w">         </span><span class="n">mode</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">file_acc_append</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5659</span><span class="w">         </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">5660</span><span class="w">  </span>
<span class="linenos">5661</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">error</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">burp_noerr</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5662</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;cannot open BURP input file &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">inputFileName</span><span class="w"></span>
<span class="linenos">5663</span><span class="w">      </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_addElementsToBurp&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5664</span><span class="w">    </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">5665</span>
<span class="linenos">5666</span><span class="w">    </span><span class="c">! obtain input burp file number of reports</span>
<span class="linenos">5667</span><span class="w">    </span><span class="c">! ----------------------------------------</span>
<span class="linenos">5668</span><span class="w">    </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">nrpts</span><span class="o">=</span><span class="n">nb_rpts</span><span class="p">,</span><span class="w"> </span><span class="n">io_unit</span><span class="o">=</span><span class="w"> </span><span class="n">iun_burpin</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5669</span>
<span class="linenos">5670</span><span class="w">    </span><span class="n">nsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mrfmxl</span><span class="p">(</span><span class="n">iun_burpin</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5671</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">addBtClearToBurp</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5672</span><span class="k">      </span><span class="n">nsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsize</span><span class="w"></span>
<span class="linenos">5673</span><span class="w">    </span><span class="k">else</span>
<span class="linenos">5674</span><span class="k">      </span><span class="n">nsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">nsize</span><span class="w"></span>
<span class="linenos">5675</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">5676</span>
<span class="linenos">5677</span><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;nsize= &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">nsize</span><span class="w"></span>
<span class="linenos">5678</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">5679</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;number of reports with observations in input file = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nb_rpts</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5680</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">5681</span>
<span class="linenos">5682</span><span class="w">    </span><span class="c">! scan input burp file to get all reports address</span>
<span class="linenos">5683</span><span class="w">    </span><span class="c">! -----------------------------------------------</span>
<span class="linenos">5684</span><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">address</span><span class="p">(</span><span class="n">nb_rpts</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5685</span><span class="w">    </span><span class="n">address</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5686</span><span class="w">    </span><span class="nb">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5687</span><span class="w">    </span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5688</span><span class="w">    </span><span class="n">isDerialt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">5689</span><span class="w">    </span><span class="n">previousInstrumID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5690</span><span class="w">    </span><span class="k">do</span>
<span class="linenos">5691</span><span class="k">      </span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_find_report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5692</span><span class="w">           </span><span class="n">report</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w">       </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5693</span><span class="w">           </span><span class="n">search_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_rpt</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5694</span><span class="w">           </span><span class="n">iostat</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5695</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_rpt</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="linenos">5696</span><span class="k">      </span><span class="nb">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5697</span><span class="w">      </span><span class="n">address</span><span class="p">(</span><span class="nb">count</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_rpt</span><span class="w"></span>
<span class="linenos">5698</span>
<span class="linenos">5699</span><span class="w">      </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">stnid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">station_id</span><span class="p">,</span><span class="w"> </span><span class="n">idtyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idatyp</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">5700</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">station_id</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;&gt;&gt;DERIALT&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">isDerialt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">5701</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">station_id</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;&gt;&gt;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">5702</span><span class="k">      </span>
<span class="linenos">5703</span><span class="k">      if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">familyType</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;TO&quot;</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5704</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">beSilent</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5705</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5706</span><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_addElementsToBurp: tvs_mwAllskyAssim =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">tvs_mwAllskyAssim</span><span class="w"></span>
<span class="linenos">5707</span><span class="w">            </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_addElementsToBurp: clwFgElementId =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">clwFgElementId</span><span class="w"> </span>
<span class="linenos">5708</span><span class="w">            </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_addElementsToBurp: siFgElementId =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">siFgElementId</span><span class="w"> </span>
<span class="linenos">5709</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">5710</span>
<span class="linenos">5711</span><span class="k">          </span><span class="n">instrumName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5712</span><span class="w">          </span><span class="n">instrumID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">instrumName</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5713</span><span class="w">          </span><span class="n">isInstrumUsingCLW</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tvs_isInstrumUsingCLW</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">instrumName</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5714</span><span class="w">          </span><span class="n">isInstrumUsingHydrometeors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tvs_isInstrumUsingHydrometeors</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">instrumName</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5715</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">instrumID</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">previousInstrumID</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5716</span><span class="k">            write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_addElementsToBurp: for report count =&#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5717</span><span class="w">              </span><span class="s1">&#39;, instrumentName=&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">instrumName</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5718</span><span class="w">              </span><span class="s1">&#39;, instrumentId =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">instrumID</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5719</span><span class="w">              </span><span class="s1">&#39;, isInstrumUsingCLW =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">isInstrumUsingCLW</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5720</span><span class="w">              </span><span class="s1">&#39;, isInstrumUsingHydrometeors =&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">isInstrumUsingHydrometeors</span><span class="w"></span>
<span class="linenos">5721</span><span class="w">            </span><span class="n">previousInstrumID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">instrumID</span><span class="w"></span>
<span class="linenos">5722</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">5723</span><span class="k">        end if</span><span class="w"></span>
<span class="linenos">5724</span>
<span class="linenos">5725</span><span class="w">        </span><span class="c">! check clwFG element is in the namelist in all-sky mode.</span>
<span class="linenos">5726</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyTtAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">)))</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5727</span><span class="w">            </span><span class="n">clwFgElementId</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5728</span><span class="k">          call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_addElementsToBurp: clwFgElementId missing in the namelist&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5729</span><span class="w">        </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">5730</span>
<span class="linenos">5731</span><span class="w">        </span><span class="c">! check siFG element is in the namelist in all-sky mode.</span>
<span class="linenos">5732</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">)))</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5733</span><span class="w">            </span><span class="n">siFgElementId</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5734</span><span class="k">          call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;brpr_addElementsToBurp: siFgElementId missing in the namelist&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5735</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">5736</span><span class="k">      end if</span>
<span class="linenos">5737</span><span class="k">      </span>
<span class="linenos">5738</span><span class="k">    end do</span>
<span class="linenos">5739</span>
<span class="linenos">5740</span><span class="k">    if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="nb">count</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">isDerialt</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5741</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: modifying file...&quot;</span><span class="w"></span>
<span class="linenos">5742</span><span class="w">     </span>
<span class="linenos">5743</span>
<span class="linenos">5744</span>
<span class="linenos">5745</span><span class="w">      </span><span class="c">! create a new report</span>
<span class="linenos">5746</span><span class="w">      </span><span class="c">! ------------------     </span>
<span class="linenos">5747</span><span class="w">      </span><span class="k">call </span><span class="n">burp_new</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">alloc_space</span><span class="o">=</span><span class="n">nsize</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5748</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_new problem allocating copyReport&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5749</span>
<span class="linenos">5750</span><span class="w">      </span><span class="c">! loop on reports</span>
<span class="linenos">5751</span><span class="w">      </span><span class="c">! ---------------</span>
<span class="linenos">5752</span><span class="w">      </span><span class="n">reports</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">reportIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nb">count</span>
<span class="linenos">5753</span><span class="nb">    </span>
<span class="linenos">5754</span><span class="nb">        </span><span class="k">call </span><span class="n">burp_get_report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w">        </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5755</span><span class="w">             </span><span class="n">report</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5756</span><span class="w">             </span><span class="n">ref</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">(</span><span class="n">reportIndex</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5757</span><span class="w">             </span><span class="n">iostat</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w">      </span>
<span class="linenos">5758</span>
<span class="linenos">5759</span><span class="w">        </span><span class="k">call </span><span class="n">burp_copy_header</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="n">copyReport</span><span class="p">,</span><span class="n">from</span><span class="o">=</span><span class="n">inputReport</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5760</span><span class="w">        </span>
<span class="linenos">5761</span><span class="w">        </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">stnid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">station_id</span><span class="p">,</span><span class="w"> </span><span class="n">idtyp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">idatyp</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">5762</span>
<span class="linenos">5763</span><span class="w">        </span><span class="k">call </span><span class="n">burp_init_report_write</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5764</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_init_report_write&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5765</span>
<span class="linenos">5766</span><span class="w">        </span><span class="c">! loop on blocks</span>
<span class="linenos">5767</span><span class="w">        </span><span class="c">! --------------------</span>
<span class="linenos">5768</span><span class="w">        </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5769</span><span class="w">      </span>
<span class="linenos">5770</span><span class="w">        </span><span class="n">blocks</span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="linenos">5771</span>
<span class="linenos">5772</span><span class="k">          </span><span class="n">ref_blk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_find_block</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5773</span><span class="w">               </span><span class="k">block</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5774</span><span class="w">               </span><span class="n">search_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ref_blk</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5775</span><span class="w">               </span><span class="n">iostat</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5776</span>
<span class="linenos">5777</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ref_blk</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">blocks</span><span class="w"></span>
<span class="linenos">5778</span><span class="w">         </span>
<span class="linenos">5779</span><span class="w">          </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5780</span><span class="w">               </span><span class="n">nele</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5781</span><span class="w">               </span><span class="n">nval</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">nvale</span><span class="p">,</span><span class="w">               </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5782</span><span class="w">               </span><span class="n">nt</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">nte</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5783</span><span class="w">               </span><span class="n">bfam</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">bfam</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5784</span><span class="w">               </span><span class="n">btyp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"> </span>
<span class="linenos">5785</span><span class="w">               </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5786</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_get_property&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5787</span>
<span class="linenos">5788</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">isObsBlock</span><span class="p">(</span><span class="n">familyType</span><span class="p">,</span><span class="n">btyp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then </span>
<span class="linenos">5789</span>
<span class="linenos">5790</span><span class="k">            do </span><span class="n">elemIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nElem</span><span class="w"></span>
<span class="linenos">5791</span><span class="w">              </span><span class="n">burpIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_find_element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">element</span><span class="o">=</span><span class="n">icodele</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">),</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5792</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">burpIndex</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5793</span><span class="k">                </span><span class="n">nbele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5794</span><span class="w">                </span><span class="k">call </span><span class="n">burp_resize_block</span><span class="p">(</span><span class="n">InputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5795</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_resize_block #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5796</span><span class="w">                </span><span class="k">call </span><span class="n">burp_set_element</span><span class="p">(</span><span class="n">InputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icodele</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">),</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5797</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_set_element #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5798</span><span class="w">                </span><span class="k">do </span><span class="n">valIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">5799</span><span class="w">                  </span><span class="k">do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">5800</span><span class="w">                    </span><span class="k">call </span><span class="n">burp_set_rval</span><span class="p">(</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5801</span><span class="w">                       </span><span class="n">nele_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5802</span><span class="w">                       </span><span class="n">nval_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5803</span><span class="w">                       </span><span class="n">nt_ind</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5804</span><span class="w">                       </span><span class="n">rval</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">val_option</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5805</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_set_rval #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5806</span><span class="w">                  </span><span class="k">end do</span>
<span class="linenos">5807</span><span class="k">                end do</span>
<span class="linenos">5808</span><span class="k">              end if</span>
<span class="linenos">5809</span><span class="k">            end do</span><span class="w"></span>
<span class="linenos">5810</span><span class="w">        </span>
<span class="linenos">5811</span><span class="w">            </span><span class="c">! Adding clear-sky radiance to data block for instrument in all-sky mode.</span>
<span class="linenos">5812</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">addBtClearToBurp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5813</span><span class="w">                </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyTtAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">)))</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5814</span><span class="w">                 </span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">)))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5815</span><span class="k">              </span>
<span class="linenos">5816</span><span class="k">              </span><span class="n">indele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_find_element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">element</span><span class="o">=</span><span class="n">btClearElementId</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5817</span>
<span class="linenos">5818</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">indele</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5819</span><span class="k">                </span><span class="n">nbele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5820</span><span class="w">                </span><span class="k">call </span><span class="n">burp_resize_block</span><span class="p">(</span><span class="n">InputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5821</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_resize&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5822</span><span class="w">                </span><span class="k">Call </span><span class="n">burp_set_element</span><span class="p">(</span><span class="n">InputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">btClearElementId</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5823</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_set_element #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5824</span><span class="w">                </span><span class="k">do </span><span class="n">valIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">5825</span><span class="w">                  </span><span class="k">do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">nte</span><span class="w"></span>
<span class="linenos">5826</span><span class="w">                    </span><span class="k">call </span><span class="n">burp_set_Rval</span><span class="p">(</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5827</span><span class="w">                         </span><span class="n">nele_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5828</span><span class="w">                         </span><span class="n">nval_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5829</span><span class="w">                         </span><span class="n">nt_ind</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5830</span><span class="w">                         </span><span class="n">Rval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MPC_missingValue_R4</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5831</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_set_rval #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5832</span><span class="w">                  </span><span class="k">end do</span>
<span class="linenos">5833</span><span class="k">                end do</span>
<span class="linenos">5834</span><span class="k">              end if</span>
<span class="linenos">5835</span><span class="k">          </span>
<span class="linenos">5836</span><span class="k">            end if</span>
<span class="linenos">5837</span>
<span class="linenos">5838</span><span class="k">            call </span><span class="n">burp_write_block</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="k">block</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5839</span><span class="w">                 </span><span class="n">convert_block</span><span class="w"> </span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="n">encode_block</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5840</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_write_block #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5841</span>
<span class="linenos">5842</span><span class="w">          </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">isFlagBlock</span><span class="p">(</span><span class="n">familyType</span><span class="p">,</span><span class="n">btyp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">bfam</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w">     </span><span class="c">!  MRQ block </span>
<span class="linenos">5843</span><span class="w">            </span><span class="k">do </span><span class="n">elemIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nElem</span><span class="w"></span>
<span class="linenos">5844</span><span class="w">              </span><span class="n">ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_find_element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">element</span><span class="o">=</span><span class="n">icodeleMrq</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">),</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5845</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">ind</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5846</span><span class="k">                </span><span class="n">nbele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5847</span><span class="w">                </span><span class="k">call </span><span class="n">burp_resize_block</span><span class="p">(</span><span class="n">InputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5848</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_resize_block #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5849</span><span class="w">                </span><span class="k">Call </span><span class="n">burp_set_element</span><span class="p">(</span><span class="n">InputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">icodeleMrq</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">),</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5850</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_set_element #3&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5851</span><span class="w">                </span><span class="k">do </span><span class="n">valIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">5852</span><span class="w">                  </span><span class="k">do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">5853</span><span class="w">                    </span><span class="k">call </span><span class="n">burp_set_tblval</span><span class="p">(</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5854</span><span class="w">                         </span><span class="n">nele_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5855</span><span class="w">                         </span><span class="n">nval_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5856</span><span class="w">                         </span><span class="n">nt_ind</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5857</span><span class="w">                         </span><span class="n">tblval</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5858</span><span class="w">                        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_set_tblval #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5859</span><span class="w">                  </span><span class="k">end do</span>
<span class="linenos">5860</span><span class="k">                end do</span>
<span class="linenos">5861</span><span class="k">              end if</span>
<span class="linenos">5862</span><span class="k">            end do</span><span class="w"></span>
<span class="linenos">5863</span><span class="w">        </span>
<span class="linenos">5864</span><span class="w">            </span><span class="c">! Adding clear-sky radiance to MRQ block for instrument in all-sky mode.</span>
<span class="linenos">5865</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">addBtClearToBurp</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5866</span><span class="w">                </span><span class="p">(</span><span class="n">tvs_isInstrumAllskyTtAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">)))</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5867</span><span class="w">                 </span><span class="n">tvs_isInstrumAllskyHuAssim</span><span class="p">(</span><span class="n">tvs_getInstrumentId</span><span class="p">(</span><span class="n">codtyp_get_name</span><span class="p">(</span><span class="n">idatyp</span><span class="p">)))))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5868</span>
<span class="linenos">5869</span><span class="k">              </span><span class="n">indele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_find_element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">element</span><span class="o">=</span><span class="n">btClearMrqElementID</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5870</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">indele</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5871</span><span class="k">                </span><span class="n">nbele</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">5872</span><span class="w">                </span><span class="k">call </span><span class="n">burp_resize_block</span><span class="p">(</span><span class="n">InputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">ADD_NELE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5873</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_resize_block #3&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5874</span><span class="w">                </span><span class="k">Call </span><span class="n">burp_set_element</span><span class="p">(</span><span class="n">InputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">NELE_IND</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w"> </span><span class="n">ELEMENT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">btClearMrqElementID</span><span class="p">,</span><span class="w"> </span><span class="n">IOSTAT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5875</span><span class="w">                </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_set_element #4&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5876</span><span class="w">                </span><span class="k">do </span><span class="n">valIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="n">nvale</span><span class="w"></span>
<span class="linenos">5877</span><span class="w">                  </span><span class="k">do </span><span class="n">tIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nte</span><span class="w"></span>
<span class="linenos">5878</span><span class="w">                    </span><span class="k">call </span><span class="n">burp_set_tblval</span><span class="p">(</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5879</span><span class="w">                         </span><span class="n">nele_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nbele</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5880</span><span class="w">                         </span><span class="n">nval_ind</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">valIndex</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5881</span><span class="w">                         </span><span class="n">nt_ind</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">tIndex</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5882</span><span class="w">                         </span><span class="n">tblval</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5883</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_set_tblval #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5884</span><span class="w">                  </span><span class="k">end do</span>
<span class="linenos">5885</span><span class="k">                end do</span>
<span class="linenos">5886</span><span class="k">              end if</span>
<span class="linenos">5887</span><span class="k">          </span>
<span class="linenos">5888</span><span class="k">            end if</span>
<span class="linenos">5889</span>
<span class="linenos">5890</span><span class="k">            call </span><span class="n">burp_write_block</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="k">block</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5891</span><span class="w">                 </span><span class="n">convert_block</span><span class="w"> </span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">encode_block</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.,</span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5892</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_write_block #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5893</span>
<span class="linenos">5894</span><span class="w">          </span><span class="k">else</span><span class="w"> </span><span class="c">!other blocks</span>
<span class="linenos">5895</span>
<span class="linenos">5896</span><span class="w">            </span><span class="k">call </span><span class="n">burp_write_block</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="k">block</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">5897</span><span class="w">                 </span><span class="n">convert_block</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">5120</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">btyp</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">2080</span><span class="p">),</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5898</span><span class="w">            </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_write_block #3&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5899</span>
<span class="linenos">5900</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">5901</span><span class="k">  </span>
<span class="linenos">5902</span><span class="k">        end do </span><span class="n">blocks</span><span class="w"></span>
<span class="linenos">5903</span><span class="w">      </span>
<span class="linenos">5904</span><span class="w">        </span><span class="c">! write new report into file</span>
<span class="linenos">5905</span><span class="w">        </span><span class="c">! --------------------------</span>
<span class="linenos">5906</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_Delete_Report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5907</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_delete_report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5908</span><span class="w">        </span><span class="k">call </span><span class="n">burp_write_report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5909</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: burp_write_report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5910</span><span class="w">    </span>
<span class="linenos">5911</span><span class="w">      </span><span class="k">end do </span><span class="n">reports</span><span class="w"></span>
<span class="linenos">5912</span>
<span class="linenos">5913</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">5914</span>
<span class="linenos">5915</span><span class="k">    call  </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5916</span>
<span class="linenos">5917</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;---------------------------------------------&#39;</span><span class="w"></span>
<span class="linenos">5918</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;- end brpr_addElementsToBurp -&#39;</span><span class="w"></span>
<span class="linenos">5919</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;---------------------------------------------&#39;</span><span class="w"></span>
<span class="linenos">5920</span>
<span class="linenos">5921</span><span class="w">  </span><span class="k">contains</span><span class="w"></span>
<span class="linenos">5922</span>
<span class="linenos">5923</span><span class="w">    </span><span class="c">!-------- cleanup -----</span>
<span class="linenos">5924</span><span class="w">    </span><span class="k">subroutine </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5925</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">5926</span><span class="k">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errors</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5927</span>
<span class="linenos">5928</span><span class="w">      </span><span class="n">errors</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">5929</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">address</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">address</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5930</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5931</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5932</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5933</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5934</span><span class="w">      </span><span class="c">!Should we abort here ?</span>
<span class="linenos">5935</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">errors</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;brpr_addElementsToBurp: error while deallocating memory: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">5936</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">cleanup</span><span class="w"></span>
<span class="linenos">5937</span>
<span class="linenos">5938</span><span class="w">    </span><span class="c">!-------- handle_error -----</span>
<span class="linenos">5939</span><span class="w">    </span><span class="k">subroutine </span><span class="n">handle_error</span><span class="p">(</span><span class="n">icode</span><span class="p">,</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5940</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">5941</span><span class="k">      </span><span class="kt">character</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"></span>
<span class="linenos">5942</span><span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">5943</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icode</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">burp_noerr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5944</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;error code&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">5945</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">BURP_STR_ERROR</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5946</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;history&quot;</span><span class="w"></span>
<span class="linenos">5947</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_STR_ERROR_HISTORY</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5948</span><span class="w">        </span><span class="k">call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">5949</span><span class="w">        </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">))</span><span class="w"></span>
<span class="linenos">5950</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">5951</span><span class="k">    end subroutine </span><span class="n">handle_error</span><span class="w"></span>
<span class="linenos">5952</span><span class="w">    </span>
<span class="linenos">5953</span><span class="w">  </span><span class="k">end subroutine </span><span class="n">brpr_addElementsToBurp</span><span class="w"></span>
<span class="linenos">5954</span>
<span class="linenos">5955</span><span class="w">  </span><span class="c">!-----------------------------------------------------------------------</span>
<span class="linenos">5956</span><span class="w">  </span><span class="c">! brpr_burpClean</span>
<span class="linenos">5957</span><span class="w">  </span><span class="c">!-----------------------------------------------------------------------</span>
<span class="linenos">5958</span><span class="w">  </span><span class="k">subroutine </span><span class="n">brpr_burpClean</span><span class="p">(</span><span class="n">inputFileName</span><span class="p">,</span><span class="w"> </span><span class="n">familyType</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5959</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">5960</span><span class="w">    </span><span class="c">!:Purpose: to remove observations that are flagged not to be assimilated</span>
<span class="linenos">5961</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">5962</span><span class="w">    </span><span class="k">implicit none</span><span class="w"></span>
<span class="linenos">5963</span>
<span class="linenos">5964</span><span class="w">    </span><span class="c">! Arguments:</span>
<span class="linenos">5965</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">inputFileName</span><span class="w"></span>
<span class="linenos">5966</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">familyType</span><span class="w"></span>
<span class="linenos">5967</span>
<span class="linenos">5968</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">5969</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">burp_file</span><span class="p">)</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">inputFile</span><span class="w"></span>
<span class="linenos">5970</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">burp_rpt</span><span class="p">)</span><span class="w">              </span><span class="kd">::</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">copyReport</span><span class="w"></span>
<span class="linenos">5971</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">burp_block</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">inputBlock2</span><span class="w"></span>
<span class="linenos">5972</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">addresses</span><span class="p">(:),</span><span class="w"> </span><span class="n">elementIdsRead</span><span class="p">(:),</span><span class="w"> </span><span class="n">elementIdsBlock</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">5973</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">flagValues</span><span class="p">(:,:,:)</span><span class="w"></span>
<span class="linenos">5974</span><span class="w">    </span><span class="kt">real</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">obsValues</span><span class="p">(:,:,:)</span><span class="w"></span>
<span class="linenos">5975</span><span class="w">    </span><span class="kt">logical</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">rejectObs</span><span class="p">(:,:)</span><span class="w"></span>
<span class="linenos">5976</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">numReports</span><span class="p">,</span><span class="w"> </span><span class="n">refBlock</span><span class="p">,</span><span class="w"> </span><span class="n">intBurpValue</span><span class="w"></span>
<span class="linenos">5977</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">numElem</span><span class="p">,</span><span class="w"> </span><span class="n">numLevels</span><span class="p">,</span><span class="w"> </span><span class="n">numObsProfiles</span><span class="p">,</span><span class="w"> </span><span class="n">numElem2</span><span class="w"></span>
<span class="linenos">5978</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">numLevels2</span><span class="p">,</span><span class="w"> </span><span class="n">newNumLevels</span><span class="w"></span>
<span class="linenos">5979</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">numObsProfiles2</span><span class="p">,</span><span class="w"> </span><span class="n">newNumObsProfiles</span><span class="w"></span>
<span class="linenos">5980</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">elemIndex</span><span class="p">,</span><span class="w"> </span><span class="n">levelIndex</span><span class="p">,</span><span class="w"> </span><span class="n">levelIndexGood</span><span class="w"></span>
<span class="linenos">5981</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">obsProfIndex</span><span class="p">,</span><span class="w"> </span><span class="n">obsProfIndexGood</span><span class="w"></span>
<span class="linenos">5982</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">reportIndex</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w"> </span><span class="n">datyp</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"></span>
<span class="linenos">5983</span><span class="w">    </span><span class="kt">integer</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">nsize</span><span class="p">,</span><span class="w"> </span><span class="n">iun_burpin</span><span class="p">,</span><span class="w"> </span><span class="n">numReject</span><span class="p">,</span><span class="w"> </span><span class="n">numRejectTotal</span><span class="w"></span>
<span class="linenos">5984</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">7</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">opt_missing</span><span class="o">=</span><span class="s1">&#39;MISSING&#39;</span><span class="w"></span>
<span class="linenos">5985</span><span class="w">    </span><span class="kt">real</span><span class="p">,</span><span class="w"> </span><span class="k">parameter</span><span class="w">             </span><span class="kd">::</span><span class="w"> </span><span class="n">missingValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">999</span><span class="mf">9.0</span><span class="w"></span>
<span class="linenos">5986</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">external</span><span class="w">           </span><span class="kd">::</span><span class="w"> </span><span class="n">mrfbfl</span><span class="w"></span>
<span class="linenos">5987</span><span class="w">    </span><span class="kt">logical</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">groupedData</span><span class="p">,</span><span class="w"> </span><span class="n">foundFlags</span><span class="p">,</span><span class="w"> </span><span class="n">foundObs</span><span class="p">,</span><span class="w"> </span><span class="n">emptyReport</span><span class="w"></span>
<span class="linenos">5988</span><span class="w">    </span><span class="kt">logical</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">resumeReport</span><span class="p">,</span><span class="w"> </span><span class="n">cleanLevels</span><span class="p">,</span><span class="w"> </span><span class="n">checkBlock</span><span class="w"></span>
<span class="linenos">5989</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">familyTypesToDo</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="o">/</span><span class="s1">&#39;AI&#39;</span><span class="p">,</span><span class="s1">&#39;SW&#39;</span><span class="p">,</span><span class="s1">&#39;TO&#39;</span><span class="p">,</span><span class="s1">&#39;SC&#39;</span><span class="p">,</span><span class="s1">&#39;GP&#39;</span><span class="p">,</span><span class="s1">&#39;UA&#39;</span><span class="p">,</span><span class="s1">&#39;SF&#39;</span><span class="o">/</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5990</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=</span><span class="mi">9</span><span class="p">)</span><span class="w">            </span><span class="kd">::</span><span class="w"> </span><span class="n">stnid</span><span class="w"></span>
<span class="linenos">5991</span><span class="w">    </span><span class="kt">logical</span><span class="w">                     </span><span class="kd">::</span><span class="w"> </span><span class="n">debug</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">5992</span>
<span class="linenos">5993</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5994</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_burpClean: starting&#39;</span><span class="w"></span>
<span class="linenos">5995</span>
<span class="linenos">5996</span><span class="w">    </span><span class="c">! only apply for certain obs families for now</span>
<span class="linenos">5997</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">all</span><span class="p">(</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">familyTypesToDo</span><span class="p">(:)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">5998</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_burpClean: not applied to obs family = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">)</span><span class="w"></span>
<span class="linenos">5999</span><span class="w">      </span><span class="k">return</span>
<span class="linenos">6000</span><span class="k">    end if</span><span class="w"></span>
<span class="linenos">6001</span>
<span class="linenos">6002</span><span class="w">    </span><span class="c">! for some obs types we will remove levels/channels, not just complete profiles</span>
<span class="linenos">6003</span><span class="w">    </span><span class="n">cleanLevels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s1">&#39;UA&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6004</span>
<span class="linenos">6005</span><span class="w">    </span><span class="c">! obtain input burp file report addresses and number of reports</span>
<span class="linenos">6006</span><span class="w">    </span><span class="k">call </span><span class="n">getBurpReportAddresses</span><span class="p">(</span><span class="n">inputFileName</span><span class="p">,</span><span class="w"> </span><span class="n">addresses</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6007</span><span class="w">    </span><span class="n">numReports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">addresses</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6008</span>
<span class="linenos">6009</span><span class="w">    </span><span class="c">! initialisation</span>
<span class="linenos">6010</span><span class="w">    </span><span class="k">call </span><span class="n">burp_set_options</span><span class="p">(</span><span class="w">                   </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6011</span><span class="w">         </span><span class="n">real_optname</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">opt_missing</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6012</span><span class="w">         </span><span class="n">real_optname_value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">missingValue</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6013</span><span class="w">         </span><span class="n">iostat</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">6014</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_set_options&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6015</span>
<span class="linenos">6016</span><span class="w">    </span><span class="c">! initialize burp objects</span>
<span class="linenos">6017</span><span class="w">    </span><span class="k">call </span><span class="n">burp_init</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6018</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_init inputFile&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6019</span><span class="w">    </span><span class="k">call </span><span class="n">burp_init</span><span class="p">(</span><span class="n">inputReport</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6020</span><span class="w">    </span><span class="k">call </span><span class="n">burp_init</span><span class="p">(</span><span class="n">copyReport</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6021</span><span class="w">    </span><span class="k">call </span><span class="n">burp_init</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6022</span><span class="w">    </span><span class="k">call </span><span class="n">burp_init</span><span class="p">(</span><span class="n">inputBlock2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6023</span>
<span class="linenos">6024</span><span class="w">    </span><span class="c">! opening file</span>
<span class="linenos">6025</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_burpClean: opening burp file = &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">inputFileName</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;, &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6026</span>
<span class="linenos">6027</span><span class="w">    </span><span class="k">call </span><span class="n">burp_new</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6028</span><span class="w">         </span><span class="n">filename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inputFileName</span><span class="p">,</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6029</span><span class="w">         </span><span class="n">mode</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">file_acc_append</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6030</span><span class="w">         </span><span class="n">iostat</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">6031</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: problem opening BURP input file &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">inputFileName</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6032</span>
<span class="linenos">6033</span><span class="w">    </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">nrpts</span><span class="o">=</span><span class="n">numReports</span><span class="p">,</span><span class="w"> </span><span class="n">io_unit</span><span class="o">=</span><span class="w"> </span><span class="n">iun_burpin</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6034</span><span class="w">    </span><span class="n">nsize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mrfbfl</span><span class="p">(</span><span class="n">iun_burpin</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6035</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;nsize= &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">nsize</span><span class="w"></span>
<span class="linenos">6036</span>
<span class="linenos">6037</span><span class="w">    </span><span class="c">! determine if file contains grouped data</span>
<span class="linenos">6038</span><span class="w">    </span><span class="n">groupedData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">isGroupedData</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">addresses</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6039</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_burpClean: Grouped data = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">groupedData</span><span class="w"></span>
<span class="linenos">6040</span>
<span class="linenos">6041</span><span class="w">    </span><span class="c">! get list of element ids used for checking flags</span>
<span class="linenos">6042</span><span class="w">    </span><span class="k">call </span><span class="n">getElementIdsRead</span><span class="p">(</span><span class="n">familyType</span><span class="p">,</span><span class="w"> </span><span class="n">elementIdsRead</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6043</span>
<span class="linenos">6044</span><span class="w">    </span><span class="c">! ignore some elements when checking the flags</span>
<span class="linenos">6045</span><span class="w">    </span><span class="k">do </span><span class="n">elemIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">elementIdsRead</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6046</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(</span><span class="n">elementIdsRead</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">10194</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6047</span><span class="k">        </span><span class="n">elementIdsRead</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">6048</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">6049</span><span class="k">    end do</span>
<span class="linenos">6050</span><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_burpClean: Flags checked for these element IDs: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">elementIdsRead</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">6051</span>
<span class="linenos">6052</span><span class="w">    </span><span class="n">numRejectTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="c">! summed over entire file</span>
<span class="linenos">6053</span>
<span class="linenos">6054</span><span class="w">    </span><span class="c">! loop on reports</span>
<span class="linenos">6055</span><span class="w">    </span><span class="n">reports</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">reportIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numReports</span><span class="w"></span>
<span class="linenos">6056</span>
<span class="linenos">6057</span><span class="w">      </span><span class="n">numReject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">6058</span>
<span class="linenos">6059</span><span class="w">      </span><span class="k">call </span><span class="n">burp_get_report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6060</span><span class="w">           </span><span class="n">report</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6061</span><span class="w">           </span><span class="n">ref</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">addresses</span><span class="p">(</span><span class="n">reportIndex</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6062</span><span class="w">           </span><span class="n">iostat</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">6063</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_get_report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6064</span><span class="w">      </span>
<span class="linenos">6065</span><span class="w">      </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">stnid</span><span class="o">=</span><span class="n">stnid</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6066</span><span class="w">      </span><span class="n">resumeReport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">stnid</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s2">&quot;&gt;&gt;&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6067</span>
<span class="linenos">6068</span><span class="w">      </span><span class="c">! create and initialize a new report</span>
<span class="linenos">6069</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">reportIndex</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6070</span><span class="k">        call </span><span class="n">burp_new</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">alloc_space</span><span class="o">=</span><span class="n">nsize</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6071</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_new copyReport creation&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6072</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">6073</span><span class="k">      call </span><span class="n">burp_copy_header</span><span class="p">(</span><span class="n">to</span><span class="o">=</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">from</span><span class="o">=</span><span class="n">inputReport</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6074</span><span class="w">      </span><span class="k">call </span><span class="n">burp_init_report_write</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6075</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_init_report_write inputFile copyReport&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6076</span>
<span class="linenos">6077</span><span class="w">      </span><span class="c">! get the flags block, check if obs missing, and list of element IDs</span>
<span class="linenos">6078</span><span class="w">      </span><span class="n">foundFlags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6079</span><span class="w">      </span><span class="n">foundObs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6080</span><span class="w">      </span><span class="n">refBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">      </span>
<span class="linenos">6081</span><span class="w">      </span><span class="n">blocks</span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="linenos">6082</span>
<span class="linenos">6083</span><span class="k">        </span><span class="n">refBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_find_block</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6084</span><span class="w">             </span><span class="k">block</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">inputBlock</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6085</span><span class="w">             </span><span class="n">search_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">refBlock</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6086</span><span class="w">             </span><span class="n">iostat</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6087</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_find_block #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6088</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">refBlock</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">blocks</span><span class="w"></span>
<span class="linenos">6089</span><span class="w">         </span>
<span class="linenos">6090</span><span class="w">        </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6091</span><span class="w">             </span><span class="n">nele</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">numElem</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6092</span><span class="w">             </span><span class="n">nval</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">numLevels</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6093</span><span class="w">             </span><span class="n">nt</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">numObsProfiles</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6094</span><span class="w">             </span><span class="n">btyp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"> </span>
<span class="linenos">6095</span><span class="w">             </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6096</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_get_property #1&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6097</span>
<span class="linenos">6098</span><span class="w">        </span><span class="c">! only check &quot;multi&quot; blocks when cleanLevels is true</span>
<span class="linenos">6099</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cleanLevels</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6100</span><span class="k">          </span><span class="n">checkBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">btest</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6101</span><span class="w">        </span><span class="k">else</span>
<span class="linenos">6102</span><span class="k">          </span><span class="n">checkBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6103</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">6104</span><span class="k">          </span>
<span class="linenos">6105</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">isFlagBlock</span><span class="p">(</span><span class="n">familyType</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">checkBlock</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6106</span><span class="k">          </span><span class="n">foundFlags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6107</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Found a block with flags: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">reportIndex</span><span class="p">,</span><span class="w"> </span><span class="n">familyType</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="w"></span>
<span class="linenos">6108</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;numObsProfiles, numLevels, numElem = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">numObsProfiles</span><span class="p">,</span><span class="w"> </span><span class="n">numLevels</span><span class="p">,</span><span class="w"> </span><span class="n">numElem</span><span class="w"> </span>
<span class="linenos">6109</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">flagValues</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">flagValues</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6110</span><span class="w">          </span><span class="k">allocate</span><span class="p">(</span><span class="n">flagValues</span><span class="p">(</span><span class="n">numElem</span><span class="p">,</span><span class="n">numLevels</span><span class="p">,</span><span class="n">numObsProfiles</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6111</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">elementIdsBlock</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">elementIdsBlock</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6112</span><span class="w">          </span><span class="k">allocate</span><span class="p">(</span><span class="n">elementIdsBlock</span><span class="p">(</span><span class="n">numElem</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6113</span><span class="w">          </span><span class="k">do </span><span class="n">elemIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numElem</span><span class="w"></span>
<span class="linenos">6114</span><span class="w">            </span><span class="n">elementIdsBlock</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_get_element</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="nb">index</span><span class="o">=</span><span class="n">elemIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6115</span><span class="w">            </span><span class="k">do </span><span class="n">obsProfIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numObsProfiles</span><span class="w"></span>
<span class="linenos">6116</span><span class="w">              </span><span class="k">do </span><span class="n">levelIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numLevels</span><span class="w"></span>
<span class="linenos">6117</span><span class="w">                </span><span class="n">flagValues</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">,</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_get_tblval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6118</span><span class="w">                     </span><span class="n">nele_ind</span><span class="o">=</span><span class="n">elemIndex</span><span class="p">,</span><span class="w"> </span><span class="n">nval_ind</span><span class="o">=</span><span class="n">levelIndex</span><span class="p">,</span><span class="w"> </span><span class="n">nt_ind</span><span class="o">=</span><span class="n">obsProfIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6119</span><span class="w">              </span><span class="k">end do</span>
<span class="linenos">6120</span><span class="k">            end do</span>
<span class="linenos">6121</span><span class="k">          end do</span>
<span class="linenos">6122</span><span class="k">        end if</span>
<span class="linenos">6123</span>
<span class="linenos">6124</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">isObsBlock</span><span class="p">(</span><span class="n">familyType</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="p">)</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">checkBlock</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6125</span><span class="k">          </span><span class="n">foundObs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6126</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Found a block with obs: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">reportIndex</span><span class="p">,</span><span class="w"> </span><span class="n">familyType</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="w"></span>
<span class="linenos">6127</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;numObsProfiles, numLevels, numElem = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">numObsProfiles</span><span class="p">,</span><span class="w"> </span><span class="n">numLevels</span><span class="p">,</span><span class="w"> </span><span class="n">numElem</span><span class="w"> </span>
<span class="linenos">6128</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">obsValues</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">obsValues</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6129</span><span class="w">          </span><span class="k">allocate</span><span class="p">(</span><span class="n">obsValues</span><span class="p">(</span><span class="n">numElem</span><span class="p">,</span><span class="n">numLevels</span><span class="p">,</span><span class="n">numObsProfiles</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6130</span><span class="w">          </span><span class="k">do </span><span class="n">elemIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numElem</span><span class="w"></span>
<span class="linenos">6131</span><span class="w">            </span><span class="k">do </span><span class="n">obsProfIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numObsProfiles</span><span class="w"></span>
<span class="linenos">6132</span><span class="w">              </span><span class="k">do </span><span class="n">levelIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numLevels</span><span class="w"></span>
<span class="linenos">6133</span><span class="w">                </span><span class="n">obsValues</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">,</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_get_rval</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6134</span><span class="w">                     </span><span class="n">nele_ind</span><span class="o">=</span><span class="n">elemIndex</span><span class="p">,</span><span class="w"> </span><span class="n">nval_ind</span><span class="o">=</span><span class="n">levelIndex</span><span class="p">,</span><span class="w"> </span><span class="n">nt_ind</span><span class="o">=</span><span class="n">obsProfIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6135</span><span class="w">              </span><span class="k">end do</span>
<span class="linenos">6136</span><span class="k">            end do</span>
<span class="linenos">6137</span><span class="k">          end do</span>
<span class="linenos">6138</span><span class="k">        end if</span>
<span class="linenos">6139</span>
<span class="linenos">6140</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">foundFlags</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">foundObs</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">blocks</span><span class="w"></span>
<span class="linenos">6141</span>
<span class="linenos">6142</span><span class="w">      </span><span class="k">end do </span><span class="n">blocks</span><span class="w"></span>
<span class="linenos">6143</span>
<span class="linenos">6144</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="n">foundFlags</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">foundObs</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6145</span>
<span class="linenos">6146</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;No flag or obs block found for this report &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">reportIndex</span><span class="w"></span>
<span class="linenos">6147</span>
<span class="linenos">6148</span><span class="w">      </span><span class="k">else</span>
<span class="linenos">6149</span>
<span class="linenos">6150</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;numObsProfiles, numLevels, numElem = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">numObsProfiles</span><span class="p">,</span><span class="w"> </span><span class="n">numLevels</span><span class="p">,</span><span class="w"> </span><span class="n">numElem</span><span class="w"> </span>
<span class="linenos">6151</span><span class="w">        </span><span class="c">! determine which observations to keep</span>
<span class="linenos">6152</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">rejectObs</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">rejectObs</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6153</span><span class="w">        </span><span class="k">allocate</span><span class="p">(</span><span class="n">rejectObs</span><span class="p">(</span><span class="n">numLevels</span><span class="p">,</span><span class="n">numObsProfiles</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6154</span><span class="w">        </span><span class="n">rejectObs</span><span class="p">(:,:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6155</span><span class="w">        </span><span class="n">obsProfiles</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">obsProfIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numObsProfiles</span><span class="w"></span>
<span class="linenos">6156</span><span class="w">          </span><span class="n">obsLevels</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">levelIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numLevels</span><span class="w"></span>
<span class="linenos">6157</span><span class="w">            </span><span class="n">elements</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">elemIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numElem</span><span class="w"></span>
<span class="linenos">6158</span><span class="w">              </span><span class="c">! skip this element if it is not normally read</span>
<span class="linenos">6159</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="k">all</span><span class="p">(</span><span class="n">elementIdsBlock</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="p">(</span><span class="mi">200000</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">elementIdsRead</span><span class="p">(:)))</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">cycle </span><span class="n">elements</span><span class="w"></span>
<span class="linenos">6160</span>
<span class="linenos">6161</span><span class="w">              </span><span class="c">! if at least one element in profile is &#39;good&#39;, then cannot reject</span>
<span class="linenos">6162</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="nb">btest</span><span class="p">(</span><span class="n">flagValues</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">,</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">),</span><span class="mi">11</span><span class="p">))</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6163</span><span class="w">                   </span><span class="p">(</span><span class="n">obsValues</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">,</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">missingValue</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6164</span><span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;found a GOOD    observation: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">levelIndex</span><span class="p">,</span><span class="w"> </span><span class="n">obsProfIndex</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6165</span><span class="w">                     </span><span class="n">elementIdsBlock</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">),</span><span class="w"> </span><span class="n">flagValues</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">,</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">),</span><span class="w">   </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6166</span><span class="w">                     </span><span class="n">obsValues</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">,</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6167</span><span class="w">                </span><span class="n">rejectObs</span><span class="p">(</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6168</span><span class="w">              </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">obsValues</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">,</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">missingValue</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6169</span><span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;found a MISSING observation: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">levelIndex</span><span class="p">,</span><span class="w"> </span><span class="n">obsProfIndex</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6170</span><span class="w">                     </span><span class="n">elementIdsBlock</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">),</span><span class="w"> </span><span class="n">flagValues</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">,</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6171</span><span class="w">                     </span><span class="n">obsValues</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">,</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6172</span><span class="w">              </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="nb">btest</span><span class="p">(</span><span class="n">flagValues</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">,</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">),</span><span class="mi">11</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6173</span><span class="k">                if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;found a BAD     observation: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">levelIndex</span><span class="p">,</span><span class="w"> </span><span class="n">obsProfIndex</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6174</span><span class="w">                     </span><span class="n">elementIdsBlock</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">),</span><span class="w"> </span><span class="n">flagValues</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">,</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">),</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6175</span><span class="w">                     </span><span class="n">obsValues</span><span class="p">(</span><span class="n">elemIndex</span><span class="p">,</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6176</span><span class="w">              </span><span class="k">end if</span>
<span class="linenos">6177</span>
<span class="linenos">6178</span><span class="k">            end do </span><span class="n">elements</span><span class="w"></span>
<span class="linenos">6179</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cleanLevels</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">6180</span><span class="w">              </span><span class="c">! count number of individual rejected levels</span>
<span class="linenos">6181</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rejectObs</span><span class="p">(</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">))</span><span class="w"> </span><span class="n">numReject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numReject</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">6182</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">6183</span><span class="k">          end do </span><span class="n">obsLevels</span><span class="w"></span>
<span class="linenos">6184</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;rejectObs = &#39;</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">,</span><span class="n">rejectObs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6185</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">cleanLevels</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">6186</span><span class="w">            </span><span class="c">! count number of rejected complete profiles (all levels must be rejected)</span>
<span class="linenos">6187</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">all</span><span class="p">(</span><span class="n">rejectObs</span><span class="p">(:,</span><span class="n">obsProfIndex</span><span class="p">)))</span><span class="w"> </span><span class="n">numReject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numReject</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">6188</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">6189</span><span class="k">        end do </span><span class="n">obsProfiles</span><span class="w"></span>
<span class="linenos">6190</span>
<span class="linenos">6191</span><span class="w">        </span><span class="n">numRejectTotal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numRejectTotal</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">numReject</span><span class="w"></span>
<span class="linenos">6192</span>
<span class="linenos">6193</span><span class="w">      </span><span class="k">end if</span><span class="w"></span>
<span class="linenos">6194</span><span class="w">        </span>
<span class="linenos">6195</span><span class="w">      </span><span class="c">! copy reduced blocks output report</span>
<span class="linenos">6196</span><span class="w">      </span><span class="n">emptyReport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6197</span><span class="w">      </span><span class="n">refBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">      </span>
<span class="linenos">6198</span><span class="w">      </span><span class="n">blocks2</span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="linenos">6199</span>
<span class="linenos">6200</span><span class="k">        </span><span class="n">refBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_find_block</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6201</span><span class="w">             </span><span class="k">block</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">inputBlock2</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6202</span><span class="w">             </span><span class="n">search_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">refBlock</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6203</span><span class="w">             </span><span class="n">convert</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6204</span><span class="w">             </span><span class="n">iostat</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6205</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_find_block #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6206</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">refBlock</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">blocks2</span><span class="w"></span>
<span class="linenos">6207</span><span class="w">         </span>
<span class="linenos">6208</span><span class="w">        </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">inputBlock2</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6209</span><span class="w">             </span><span class="n">nele</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">numElem2</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6210</span><span class="w">             </span><span class="n">nval</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">numLevels2</span><span class="p">,</span><span class="w">           </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6211</span><span class="w">             </span><span class="n">nt</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">numObsProfiles2</span><span class="p">,</span><span class="w">      </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6212</span><span class="w">             </span><span class="n">btyp</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w">                 </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6213</span><span class="w">             </span><span class="n">datyp</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">datyp</span><span class="p">,</span><span class="w">                </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6214</span><span class="w">             </span><span class="n">iostat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6215</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_get_property #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6216</span>
<span class="linenos">6217</span><span class="w">        </span><span class="c">! only modify &quot;multi&quot; blocks when cleanLevels is true</span>
<span class="linenos">6218</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cleanLevels</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6219</span><span class="k">          </span><span class="n">checkBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">btest</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="mi">13</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6220</span><span class="w">        </span><span class="k">else</span>
<span class="linenos">6221</span><span class="k">          </span><span class="n">checkBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6222</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">6223</span><span class="k">          </span>
<span class="linenos">6224</span><span class="k">        if</span><span class="w"> </span><span class="p">(</span><span class="n">checkBlock</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6225</span>
<span class="linenos">6226</span><span class="k">          if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;btyp, datyp = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w"> </span><span class="n">datyp</span><span class="w"></span>
<span class="linenos">6227</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cleanLevels</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6228</span><span class="k">            </span><span class="n">newNumLevels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numLevels2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">numReject</span><span class="w"></span>
<span class="linenos">6229</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ReportIndex = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">reportIndex</span><span class="w"></span>
<span class="linenos">6230</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Reducing the number of levels from &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">numLevels2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; to &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">newNumLevels</span><span class="w"></span>
<span class="linenos">6231</span>
<span class="linenos">6232</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">newNumLevels</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">6233</span>
<span class="linenos">6234</span><span class="w">              </span><span class="c">! shuffle the data</span>
<span class="linenos">6235</span><span class="w">              </span><span class="k">do </span><span class="n">obsProfIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numObsProfiles2</span><span class="w"></span>
<span class="linenos">6236</span><span class="w">                </span><span class="n">levelIndexGood</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">6237</span><span class="w">                </span><span class="k">do </span><span class="n">levelIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numLevels2</span><span class="w"></span>
<span class="linenos">6238</span><span class="w">                  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">rejectObs</span><span class="p">(</span><span class="n">levelIndex</span><span class="p">,</span><span class="n">obsProfIndex</span><span class="p">))</span><span class="w"> </span><span class="k">cycle</span>
<span class="linenos">6239</span><span class="k">                  </span><span class="n">levelIndexGood</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">levelIndexGood</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">6240</span><span class="w">                  </span><span class="k">do </span><span class="n">elemIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numElem2</span><span class="w"></span>
<span class="linenos">6241</span><span class="w">                    </span><span class="n">intBurpValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_get_tblval</span><span class="p">(</span><span class="n">inputBlock2</span><span class="p">,</span><span class="w"> </span><span class="n">nele_ind</span><span class="o">=</span><span class="n">elemIndex</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6242</span><span class="w">                         </span><span class="n">nval_ind</span><span class="o">=</span><span class="n">levelIndex</span><span class="p">,</span><span class="w"> </span><span class="n">nt_ind</span><span class="o">=</span><span class="n">obsProfIndex</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6243</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_get_tblval&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6244</span><span class="w">                    </span><span class="k">call </span><span class="n">burp_set_tblval</span><span class="p">(</span><span class="n">inputBlock2</span><span class="p">,</span><span class="w"> </span><span class="n">nele_ind</span><span class="o">=</span><span class="n">elemIndex</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6245</span><span class="w">                         </span><span class="n">nval_ind</span><span class="o">=</span><span class="n">levelIndexGood</span><span class="p">,</span><span class="w"> </span><span class="n">nt_ind</span><span class="o">=</span><span class="n">obsProfIndex</span><span class="p">,</span><span class="w"> </span><span class="n">tblval</span><span class="o">=</span><span class="n">intBurpValue</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6246</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_set_tblval&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">6247</span><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">levelIndex</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">levelIndexGood</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6248</span><span class="k">                      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;shuffling data: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">elemIndex</span><span class="p">,</span><span class="w"> </span><span class="n">levelIndex</span><span class="p">,</span><span class="w"> </span><span class="n">levelIndexGood</span><span class="p">,</span><span class="w"> </span><span class="n">intBurpValue</span><span class="p">,</span><span class="w"> </span><span class="n">reportIndex</span><span class="w"></span>
<span class="linenos">6249</span><span class="w">                    </span><span class="k">end if</span>
<span class="linenos">6250</span><span class="k">                  end do</span>
<span class="linenos">6251</span><span class="k">                end do</span>
<span class="linenos">6252</span><span class="k">              end do</span><span class="w"></span>
<span class="linenos">6253</span>
<span class="linenos">6254</span><span class="w">              </span><span class="c">! reduce the size of the block</span>
<span class="linenos">6255</span><span class="w">              </span><span class="k">call </span><span class="n">burp_reduce_block</span><span class="p">(</span><span class="n">inputBlock2</span><span class="p">,</span><span class="w"> </span><span class="n">new_nval</span><span class="o">=</span><span class="n">newNumLevels</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6256</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_reduce_block&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6257</span>
<span class="linenos">6258</span><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="c">! newNumLevels &lt; 1</span>
<span class="linenos">6259</span>
<span class="linenos">6260</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;All observation levels rejected for this report: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">reportIndex</span><span class="w"></span>
<span class="linenos">6261</span><span class="w">              </span><span class="n">emptyReport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6262</span>
<span class="linenos">6263</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">6264</span>
<span class="linenos">6265</span><span class="k">          else</span>
<span class="linenos">6266</span>
<span class="linenos">6267</span><span class="k">            </span><span class="n">newNumObsProfiles</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">numObsProfiles2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">numReject</span><span class="w"></span>
<span class="linenos">6268</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;ReportIndex = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">reportIndex</span><span class="w"></span>
<span class="linenos">6269</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;Reducing the number of observation profiles from &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">numObsProfiles2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39; to &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">newNumObsProfiles</span><span class="w"></span>
<span class="linenos">6270</span>
<span class="linenos">6271</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">newNumObsProfiles</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">6272</span>
<span class="linenos">6273</span><span class="w">              </span><span class="c">! shuffle the data</span>
<span class="linenos">6274</span><span class="w">              </span><span class="n">obsProfIndexGood</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">6275</span><span class="w">              </span><span class="k">do </span><span class="n">obsProfIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numObsProfiles2</span><span class="w"></span>
<span class="linenos">6276</span><span class="w">                </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">all</span><span class="p">(</span><span class="n">rejectObs</span><span class="p">(:,</span><span class="n">obsProfIndex</span><span class="p">)))</span><span class="w"> </span><span class="k">cycle</span><span class="w"> </span><span class="c">! all levels rejected</span>
<span class="linenos">6277</span><span class="w">                </span><span class="n">obsProfIndexGood</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">obsProfIndexGood</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">6278</span><span class="w">                </span><span class="k">do </span><span class="n">elemIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numElem2</span><span class="w"></span>
<span class="linenos">6279</span><span class="w">                  </span><span class="k">do </span><span class="n">levelIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">numLevels2</span><span class="w"></span>
<span class="linenos">6280</span><span class="w">                    </span><span class="n">intBurpValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_get_tblval</span><span class="p">(</span><span class="n">inputBlock2</span><span class="p">,</span><span class="w"> </span><span class="n">nele_ind</span><span class="o">=</span><span class="n">elemIndex</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6281</span><span class="w">                         </span><span class="n">nval_ind</span><span class="o">=</span><span class="n">levelIndex</span><span class="p">,</span><span class="w"> </span><span class="n">nt_ind</span><span class="o">=</span><span class="n">obsProfIndex</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6282</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_get_tblval #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6283</span><span class="w">                    </span><span class="k">call </span><span class="n">burp_set_tblval</span><span class="p">(</span><span class="n">inputBlock2</span><span class="p">,</span><span class="w"> </span><span class="n">nele_ind</span><span class="o">=</span><span class="n">elemIndex</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6284</span><span class="w">                         </span><span class="n">nval_ind</span><span class="o">=</span><span class="n">levelIndex</span><span class="p">,</span><span class="w"> </span><span class="n">nt_ind</span><span class="o">=</span><span class="n">obsProfIndexGood</span><span class="p">,</span><span class="w"> </span><span class="n">tblval</span><span class="o">=</span><span class="n">intBurpValue</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6285</span><span class="w">                    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_set_tblval #2&quot;</span><span class="p">)</span><span class="w"> </span>
<span class="linenos">6286</span><span class="w">                    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="n">obsProfIndex</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">obsProfIndexGood</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6287</span><span class="k">                      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;shuffling data: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">obsProfIndex</span><span class="p">,</span><span class="w"> </span><span class="n">obsProfIndexGood</span><span class="p">,</span><span class="w"> </span><span class="n">intBurpValue</span><span class="p">,</span><span class="w"> </span><span class="n">reportIndex</span><span class="w"></span>
<span class="linenos">6288</span><span class="w">                    </span><span class="k">end if</span>
<span class="linenos">6289</span><span class="k">                  end do</span>
<span class="linenos">6290</span><span class="k">                end do</span>
<span class="linenos">6291</span><span class="k">              end do</span><span class="w"></span>
<span class="linenos">6292</span>
<span class="linenos">6293</span><span class="w">              </span><span class="c">! reduce the size of the block</span>
<span class="linenos">6294</span><span class="w">              </span><span class="k">call </span><span class="n">burp_reduce_block</span><span class="p">(</span><span class="n">inputBlock2</span><span class="p">,</span><span class="w"> </span><span class="n">new_nt</span><span class="o">=</span><span class="n">newNumObsProfiles</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6295</span><span class="w">              </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_reduce_block #2&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6296</span>
<span class="linenos">6297</span><span class="w">            </span><span class="k">else</span><span class="w"> </span><span class="c">! newNumObsProfiles &lt; 1</span>
<span class="linenos">6298</span>
<span class="linenos">6299</span><span class="w">              </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">debug</span><span class="p">)</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;All observation profiles rejected for this report: &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">reportIndex</span><span class="w"></span>
<span class="linenos">6300</span><span class="w">              </span><span class="n">emptyReport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6301</span>
<span class="linenos">6302</span><span class="w">            </span><span class="k">end if</span>
<span class="linenos">6303</span>
<span class="linenos">6304</span><span class="k">          end if</span><span class="w"> </span><span class="c">! cleanLevels</span>
<span class="linenos">6305</span>
<span class="linenos">6306</span><span class="w">        </span><span class="k">end if</span><span class="w"> </span><span class="c">! checkBlock</span>
<span class="linenos">6307</span>
<span class="linenos">6308</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">emptyReport</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6309</span><span class="k">          call </span><span class="n">burp_write_block</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="k">block</span><span class="o">=</span><span class="n">inputBlock2</span><span class="p">,</span><span class="w">  </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6310</span><span class="w">               </span><span class="n">convert_block</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6311</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_write_block&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6312</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">6313</span>
<span class="linenos">6314</span><span class="k">      end do </span><span class="n">blocks2</span><span class="w"></span>
<span class="linenos">6315</span><span class="w">      </span>
<span class="linenos">6316</span><span class="w">      </span><span class="c">! delete existing report and write new report into file</span>
<span class="linenos">6317</span><span class="w">      </span><span class="k">call </span><span class="n">burp_delete_report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6318</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_delete_report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6319</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="n">emptyReport</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"></span>
<span class="linenos">6320</span><span class="w">        </span><span class="c">! for grouped data modify &quot;elev&quot; to new number of obs profiles</span>
<span class="linenos">6321</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">groupedData</span><span class="w"> </span><span class="p">.</span><span class="nb">and</span><span class="p">.</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">resumeReport</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6322</span><span class="k">          call </span><span class="n">burp_set_property</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w">             </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6323</span><span class="w">                                 </span><span class="n">elev</span><span class="o">=</span><span class="n">newNumObsProfiles</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6324</span><span class="w">                                 </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6325</span><span class="w">          </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_set_property&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6326</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">6327</span><span class="k">        call </span><span class="n">burp_write_report</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6328</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: burp_write_report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6329</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">6330</span>
<span class="linenos">6331</span><span class="k">    end do </span><span class="n">reports</span><span class="w"></span>
<span class="linenos">6332</span>
<span class="linenos">6333</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;brpr_burpClean: finished - total number of obs profiles cleaned:&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">numRejectTotal</span><span class="w"></span>
<span class="linenos">6334</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6335</span>
<span class="linenos">6336</span><span class="w">    </span><span class="k">call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6337</span>
<span class="linenos">6338</span><span class="w">  </span><span class="k">contains</span><span class="w"></span>
<span class="linenos">6339</span>
<span class="linenos">6340</span><span class="w">    </span><span class="c">!-------- cleanup -----</span>
<span class="linenos">6341</span><span class="w">    </span><span class="k">subroutine </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6342</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">6343</span><span class="k">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errors</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6344</span>
<span class="linenos">6345</span><span class="w">      </span><span class="n">errors</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">6346</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">addresses</span><span class="p">))</span><span class="w">       </span><span class="k">deallocate</span><span class="p">(</span><span class="n">addresses</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6347</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">obsValues</span><span class="p">))</span><span class="w">       </span><span class="k">deallocate</span><span class="p">(</span><span class="n">obsValues</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6348</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">flagValues</span><span class="p">))</span><span class="w">      </span><span class="k">deallocate</span><span class="p">(</span><span class="n">flagValues</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6349</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">rejectObs</span><span class="p">))</span><span class="w">       </span><span class="k">deallocate</span><span class="p">(</span><span class="n">rejectObs</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6350</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">elementIdsBlock</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">elementIdsBlock</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6351</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">elementIdsRead</span><span class="p">))</span><span class="w">  </span><span class="k">deallocate</span><span class="p">(</span><span class="n">elementIdsRead</span><span class="p">,</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6352</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="n">inputFile</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6353</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="n">inputReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6354</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="n">copyReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">9</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6355</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="n">inputBlock</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6356</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="n">inputBlock2</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">11</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6357</span><span class="w">      </span><span class="c">!Should we abort here ?</span>
<span class="linenos">6358</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">errors</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;brpr_burpClean: error while deallocating memory: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">6359</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">cleanup</span><span class="w"></span>
<span class="linenos">6360</span>
<span class="linenos">6361</span><span class="w">    </span><span class="c">!-------- handle_error -----</span>
<span class="linenos">6362</span><span class="w">    </span><span class="k">subroutine </span><span class="n">handle_error</span><span class="p">(</span><span class="n">icode</span><span class="p">,</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6363</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">6364</span><span class="k">      </span><span class="kt">character</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"></span>
<span class="linenos">6365</span><span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">6366</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icode</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">burp_noerr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6367</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;error code&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">6368</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">BURP_STR_ERROR</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6369</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;history&quot;</span><span class="w"></span>
<span class="linenos">6370</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_STR_ERROR_HISTORY</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6371</span><span class="w">        </span><span class="k">call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6372</span><span class="w">        </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6373</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">6374</span><span class="k">    end subroutine </span><span class="n">handle_error</span><span class="w"></span>
<span class="linenos">6375</span><span class="w">   </span>
<span class="linenos">6376</span><span class="w">  </span><span class="k">end subroutine </span><span class="n">brpr_burpClean</span><span class="w"></span>
<span class="linenos">6377</span>
<span class="linenos">6378</span>
<span class="linenos">6379</span><span class="w">  </span><span class="k">subroutine </span><span class="n">getBurpReportAddresses</span><span class="p">(</span><span class="n">fileName</span><span class="p">,</span><span class="w"> </span><span class="n">addresses</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6380</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">6381</span><span class="w">    </span><span class="c">!:Purpose: Initial scan of file to get number of reports. Store address</span>
<span class="linenos">6382</span><span class="w">    </span><span class="c">!          of each report in array addresses(numReports).</span>
<span class="linenos">6383</span><span class="w">    </span><span class="c">!</span>
<span class="linenos">6384</span><span class="w">    </span><span class="k">implicit none</span><span class="w"> </span>
<span class="linenos">6385</span>
<span class="linenos">6386</span><span class="w">    </span><span class="c">! Arguments:</span>
<span class="linenos">6387</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w">        </span><span class="kd">::</span><span class="w"> </span><span class="n">fileName</span><span class="w"></span>
<span class="linenos">6388</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="p">,</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">addresses</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">6389</span>
<span class="linenos">6390</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">6391</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">burp_file</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">burpFile</span><span class="w"></span>
<span class="linenos">6392</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">BURP_RPT</span><span class="p">)</span><span class="w">  </span><span class="kd">::</span><span class="w"> </span><span class="n">report</span><span class="w"></span>
<span class="linenos">6393</span><span class="w">    </span><span class="kt">integer</span><span class="w">         </span><span class="kd">::</span><span class="w"> </span><span class="n">numReports</span><span class="p">,</span><span class="w"> </span><span class="n">refReport</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"></span>
<span class="linenos">6394</span>
<span class="linenos">6395</span><span class="w">    </span><span class="c">! initialisation</span>
<span class="linenos">6396</span><span class="w">    </span><span class="k">call </span><span class="n">burp_init</span><span class="p">(</span><span class="n">burpFile</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6397</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;getBurpReportAddresses: burp_init inputfile&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6398</span><span class="w">    </span><span class="k">call </span><span class="n">burp_init</span><span class="p">(</span><span class="n">report</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6399</span>
<span class="linenos">6400</span><span class="w">    </span><span class="c">! ouverture du fichier burp</span>
<span class="linenos">6401</span><span class="w">    </span><span class="k">call </span><span class="n">burp_new</span><span class="p">(</span><span class="n">burpFile</span><span class="p">,</span><span class="w"> </span><span class="n">filename</span><span class="o">=</span><span class="n">fileName</span><span class="p">,</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="n">file_acc_read</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6402</span><span class="w">    </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;getBurpReportAddresses: problem opening &quot;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="w"> </span><span class="p">)</span><span class="w"></span>
<span class="linenos">6403</span>
<span class="linenos">6404</span><span class="w">    </span><span class="c">! number of reports and maximum report size from BURP file</span>
<span class="linenos">6405</span><span class="w">    </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="n">burpFile</span><span class="p">,</span><span class="w"> </span><span class="n">nrpts</span><span class="o">=</span><span class="n">numReports</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6406</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">numReports</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6407</span><span class="k">      write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;getBurpReportAddresses: BURP file &#39;</span><span class="p">,</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">fileName</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6408</span><span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;getBurpReportAddresses: WARNING: no observations in file&#39;</span><span class="w"></span>
<span class="linenos">6409</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">6410</span><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6411</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;getBurpReportAddresses: Total number of reports = &#39;</span><span class="p">,</span><span class="w"> </span><span class="n">numReports</span><span class="w"></span>
<span class="linenos">6412</span><span class="w">    </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6413</span>
<span class="linenos">6414</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">addresses</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">addresses</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6415</span><span class="w">    </span><span class="k">allocate</span><span class="p">(</span><span class="n">addresses</span><span class="p">(</span><span class="n">numReports</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6416</span><span class="w">  </span>
<span class="linenos">6417</span><span class="w">    </span><span class="n">addresses</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">6418</span><span class="w">    </span><span class="n">refReport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">6419</span><span class="w">    </span><span class="n">numReports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">6420</span><span class="w">    </span><span class="k">do</span>
<span class="linenos">6421</span><span class="k">      </span><span class="n">refReport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_find_report</span><span class="p">(</span><span class="n">burpFile</span><span class="p">,</span><span class="w"> </span><span class="n">report</span><span class="o">=</span><span class="n">report</span><span class="p">,</span><span class="w"> </span><span class="n">search_from</span><span class="o">=</span><span class="n">refReport</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6422</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;getBurpReportAddresses: burp_find_report error finding next burp report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6423</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">refReport</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit</span>
<span class="linenos">6424</span><span class="k">      </span><span class="n">numReports</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">numReports</span><span class="o">+</span><span class="mi">1</span><span class="w"></span>
<span class="linenos">6425</span><span class="w">      </span><span class="n">addresses</span><span class="p">(</span><span class="n">numReports</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">refReport</span><span class="w"></span>
<span class="linenos">6426</span><span class="w">    </span><span class="k">end do</span>
<span class="linenos">6427</span>
<span class="linenos">6428</span><span class="k">    call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6429</span>
<span class="linenos">6430</span><span class="w">  </span><span class="k">contains</span><span class="w"></span>
<span class="linenos">6431</span>
<span class="linenos">6432</span><span class="w">    </span><span class="c">!-------- cleanup -----</span>
<span class="linenos">6433</span><span class="w">    </span><span class="k">subroutine </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6434</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">6435</span><span class="k">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6436</span>
<span class="linenos">6437</span><span class="w">      </span><span class="n">errors</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span>
<span class="linenos">6438</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="n">report</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6439</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="n">burpFile</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6440</span><span class="w">      </span><span class="c">!Should we abort here ?</span>
<span class="linenos">6441</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">errors</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;getBurpReportAddresses: error while deallocating memory: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">6442</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">cleanup</span><span class="w"></span>
<span class="linenos">6443</span>
<span class="linenos">6444</span><span class="w">    </span><span class="c">!-------- handle_error -----</span>
<span class="linenos">6445</span><span class="w">    </span><span class="k">subroutine </span><span class="n">handle_error</span><span class="p">(</span><span class="n">icode</span><span class="p">,</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6446</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">6447</span><span class="k">      </span><span class="kt">character</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"></span>
<span class="linenos">6448</span><span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">6449</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icode</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">burp_noerr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6450</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;error code&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">6451</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">BURP_STR_ERROR</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6452</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;history&quot;</span><span class="w"></span>
<span class="linenos">6453</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_STR_ERROR_HISTORY</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6454</span><span class="w">        </span><span class="k">call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6455</span><span class="w">        </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6456</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">6457</span><span class="k">    end subroutine </span><span class="n">handle_error</span><span class="w"></span>
<span class="linenos">6458</span>
<span class="linenos">6459</span><span class="w">  </span><span class="k">end subroutine </span><span class="n">getBurpReportAddresses</span><span class="w"></span>
<span class="linenos">6460</span>
<span class="linenos">6461</span>
<span class="linenos">6462</span><span class="w">  </span><span class="k">function </span><span class="n">isGroupedData</span><span class="p">(</span><span class="n">burpFile</span><span class="p">,</span><span class="n">address</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">isGrouped</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6463</span><span class="w">    </span><span class="k">implicit none</span><span class="w"></span>
<span class="linenos">6464</span><span class="w">    </span><span class="c">! Arguments:</span>
<span class="linenos">6465</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">burp_file</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">burpFile</span><span class="w"></span>
<span class="linenos">6466</span><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">address</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">6467</span><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">isGrouped</span><span class="w"></span>
<span class="linenos">6468</span>
<span class="linenos">6469</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">6470</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">burp_rpt</span><span class="p">)</span><span class="w">   </span><span class="kd">::</span><span class="w"> </span><span class="n">report</span><span class="w"></span>
<span class="linenos">6471</span><span class="w">    </span><span class="k">type</span><span class="p">(</span><span class="n">burp_block</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="k">block</span>
<span class="linenos">6472</span><span class="k">    </span><span class="kt">integer</span><span class="w">          </span><span class="kd">::</span><span class="w"> </span><span class="n">reportIndex</span><span class="p">,</span><span class="w"> </span><span class="n">refBlock</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="p">,</span><span class="w"> </span><span class="n">btyp10</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"></span>
<span class="linenos">6473</span>
<span class="linenos">6474</span><span class="w">    </span><span class="k">call </span><span class="n">burp_init</span><span class="p">(</span><span class="n">report</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6475</span><span class="w">    </span><span class="k">call </span><span class="n">burp_init</span><span class="p">(</span><span class="k">block</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6476</span>
<span class="linenos">6477</span><span class="w">    </span><span class="c">! determine if this file contains grouped data</span>
<span class="linenos">6478</span><span class="w">    </span><span class="n">isGrouped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6479</span><span class="w">    </span><span class="n">reports</span><span class="p">:</span><span class="w"> </span><span class="k">do </span><span class="n">reportIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">(</span><span class="n">address</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6480</span><span class="w">    </span>
<span class="linenos">6481</span><span class="w">      </span><span class="k">call </span><span class="n">burp_get_report</span><span class="p">(</span><span class="n">burpFile</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6482</span><span class="w">           </span><span class="n">report</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">report</span><span class="p">,</span><span class="w">          </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6483</span><span class="w">           </span><span class="n">ref</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">address</span><span class="p">(</span><span class="n">reportIndex</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6484</span><span class="w">           </span><span class="n">iostat</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w">      </span>
<span class="linenos">6485</span><span class="w">      </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;isGroupedData: burp_get_report error getting next burp report&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6486</span><span class="w">      </span><span class="c">! loop on blocks</span>
<span class="linenos">6487</span><span class="w">      </span><span class="n">refBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w">      </span>
<span class="linenos">6488</span><span class="w">      </span><span class="n">blocks</span><span class="p">:</span><span class="w"> </span><span class="k">do</span>
<span class="linenos">6489</span>
<span class="linenos">6490</span><span class="k">        </span><span class="n">refBlock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">burp_find_block</span><span class="p">(</span><span class="n">report</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6491</span><span class="w">             </span><span class="k">block</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="k">block</span><span class="p">,</span><span class="w">         </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6492</span><span class="w">             </span><span class="n">search_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">refBlock</span><span class="p">,</span><span class="w">            </span><span class="p">&amp;</span><span class="w"></span>
<span class="linenos">6493</span><span class="w">             </span><span class="n">iostat</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6494</span><span class="w">        </span><span class="k">call </span><span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;isGroupedData: burp_find_block error finding next burp block&quot;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6495</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">refBlock</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">exit </span><span class="n">blocks</span><span class="w"></span>
<span class="linenos">6496</span>
<span class="linenos">6497</span><span class="w">        </span><span class="k">call </span><span class="n">burp_get_property</span><span class="p">(</span><span class="k">block</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="o">=</span><span class="n">btyp</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6498</span><span class="w">        </span><span class="n">btyp10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6499</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">160</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6500</span><span class="k">          </span><span class="n">isGrouped</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">true</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6501</span><span class="w">          </span><span class="k">exit </span><span class="n">reports</span><span class="w"></span>
<span class="linenos">6502</span><span class="w">        </span><span class="k">end if</span>
<span class="linenos">6503</span>
<span class="linenos">6504</span><span class="k">      end do </span><span class="n">blocks</span><span class="w"></span>
<span class="linenos">6505</span>
<span class="linenos">6506</span><span class="w">    </span><span class="k">end do </span><span class="n">reports</span><span class="w"></span>
<span class="linenos">6507</span>
<span class="linenos">6508</span><span class="w">    </span><span class="k">call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6509</span>
<span class="linenos">6510</span><span class="w">  </span><span class="k">contains</span><span class="w"></span>
<span class="linenos">6511</span>
<span class="linenos">6512</span><span class="w">    </span><span class="c">!-------- cleanup -----</span>
<span class="linenos">6513</span><span class="w">    </span><span class="k">subroutine </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6514</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">6515</span><span class="k">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6516</span>
<span class="linenos">6517</span><span class="w">      </span><span class="n">errors</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">6518</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="n">report</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6519</span><span class="w">      </span><span class="k">call </span><span class="n">burp_free</span><span class="p">(</span><span class="k">block</span><span class="p">,</span><span class="w"> </span><span class="n">iostat</span><span class="o">=</span><span class="n">errors</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6520</span><span class="w">      </span><span class="c">!Should we abort here ?</span>
<span class="linenos">6521</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">errors</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;isGroupedData: error while deallocating memory: &quot;</span><span class="p">,</span><span class="w"> </span><span class="n">errors</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">6522</span><span class="w">    </span><span class="k">end subroutine </span><span class="n">cleanup</span><span class="w"></span>
<span class="linenos">6523</span>
<span class="linenos">6524</span><span class="w">    </span><span class="c">!-------- handle_error -----</span>
<span class="linenos">6525</span><span class="w">    </span><span class="k">subroutine </span><span class="n">handle_error</span><span class="p">(</span><span class="n">icode</span><span class="p">,</span><span class="w"> </span><span class="n">errorMessage</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6526</span><span class="w">      </span><span class="k">implicit none</span>
<span class="linenos">6527</span><span class="k">      </span><span class="kt">character</span><span class="w"> </span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">errorMessage</span><span class="w"></span>
<span class="linenos">6528</span><span class="w">      </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">6529</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">icode</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">burp_noerr</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6530</span><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s1">&#39;error code&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">icode</span><span class="w"></span>
<span class="linenos">6531</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">BURP_STR_ERROR</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6532</span><span class="w">        </span><span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="s2">&quot;history&quot;</span><span class="w"></span>
<span class="linenos">6533</span><span class="w">        </span><span class="k">call </span><span class="n">BURP_STR_ERROR_HISTORY</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6534</span><span class="w">        </span><span class="k">call </span><span class="n">cleanup</span><span class="p">()</span><span class="w"></span>
<span class="linenos">6535</span><span class="w">        </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">errorMessage</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6536</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">6537</span><span class="k">    end subroutine </span><span class="n">handle_error</span><span class="w"></span>
<span class="linenos">6538</span>
<span class="linenos">6539</span><span class="w">  </span><span class="k">end function </span><span class="n">isGroupedData</span><span class="w"></span>
<span class="linenos">6540</span><span class="w">  </span>
<span class="linenos">6541</span>
<span class="linenos">6542</span><span class="w">  </span><span class="k">function </span><span class="n">isFlagBlock</span><span class="p">(</span><span class="n">familyType</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">isFlag</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6543</span><span class="w">    </span><span class="k">implicit none</span><span class="w"></span>
<span class="linenos">6544</span>
<span class="linenos">6545</span><span class="w">    </span><span class="c">! Arguments:</span>
<span class="linenos">6546</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">familyType</span><span class="w"></span>
<span class="linenos">6547</span><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">btyp</span><span class="w"></span>
<span class="linenos">6548</span><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">isFlag</span><span class="w"></span>
<span class="linenos">6549</span>
<span class="linenos">6550</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">6551</span><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">btyp10</span><span class="p">,</span><span class="w"> </span><span class="n">btyp10flg</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="w"></span>
<span class="linenos">6552</span>
<span class="linenos">6553</span><span class="w">    </span><span class="n">isFlag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6554</span>
<span class="linenos">6555</span><span class="w">    </span><span class="n">btyp10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6556</span><span class="w">    </span><span class="n">btyp10flg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">483</span><span class="w"></span>
<span class="linenos">6557</span>
<span class="linenos">6558</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;UA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6559</span><span class="k">      </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">288</span><span class="w"></span>
<span class="linenos">6560</span><span class="w">      </span><span class="n">isFlag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10flg</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10flg</span><span class="o">-</span><span class="n">offset</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6561</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">isFlag</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6562</span><span class="k">        </span><span class="n">isFlag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10flg</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10flg</span><span class="o">-</span><span class="n">offset</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6563</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">6564</span><span class="k">    else</span>
<span class="linenos">6565</span><span class="k">      select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6566</span><span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;AI&#39;</span><span class="p">,</span><span class="s1">&#39;SW&#39;</span><span class="p">,</span><span class="s1">&#39;SC&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6567</span><span class="w">        </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">256</span><span class="w"></span>
<span class="linenos">6568</span><span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;RO&#39;</span><span class="p">,</span><span class="s1">&#39;TO&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6569</span><span class="w">        </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">6570</span><span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;SF&#39;</span><span class="p">,</span><span class="s1">&#39;GP&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6571</span><span class="w">        </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">288</span><span class="w"></span>
<span class="linenos">6572</span><span class="w">      </span><span class="k">end select</span>
<span class="linenos">6573</span><span class="k">      </span><span class="n">isFlag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10flg</span><span class="o">-</span><span class="n">offset</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10flg</span><span class="o">-</span><span class="n">offset</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6574</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">6575</span><span class="k">    </span>
<span class="linenos">6576</span><span class="k">  end function </span><span class="n">isFlagBlock</span><span class="w"></span>
<span class="linenos">6577</span>
<span class="linenos">6578</span>
<span class="linenos">6579</span><span class="w">  </span><span class="k">function </span><span class="n">isObsBlock</span><span class="p">(</span><span class="n">familyType</span><span class="p">,</span><span class="w"> </span><span class="n">btyp</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">isObs</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6580</span><span class="w">    </span><span class="k">implicit none</span><span class="w"></span>
<span class="linenos">6581</span>
<span class="linenos">6582</span><span class="w">    </span><span class="c">! Arguments:</span>
<span class="linenos">6583</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">familyType</span><span class="w"></span>
<span class="linenos">6584</span><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">btyp</span><span class="w"></span>
<span class="linenos">6585</span><span class="w">    </span><span class="kt">logical</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">isObs</span><span class="w"></span>
<span class="linenos">6586</span>
<span class="linenos">6587</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">6588</span><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">btyp10</span><span class="p">,</span><span class="w"> </span><span class="n">btyp10obs</span><span class="p">,</span><span class="w"> </span><span class="n">offset</span><span class="w"></span>
<span class="linenos">6589</span>
<span class="linenos">6590</span><span class="w">    </span><span class="n">isObs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">.</span><span class="n">false</span><span class="p">.</span><span class="w"></span>
<span class="linenos">6591</span>
<span class="linenos">6592</span><span class="w">    </span><span class="n">btyp10</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">ishft</span><span class="p">(</span><span class="n">btyp</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6593</span><span class="w">    </span><span class="n">btyp10obs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">291</span><span class="w"></span>
<span class="linenos">6594</span>
<span class="linenos">6595</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">)</span><span class="o">==</span><span class="s1">&#39;UA&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6596</span><span class="k">      </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">288</span><span class="w"></span>
<span class="linenos">6597</span><span class="w">      </span><span class="n">isObs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">offset</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6598</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">.</span><span class="nb">not</span><span class="p">.</span><span class="n">isObs</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6599</span><span class="k">        </span><span class="n">isObs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs</span><span class="o">-</span><span class="mi">2</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs</span><span class="o">-</span><span class="n">offset</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6600</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">6601</span><span class="k">    else</span>
<span class="linenos">6602</span><span class="k">      select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6603</span><span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;AI&#39;</span><span class="p">,</span><span class="s1">&#39;SW&#39;</span><span class="p">,</span><span class="s1">&#39;SC&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6604</span><span class="w">        </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">256</span><span class="w"></span>
<span class="linenos">6605</span><span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;RO&#39;</span><span class="p">,</span><span class="s1">&#39;TO&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6606</span><span class="w">        </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">6607</span><span class="w">      </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;SF&#39;</span><span class="p">,</span><span class="s1">&#39;GP&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6608</span><span class="w">        </span><span class="n">offset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">288</span><span class="w"></span>
<span class="linenos">6609</span><span class="w">      </span><span class="k">end select</span>
<span class="linenos">6610</span><span class="k">      </span><span class="n">isObs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs</span><span class="o">-</span><span class="n">offset</span><span class="w"> </span><span class="p">.</span><span class="nb">or</span><span class="p">.</span><span class="w"> </span><span class="n">btyp10</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">btyp10obs</span><span class="o">-</span><span class="n">offset</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6611</span><span class="w">    </span><span class="k">end if</span>
<span class="linenos">6612</span><span class="k">    </span>
<span class="linenos">6613</span><span class="k">  end function </span><span class="n">isObsBlock</span><span class="w"></span>
<span class="linenos">6614</span>
<span class="linenos">6615</span><span class="w">  </span>
<span class="linenos">6616</span><span class="w">  </span><span class="k">subroutine </span><span class="n">getElementIdsRead</span><span class="p">(</span><span class="n">familyType</span><span class="p">,</span><span class="w"> </span><span class="n">elementIds</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6617</span><span class="w">    </span><span class="k">implicit none</span><span class="w"></span>
<span class="linenos">6618</span>
<span class="linenos">6619</span><span class="w">    </span><span class="c">! Arguments:</span>
<span class="linenos">6620</span><span class="w">    </span><span class="kt">character</span><span class="p">(</span><span class="nb">len</span><span class="o">=*</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">familyType</span><span class="w"></span>
<span class="linenos">6621</span><span class="w">    </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">elementIds</span><span class="p">(:)</span><span class="w"></span>
<span class="linenos">6622</span>
<span class="linenos">6623</span><span class="w">    </span><span class="c">! Locals:</span>
<span class="linenos">6624</span><span class="w">    </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">elementIndex</span><span class="p">,</span><span class="w"> </span><span class="n">elementCount</span><span class="w"></span>
<span class="linenos">6625</span>
<span class="linenos">6626</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">allocated</span><span class="p">(</span><span class="n">elementIds</span><span class="p">))</span><span class="w"> </span><span class="k">deallocate</span><span class="p">(</span><span class="n">elementIds</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6627</span>
<span class="linenos">6628</span><span class="w">    </span><span class="k">select case</span><span class="p">(</span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6629</span>
<span class="linenos">6630</span><span class="w">    </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;UA&#39;</span><span class="p">,</span><span class="s1">&#39;AI&#39;</span><span class="p">,</span><span class="s1">&#39;AL&#39;</span><span class="p">,</span><span class="s1">&#39;SW&#39;</span><span class="p">,</span><span class="s1">&#39;PR&#39;</span><span class="p">,</span><span class="s1">&#39;RO&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6631</span><span class="w">      </span><span class="k">call </span><span class="n">brpacma_nml</span><span class="p">(</span><span class="s1">&#39;namburp_filter_conv&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">beSilent_opt</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">6632</span><span class="w">      </span><span class="k">allocate</span><span class="p">(</span><span class="n">elementIds</span><span class="p">(</span><span class="n">nelems</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6633</span><span class="w">      </span><span class="n">elementIds</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">blistelements</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nelems</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6634</span>
<span class="linenos">6635</span><span class="w">    </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;SF&#39;</span><span class="p">,</span><span class="s1">&#39;SC&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6636</span><span class="w">      </span><span class="k">call </span><span class="n">brpacma_nml</span><span class="p">(</span><span class="s1">&#39;namburp_filter_sfc&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">beSilent_opt</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">6637</span><span class="w">      </span><span class="k">allocate</span><span class="p">(</span><span class="n">elementIds</span><span class="p">(</span><span class="n">nelems_sfc</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6638</span><span class="w">      </span><span class="n">elementIds</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">blistelements_sfc</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nelems_sfc</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6639</span>
<span class="linenos">6640</span><span class="w">    </span><span class="k">case</span><span class="p">(</span><span class="s1">&#39;GP&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6641</span><span class="w">      </span><span class="k">call </span><span class="n">brpacma_nml</span><span class="p">(</span><span class="s1">&#39;namburp_filter_gp&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">beSilent_opt</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">6642</span><span class="w">      </span><span class="c">! do not include &quot;formal error&quot;, since it was removed from obsSpaceData</span>
<span class="linenos">6643</span><span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">liste_ele_gps</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nelems_gps</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">bufr_nefe</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6644</span><span class="k">        allocate</span><span class="p">(</span><span class="n">elementIds</span><span class="p">(</span><span class="n">nelems_gps</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6645</span><span class="w">        </span><span class="n">elementCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"></span>
<span class="linenos">6646</span><span class="w">        </span><span class="k">do </span><span class="n">elementIndex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">nelems_gps</span><span class="w"></span>
<span class="linenos">6647</span><span class="w">          </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">liste_ele_gps</span><span class="p">(</span><span class="n">elementIndex</span><span class="p">)</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="n">bufr_nefe</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="linenos">6648</span><span class="k">            </span><span class="n">elementCount</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">elementCount</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w"></span>
<span class="linenos">6649</span><span class="w">            </span><span class="n">elementIds</span><span class="p">(</span><span class="n">elementCount</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">liste_ele_gps</span><span class="p">(</span><span class="n">elementIndex</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6650</span><span class="w">          </span><span class="k">end if</span>
<span class="linenos">6651</span><span class="k">        end do</span>
<span class="linenos">6652</span><span class="k">      else</span>
<span class="linenos">6653</span><span class="k">        allocate</span><span class="p">(</span><span class="n">elementIds</span><span class="p">(</span><span class="n">nelems_gps</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6654</span><span class="w">        </span><span class="n">elementIds</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">liste_ele_gps</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nelems_gps</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6655</span><span class="w">      </span><span class="k">end if</span>
<span class="linenos">6656</span><span class="k">      </span>
<span class="linenos">6657</span><span class="k">    case</span><span class="p">(</span><span class="s1">&#39;TO&#39;</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6658</span><span class="w">      </span><span class="k">call </span><span class="n">brpacma_nml</span><span class="p">(</span><span class="s1">&#39;namburp_filter_tovs&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">beSilent_opt</span><span class="o">=</span><span class="p">.</span><span class="n">true</span><span class="p">.)</span><span class="w"></span>
<span class="linenos">6659</span><span class="w">      </span><span class="k">allocate</span><span class="p">(</span><span class="n">elementIds</span><span class="p">(</span><span class="n">nelems</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6660</span><span class="w">      </span><span class="n">elementIds</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">blistelements</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nelems</span><span class="p">)</span><span class="w"></span>
<span class="linenos">6661</span>
<span class="linenos">6662</span><span class="w">    </span><span class="k">case </span><span class="n">default</span><span class="w"></span>
<span class="linenos">6663</span><span class="w">      </span><span class="k">call </span><span class="n">utl_abort</span><span class="p">(</span><span class="s1">&#39;getElementIdsRead: unknown familyType: &#39;</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="nb">trim</span><span class="p">(</span><span class="n">familyType</span><span class="p">))</span><span class="w"></span>
<span class="linenos">6664</span>
<span class="linenos">6665</span><span class="w">    </span><span class="k">end select</span>
<span class="linenos">6666</span>
<span class="linenos">6667</span><span class="k">  end subroutine </span><span class="n">getElementIdsRead</span><span class="w"></span>
<span class="linenos">6668</span>
<span class="linenos">6669</span><span class="k">end module </span><span class="n">burpread_mod</span><span class="w"></span>
</pre></div>
</div>
</div></blockquote>
</section>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li><a href="../index.html">MIDAS  documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2018, ECCC.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>